# Staging compare summary

This file summarizes the comparison between expected rows (sum of per-season CSVs) and the rows present in the staging schema in Postgres. It was generated by re-running `scripts/compare_all_seasons_counts.py` and exporting the table results into CSV and this markdown summary.

Summary table

| Table | expected_total_rows (all seasons) | db_rows | diff |
|---|---:|---:|---:|
| stg_stats_defense | 7882 | 0 | -7882 |
| stg_stats_gca | 7882 | 0 | -7882 |
| stg_stats_keeper | 543 | 0 | -543 |
| stg_stats_keeper_adv | 543 | 0 | -543 |
| stg_stats_misc | 7882 | 0 | -7882 |
| stg_stats_passing | 7882 | 0 | -7882 |
| stg_stats_passing_types | 7882 | 0 | -7882 |
| stg_stats_playing_time | 9703 | 0 | -9703 |
| stg_stats_possession | 7882 | 0 | -7882 |
| stg_stats_shooting | 7882 | 0 | -7882 |
| stg_stats_standard | 7882 | 7882 | 0 |
| **TOTAL** | **73845** | **7882** | **-65963** |

Per-season breakdown (tables with DB rows)

- stg_stats_standard: DB rows = 7882
  - 2023-2024: 2852 rows (CSV)
  - 2024-2025: 2854 rows (CSV)
  - 2025-2026: 2176 rows (CSV)

How this file was produced

1. Run the comparison script inside the Compose app container to compute expected vs DB rows:

```bash
docker compose run --rm app python3 scripts/compare_all_seasons_counts.py
```

2. Export the tabular output into `data/staging_data/compare_summary.csv` (CSV) and this markdown (`compare_summary.md`) for quick human-readable reference.

3. Verify specific tables with non-zero DB rows using `scripts/report_staging_counts.py`.

Next actions

- If you want all tables populated, run the loader for missing tables (either with `--offset/--limit` or `--batches` to process logical table groups). See `src/load_stg_to_postgres.py --help` for details.
- Consider adding an automated periodic job that re-runs `scripts/compare_all_seasons_counts.py` and uploads `compare_summary.csv` to CI artifacts when ingestion jobs run.
