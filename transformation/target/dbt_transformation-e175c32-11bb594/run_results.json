{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-01T12:33:06.851521Z", "invocation_id": "2397154f-4046-45c7-b21f-a6b73263cc40", "invocation_started_at": "2025-12-01T12:33:00.920084Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:33:06.559076Z", "completed_at": "2025-12-01T12:33:06.582415Z"}, {"name": "execute", "started_at": "2025-12-01T12:33:06.583374Z", "completed_at": "2025-12-01T12:33:06.830327Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2741584777832031, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__standard", "compiled": true, "compiled_code": "-- 1. CONFIGURATION\n\n\nWITH raw_union AS (\n    \n        SELECT \n            *, \n            '2023_2024' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2023_2024\"\n         UNION ALL \n    \n        SELECT \n            *, \n            '2024_2025' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2024_2025\"\n         UNION ALL \n    \n        SELECT \n            *, \n            '2025_2026' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2025_2026\"\n        \n    \n),\n\ncleaned AS (\n    SELECT\n        -- 1. IDENTITY (The Golden Key)\n        \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n        \n        -- 2. METADATA\n        unnamed_1_level_0_player as player_name,\n        unnamed_2_level_0_nation as nation,\n        unnamed_4_level_0_squad  as squad,\n        unnamed_3_level_0_pos    as primary_position,\n        unnamed_5_level_0_comp   as competition,\n        source_season_id         as season_id,\n        \n        -- 3. DEMOGRAPHICS\n        \n    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)\n as age,\n        \n    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)\n as birth_year,\n\n        -- 4. PLAYING TIME\n        \n    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)\n as matches_played,\n        \n    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)\n as matches_started,\n        \n    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)\n as minutes_played,\n        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,\n\n        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)\n        \n    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)\n as goals,\n        \n    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)\n as assists,\n        \n    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)\n as goals_assists,\n        \n    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)\n as penalties_made,\n        \n    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)\n as penalties_att,\n        \n        -- 6. EXPECTED METRICS\n        TRY_CAST(expected_xg AS FLOAT) as xg,\n        TRY_CAST(expected_npxg AS FLOAT) as npxg,\n        TRY_CAST(expected_xag AS FLOAT) as xag,\n        \n        -- 7. PROGRESSION\n        \n    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)\n as progressive_carries,\n        \n    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)\n as progressive_passes,\n        \n    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)\n as progressive_receptions\n\n    FROM raw_union\n)\n\nSELECT * FROM cleaned\nWHERE player_name != 'Player' -- Filter header rows\n  AND player_name IS NOT NULL", "relation_name": "\"players\".\"main\".\"stg_fbref__standard\"", "batch_results": null}], "elapsed_time": 0.48541975021362305, "args": {"upload_to_artifacts_ingest_api": false, "strict_mode": false, "project_dir": "/app/transformation", "require_resource_names_without_spaces": true, "indirect_selection": "eager", "require_yaml_configuration_for_mf_time_spines": false, "static_parser": true, "vars": {}, "use_fast_test_edges": false, "require_generic_test_arguments_property": true, "require_nested_cumulative_type_params": false, "exclude_resource_types": [], "macro_debugging": false, "invocation_command": "dbt build --select nextgeneu_players.staging.general.stg_fbref__standard", "partial_parse_file_diff": true, "send_anonymous_usage_stats": false, "log_format_file": "json", "show_resource_report": false, "populate_cache": true, "skip_nodes_if_on_run_start_fails": false, "exclude": [], "show": false, "log_level": "info", "state_modified_compare_vars": false, "version_check": true, "resource_types": [], "export_saved_queries": false, "log_level_file": "debug", "warn_error_options": {"error": [], "warn": [], "silence": []}, "partial_parse": true, "write_json": true, "log_path": "/app/transformation/target/dbt_transformation-e175c32-11bb594", "profiles_dir": "/app/transformation", "require_all_warnings_handled_by_warn_error": false, "introspect": true, "source_freshness_run_project_hooks": true, "printer_width": 80, "use_colors_file": true, "empty": false, "quiet": false, "log_format": "json", "require_explicit_package_overrides_for_builtin_materializations": true, "target_path": "target/dbt_transformation-e175c32-11bb594", "select": ["nextgeneu_players.staging.general.stg_fbref__standard"], "which": "build", "print": true, "include_saved_query": false, "validate_macro_args": false, "cache_selected_only": false, "show_all_deprecations": false, "favor_state": false, "use_colors": true, "require_batched_execution_for_custom_microbatch_strategy": false, "defer": false, "state_modified_compare_more_unrendered_values": false, "log_file_max_bytes": 10485760}}