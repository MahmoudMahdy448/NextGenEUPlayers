{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-01T12:22:55.919158Z", "invocation_id": "dbccc184-bd68-4ff7-905c-56928fe247a7", "invocation_started_at": "2025-12-01T12:22:51.994288Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:54.876459Z", "completed_at": "2025-12-01T12:22:54.889105Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:54.889782Z", "completed_at": "2025-12-01T12:22:54.987037Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1125335693359375, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"advanced_goalkeeping_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"advanced_goalkeeping_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"advanced_goalkeeping_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    TRY_CAST(expected_psxg AS FLOAT) as psxg, -- Post-Shot Expected Goals (How hard were the shots?)\n    TRY_CAST(expected_psxg_1 AS FLOAT) as psxg_plus_minus, -- The \"Shot Stopping\" Metric\n    \n    \n    TRY_CAST(REPLACE(launched_cmp, ',', '') AS INTEGER)\n as long_passes_completed,\n    TRY_CAST(launched_cmp_1 AS FLOAT) as long_pass_completion_pct,\n    \n    \n    TRY_CAST(REPLACE(crosses_stp, ',', '') AS INTEGER)\n as crosses_stopped,\n    TRY_CAST(crosses_stp_1 AS FLOAT) as crosses_stopped_pct,\n    \n    \n    TRY_CAST(REPLACE(sweeper_opa, ',', '') AS INTEGER)\n as defensive_actions_outside_pen_area\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__adv_goalkeeping\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:54.993778Z", "completed_at": "2025-12-01T12:22:55.001597Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.002423Z", "completed_at": "2025-12-01T12:22:55.045733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.053911447525024414, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__creation", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"goal_and_shot_creation_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"goal_and_shot_creation_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"goal_and_shot_creation_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(sca_sca, ',', '') AS INTEGER)\n as shot_creating_actions,\n    \n    TRY_CAST(REPLACE(gca_gca, ',', '') AS INTEGER)\n as goal_creating_actions\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__creation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.051448Z", "completed_at": "2025-12-01T12:22:55.059969Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.060733Z", "completed_at": "2025-12-01T12:22:55.166053Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1168830394744873, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__defense", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"defensive_actions_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"defensive_actions_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"defensive_actions_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(tackles_tkl, ',', '') AS INTEGER)\n as tackles_total,\n    \n    TRY_CAST(REPLACE(tackles_tklw, ',', '') AS INTEGER)\n as tackles_won,\n    \n    TRY_CAST(REPLACE(tackles_att_3rd, ',', '') AS INTEGER)\n as tackles_att_3rd,\n    \n    TRY_CAST(REPLACE(unnamed_21_level_0_int, ',', '') AS INTEGER)\n as interceptions,\n    \n    TRY_CAST(REPLACE(unnamed_23_level_0_clr, ',', '') AS INTEGER)\n as clearances,\n    \n    TRY_CAST(REPLACE(blocks_sh, ',', '') AS INTEGER)\n as shots_blocked\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__defense\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.173042Z", "completed_at": "2025-12-01T12:22:55.182414Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.183229Z", "completed_at": "2025-12-01T12:22:55.228822Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0581667423248291, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__goalkeeping", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"goalkeeping_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"goalkeeping_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"goalkeeping_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)\n as goals_against,\n    \n    TRY_CAST(REPLACE(performance_saves, ',', '') AS INTEGER)\n as saves,\n    TRY_CAST(performance_save AS FLOAT) as save_pct,\n    \n    TRY_CAST(REPLACE(performance_cs, ',', '') AS INTEGER)\n as clean_sheets,\n    TRY_CAST(performance_cs_1 AS FLOAT) as clean_sheet_pct,\n    \n    TRY_CAST(REPLACE(penalty_kicks_pka, ',', '') AS INTEGER)\n as pk_allowed,\n    \n    TRY_CAST(REPLACE(penalty_kicks_pksv, ',', '') AS INTEGER)\n as pk_saved\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__goalkeeping\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.234610Z", "completed_at": "2025-12-01T12:22:55.246585Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.247524Z", "completed_at": "2025-12-01T12:22:55.291778Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05940723419189453, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__misc", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"miscellaneous_stats_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"miscellaneous_stats_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"miscellaneous_stats_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(performance_crdy, ',', '') AS INTEGER)\n as yellow_cards,\n    \n    TRY_CAST(REPLACE(performance_crdr, ',', '') AS INTEGER)\n as red_cards,\n    \n    TRY_CAST(REPLACE(performance_fls, ',', '') AS INTEGER)\n as fouls_committed,\n    \n    TRY_CAST(REPLACE(performance_fld, ',', '') AS INTEGER)\n as fouls_drawn,\n    \n    TRY_CAST(REPLACE(performance_off, ',', '') AS INTEGER)\n as offsides,\n    \n    TRY_CAST(REPLACE(performance_recov, ',', '') AS INTEGER)\n as ball_recoveries,\n    \n    TRY_CAST(REPLACE(aerial_duels_won, ',', '') AS INTEGER)\n as aerials_won,\n    \n    TRY_CAST(REPLACE(aerial_duels_lost, ',', '') AS INTEGER)\n as aerials_lost\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__misc\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.298750Z", "completed_at": "2025-12-01T12:22:55.310804Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.311557Z", "completed_at": "2025-12-01T12:22:55.355170Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.058858394622802734, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__pass_types", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"pass_types_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"pass_types_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"pass_types_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    -- High Value Creation Stats\n    \n    TRY_CAST(REPLACE(pass_types_tb, ',', '') AS INTEGER)\n as through_balls,\n    \n    TRY_CAST(REPLACE(pass_types_sw, ',', '') AS INTEGER)\n as switches,\n    \n    TRY_CAST(REPLACE(pass_types_crs, ',', '') AS INTEGER)\n as crosses,\n    \n    TRY_CAST(REPLACE(corner_kicks_in, ',', '') AS INTEGER)\n as corners_inswing,\n    \n    TRY_CAST(REPLACE(corner_kicks_out, ',', '') AS INTEGER)\n as corners_outswing\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__pass_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.360944Z", "completed_at": "2025-12-01T12:22:55.370548Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.371281Z", "completed_at": "2025-12-01T12:22:55.418190Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05966925621032715, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__passing", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"passing_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"passing_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"passing_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(total_cmp, ',', '') AS INTEGER)\n as passes_completed,\n    \n    TRY_CAST(REPLACE(total_att, ',', '') AS INTEGER)\n as passes_attempted,\n    \n    TRY_CAST(REPLACE(total_prgdist, ',', '') AS INTEGER)\n as pass_progressive_distance,\n    \n    TRY_CAST(REPLACE(unnamed_27_level_0_kp, ',', '') AS INTEGER)\n as key_passes,\n    \n    TRY_CAST(REPLACE(unnamed_29_level_0_ppa, ',', '') AS INTEGER)\n as passes_into_penalty_area,\n    \n    TRY_CAST(REPLACE(unnamed_30_level_0_crspa, ',', '') AS INTEGER)\n as crosses_into_penalty_area\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__passing\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.425434Z", "completed_at": "2025-12-01T12:22:55.434432Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.435314Z", "completed_at": "2025-12-01T12:22:55.481021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.058049917221069336, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__playing_time", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"playing_time_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"playing_time_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"playing_time_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_1_level_0_player as player_name,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)\n as matches_played,\n    \n    TRY_CAST(REPLACE(starts_starts, ',', '') AS INTEGER)\n as starts,\n    \n    TRY_CAST(REPLACE(subs_subs, ',', '') AS INTEGER)\n as substitutions_on,\n    \n    TRY_CAST(REPLACE(subs_unsub, ',', '') AS INTEGER)\n as unused_sub,\n    \n    -- Team Success (Plus/Minus)\n    TRY_CAST(team_success_onoff AS FLOAT) as plus_minus_net_per_90\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__playing_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.486507Z", "completed_at": "2025-12-01T12:22:55.495578Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.496240Z", "completed_at": "2025-12-01T12:22:55.539798Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.055208683013916016, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__possession", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"possession_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"possession_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"possession_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(touches_touches, ',', '') AS INTEGER)\n as touches,\n    \n    TRY_CAST(REPLACE(touches_att_pen, ',', '') AS INTEGER)\n as touches_att_pen,\n    \n    TRY_CAST(REPLACE(takeons_succ, ',', '') AS INTEGER)\n as takeons_won,\n    \n    TRY_CAST(REPLACE(takeons_att, ',', '') AS INTEGER)\n as takeons_attempted,\n    \n    TRY_CAST(REPLACE(carries_prgdist, ',', '') AS INTEGER)\n as carry_progressive_distance,\n    \n    TRY_CAST(REPLACE(carries_cpa, ',', '') AS INTEGER)\n as carries_into_penalty_area\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__possession\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.545799Z", "completed_at": "2025-12-01T12:22:55.553410Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.554006Z", "completed_at": "2025-12-01T12:22:55.599738Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05632352828979492, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__shooting", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"shooting_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"shooting_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"shooting_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(standard_sh, ',', '') AS INTEGER)\n as shots_total,\n    \n    TRY_CAST(REPLACE(standard_sot, ',', '') AS INTEGER)\n as shots_on_target,\n    TRY_CAST(standard_dist AS FLOAT) as avg_shot_distance\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__shooting\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.606604Z", "completed_at": "2025-12-01T12:22:55.618976Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.619953Z", "completed_at": "2025-12-01T12:22:55.661847Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05765795707702637, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__standard", "compiled": true, "compiled_code": "-- 1. CONFIGURATION\n\n\nWITH raw_union AS (\n    \n        SELECT \n            *, \n            '2023_2024' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2023_2024\"\n         UNION ALL \n    \n        SELECT \n            *, \n            '2024_2025' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2024_2025\"\n         UNION ALL \n    \n        SELECT \n            *, \n            '2025_2026' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2025_2026\"\n        \n    \n),\n\ncleaned AS (\n    SELECT\n        -- 1. IDENTITY (The Golden Key)\n        \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n        \n        -- 2. METADATA\n        unnamed_1_level_0_player as player_name,\n        unnamed_2_level_0_nation as nation,\n        unnamed_4_level_0_squad  as squad,\n        unnamed_3_level_0_pos    as primary_position,\n        unnamed_5_level_0_comp   as competition,\n        source_season_id         as season_id,\n        \n        -- 3. DEMOGRAPHICS\n        \n    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)\n as age,\n        \n    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)\n as birth_year,\n\n        -- 4. PLAYING TIME\n        \n    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)\n as matches_played,\n        \n    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)\n as matches_started,\n        \n    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)\n as minutes_played,\n        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,\n\n        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)\n        \n    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)\n as goals,\n        \n    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)\n as assists,\n        \n    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)\n as goals_assists,\n        \n    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)\n as penalties_made,\n        \n    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)\n as penalties_att,\n        \n        -- 6. EXPECTED METRICS\n        TRY_CAST(expected_xg AS FLOAT) as xg,\n        TRY_CAST(expected_npxg AS FLOAT) as npxg,\n        TRY_CAST(expected_xag AS FLOAT) as xag,\n        \n        -- 7. PROGRESSION\n        \n    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)\n as progressive_carries,\n        \n    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)\n as progressive_passes,\n        \n    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)\n as progressive_receptions\n\n    FROM raw_union\n)\n\nSELECT * FROM cleaned\nWHERE player_name != 'Player' -- Filter header rows\n  AND player_name IS NOT NULL", "relation_name": "\"players\".\"main\".\"stg_fbref__standard\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.668175Z", "completed_at": "2025-12-01T12:22:55.673978Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.674727Z", "completed_at": "2025-12-01T12:22:55.721453Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.055531978607177734, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.int_goalkeeper_season_stats", "compiled": true, "compiled_code": "WITH base AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__standard\"), -- We still need Standard for Age/Nation/Minutes\n     gk_basic AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__goalkeeping\"),\n     gk_adv   AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__adv_goalkeeping\")\n\nSELECT \n    b.player_id,\n    b.player_name,\n    b.season_id,\n    b.squad,\n    b.nation,\n    b.age,\n    b.birth_year,\n    b.minutes_90s,\n    \n    -- Basic\n    g.goals_against,\n    g.save_pct,\n    g.clean_sheet_pct,\n    g.pk_saved,\n    \n    -- Advanced (The Real Money Stats)\n    a.psxg,\n    a.psxg_plus_minus, -- Positive = Elite Shot Stopping\n    a.crosses_stopped_pct, -- Command of Area\n    a.defensive_actions_outside_pen_area as sweeper_actions,\n    a.long_pass_completion_pct\n\nFROM base b\nINNER JOIN gk_basic g USING (player_id, squad, season_id) -- Inner Join because we ONLY want GKs\nLEFT JOIN gk_adv a    USING (player_id, squad, season_id)", "relation_name": "\"players\".\"main\".\"int_goalkeeper_season_stats\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.727694Z", "completed_at": "2025-12-01T12:22:55.734372Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.735230Z", "completed_at": "2025-12-01T12:22:55.764316Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04553055763244629, "adapter_response": {}, "message": "Runtime Error in model int_player_season_stats (models/intermediate/int_player_season_stats.sql)\n  Binder Error: Values list \"c\" does not have a column named \"sca\"\n  \n  LINE 36:     coalesce(c.sca, 0) as sca,\n                        ^", "failures": null, "unique_id": "model.nextgeneu_players.int_player_season_stats", "compiled": true, "compiled_code": "WITH standard AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__standard\"),\n     shooting AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__shooting\"),\n     passing  AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__passing\"),\n     pass_types AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__pass_types\"),\n     defense  AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__defense\"),\n     poss     AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__possession\"),\n     misc     AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__misc\"),\n     creation AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__creation\"),\n     playing_time AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__playing_time\")\n\nSELECT\n    -- Anchors\n    s.player_id,\n    s.player_name,\n    s.season_id,\n    s.squad,\n    s.competition,\n    s.nation,\n    s.primary_position,\n    s.age,\n    s.birth_year,\n    s.minutes_played,\n    s.minutes_90s,\n\n    -- Attacking Metrics\n    s.goals,\n    s.assists,\n    s.npxg,\n    s.xag,\n    coalesce(sh.shots_total, 0) as shots_total,\n    coalesce(sh.shots_on_target, 0) as shots_on_target,\n    coalesce(c.sca, 0) as sca,\n    coalesce(c.gca, 0) as gca,\n\n    -- Possession & Creation\n    coalesce(p.key_passes, 0) as key_passes,\n    coalesce(p.pass_progressive_distance, 0) as pass_progressive_distance,\n    coalesce(pt.through_balls, 0) as through_balls,\n    coalesce(pt.switches, 0) as switches,\n    coalesce(pt.crosses, 0) as crosses,\n    coalesce(poss.carry_progressive_distance, 0) as carry_progressive_distance,\n    coalesce(poss.takeons_won, 0) as takeons_won,\n\n    -- Defensive Workrate\n    coalesce(d.tackles_won, 0) as tackles_won,\n    coalesce(d.interceptions, 0) as interceptions,\n    coalesce(d.tackles_att_3rd, 0) as tackles_att_3rd,\n    coalesce(m.ball_recoveries, 0) as recoveries,\n    coalesce(m.aerials_won, 0) as aerials_won,\n    \n    -- Playing Time / Team Impact\n    coalesce(tm.plus_minus, 0) as plus_minus,\n    coalesce(tm.plus_minus_per90, 0) as plus_minus_per90\n\nFROM standard s\nLEFT JOIN shooting sh USING (player_id, squad, season_id)\nLEFT JOIN passing p   USING (player_id, squad, season_id)\nLEFT JOIN pass_types pt USING (player_id, squad, season_id)\nLEFT JOIN defense d   USING (player_id, squad, season_id)\nLEFT JOIN poss        USING (player_id, squad, season_id)\nLEFT JOIN misc m      USING (player_id, squad, season_id)\nLEFT JOIN creation c  USING (player_id, squad, season_id)\nLEFT JOIN playing_time tm USING (player_id, squad, season_id)\n\n-- Filter out rows where the join keys might have drifted or empty names\nWHERE s.player_id IS NOT NULL", "relation_name": "\"players\".\"main\".\"int_player_season_stats\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T12:22:55.779637Z", "completed_at": "2025-12-01T12:22:55.786412Z"}, {"name": "execute", "started_at": "2025-12-01T12:22:55.787074Z", "completed_at": "2025-12-01T12:22:55.884702Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1071929931640625, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.mart_goalkeeping_analysis", "compiled": true, "compiled_code": "WITH base_stats AS (\n    SELECT * FROM \"players\".\"main\".\"int_goalkeeper_season_stats\"\n    WHERE minutes_90s >= 5.0\n),\n\nper_90_calculations AS (\n    SELECT \n        *,\n        -- Normalization\n        \n    CASE \n        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0\n        ELSE psxg_plus_minus / minutes_90s\n    END\n as psxg_plus_minus_per_90,\n        \n    CASE \n        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0\n        ELSE sweeper_actions / minutes_90s\n    END\n as sweeper_actions_per_90,\n        \n        -- FLAGS\n        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect\n    FROM base_stats\n)\n\nSELECT \n    *,\n    -- Percentiles (Compare GK vs GK only)\n    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY psxg_plus_minus_per_90 ASC) as percentile_shot_stopping,\n    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY crosses_stopped_pct ASC) as percentile_command,\n    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY sweeper_actions_per_90 ASC) as percentile_sweeping,\n    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY long_pass_completion_pct ASC) as percentile_distribution\nFROM per_90_calculations", "relation_name": "\"players\".\"main\".\"mart_goalkeeping_analysis\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nextgeneu_players.dim_players", "compiled": false, "compiled_code": null, "relation_name": "\"players\".\"main\".\"dim_players\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nextgeneu_players.mart_scouting_analysis", "compiled": false, "compiled_code": null, "relation_name": "\"players\".\"main\".\"mart_scouting_analysis\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nextgeneu_players.mart_player_trends", "compiled": false, "compiled_code": null, "relation_name": "\"players\".\"main\".\"mart_player_trends\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nextgeneu_players.mart_squad_profile", "compiled": false, "compiled_code": null, "relation_name": "\"players\".\"main\".\"mart_squad_profile\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nextgeneu_players.mart_transfer_valuation", "compiled": false, "compiled_code": null, "relation_name": "\"players\".\"main\".\"mart_transfer_valuation\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nextgeneu_players.mart_player_consistency", "compiled": false, "compiled_code": null, "relation_name": "\"players\".\"main\".\"mart_player_consistency\"", "batch_results": null}], "elapsed_time": 1.188615322113037, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true, "favor_state": false, "exclude": [], "require_yaml_configuration_for_mf_time_spines": false, "export_saved_queries": false, "require_resource_names_without_spaces": true, "state_modified_compare_vars": false, "strict_mode": false, "select": ["fqn:*"], "vars": {}, "log_path": "/app/transformation/target/dbt_transformation-9dd925e-1e84770", "send_anonymous_usage_stats": false, "upload_to_artifacts_ingest_api": false, "invocation_command": "dbt build --select fqn:*", "require_nested_cumulative_type_params": false, "version_check": true, "log_file_max_bytes": 10485760, "target_path": "target/dbt_transformation-9dd925e-1e84770", "partial_parse": true, "use_fast_test_edges": false, "show_resource_report": false, "populate_cache": true, "quiet": false, "empty": false, "exclude_resource_types": [], "use_colors": true, "show_all_deprecations": false, "write_json": true, "show": false, "log_level_file": "debug", "profiles_dir": "/app/transformation", "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "source_freshness_run_project_hooks": true, "validate_macro_args": false, "indirect_selection": "eager", "log_format_file": "json", "log_format": "json", "partial_parse_file_diff": true, "macro_debugging": false, "require_all_warnings_handled_by_warn_error": false, "project_dir": "/app/transformation", "require_generic_test_arguments_property": true, "print": true, "skip_nodes_if_on_run_start_fails": false, "include_saved_query": false, "state_modified_compare_more_unrendered_values": false, "static_parser": true, "log_level": "info", "warn_error_options": {"error": [], "warn": [], "silence": []}, "which": "build", "printer_width": 80, "defer": false, "resource_types": [], "introspect": true}}