{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-01T03:46:53.810837Z", "invocation_id": "9913f819-a6f1-4906-9b16-00a027fc2a61", "invocation_started_at": "2025-12-01T03:46:47.591946Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-01T03:46:53.640356Z", "completed_at": "2025-12-01T03:46:53.650000Z"}, {"name": "execute", "started_at": "2025-12-01T03:46:53.650391Z", "completed_at": "2025-12-01T03:46:53.798359Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15961790084838867, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.mart_player_trends", "compiled": true, "compiled_code": "WITH combined_stats AS (\n    -- OUTFIELDERS\n    SELECT \n        player_id, player_name, season_id, squad, age, primary_position,\n        minutes_90s,\n        \n        -- 1. The Raw Scoring Metrics (Keep these for everyone!)\n        goals,\n        npxg,\n        expected_contribution_per_90, -- (npxG + xAG)\n        \n        -- 2. The Specialist Metrics\n        progression_total_dist_per_90,\n        defensive_actions_per_90,\n        0.0 as gk_metric\n    FROM \"players\".\"main\".\"mart_scouting_analysis\"\n    \n    UNION ALL\n    \n    -- GOALKEEPERS (Scoring is irrelevant, set to 0)\n    SELECT \n        player_id, player_name, season_id, squad, age, 'GK' as primary_position,\n        minutes_90s,\n        \n        0 as goals,\n        0.0 as npxg,\n        0.0 as expected_contribution_per_90,\n        \n        0.0 as progression_total_dist_per_90,\n        0.0 as defensive_actions_per_90,\n        psxg_plus_minus_per_90 as gk_metric\n    FROM \"players\".\"main\".\"mart_goalkeeping_analysis\"\n),\n\ncalc_indices AS (\n    SELECT \n        *,\n        -- TRACK A: The Specialist Index (Role-Based)\n        CASE \n            WHEN primary_position IN ('MF', 'MF,DF') THEN progression_total_dist_per_90\n            WHEN primary_position IN ('DF', 'DF,MF') THEN defensive_actions_per_90\n            WHEN primary_position = 'GK' THEN gk_metric\n            ELSE expected_contribution_per_90 -- For Attackers, Specialist = Scoring\n        END as specialist_index,\n        \n        -- TRACK B: The Universal Scoring Index (For all Outfielders)\n        expected_contribution_per_90 as scoring_index\n    FROM combined_stats\n    WHERE minutes_90s >= 5.0\n)\n\nSELECT \n    player_id, player_name, season_id, primary_position, age,\n    \n    -- Metrics\n    specialist_index,\n    scoring_index,\n    goals,\n    npxg,\n    \n    -- Trends (Calculated on the Specialist Index)\n    specialist_index - LAG(specialist_index) OVER (\n        PARTITION BY player_id ORDER BY season_id\n    ) as yoy_change_specialist,\n    \n    scoring_index - LAG(scoring_index) OVER (\n        PARTITION BY player_id ORDER BY season_id\n    ) as yoy_change_scoring\n\nFROM calc_indices", "relation_name": "\"players\".\"main\".\"mart_player_trends\"", "batch_results": null}], "elapsed_time": 1.4536304473876953, "args": {"upload_to_artifacts_ingest_api": false, "state_modified_compare_vars": false, "vars": {}, "which": "run", "print": true, "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "show_all_deprecations": false, "log_level": "info", "macro_debugging": false, "require_batched_execution_for_custom_microbatch_strategy": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "validate_macro_args": false, "log_format": "default", "defer": false, "quiet": false, "require_generic_test_arguments_property": true, "log_file_max_bytes": 10485760, "state_modified_compare_more_unrendered_values": false, "exclude": [], "log_path": "/app/transformation/logs", "use_fast_test_edges": false, "introspect": true, "use_colors_file": true, "require_nested_cumulative_type_params": false, "strict_mode": false, "invocation_command": "dbt run --select mart_player_trends --profiles-dir .", "empty": false, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": true, "indirect_selection": "eager", "cache_selected_only": false, "project_dir": "/app/transformation", "write_json": true, "printer_width": 80, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "log_level_file": "debug", "select": ["mart_player_trends"], "profiles_dir": ".", "require_all_warnings_handled_by_warn_error": false, "show_resource_report": false, "partial_parse": true, "require_resource_names_without_spaces": true, "static_parser": true, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "populate_cache": true, "use_colors": true, "favor_state": false}}