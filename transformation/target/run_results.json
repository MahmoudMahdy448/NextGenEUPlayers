{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-11-27T05:06:43.779427Z", "invocation_id": "5332c602-6510-4640-8425-be13ca8f0a4d", "invocation_started_at": "2025-11-27T05:06:41.900817Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.053390Z", "completed_at": "2025-11-27T05:06:43.067709Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.068152Z", "completed_at": "2025-11-27T05:06:43.155494Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10359787940979004, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__creation", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"goal_and_shot_creation_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"goal_and_shot_creation_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"goal_and_shot_creation_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(sca_sca, ',', '') AS INTEGER)\n as shot_creating_actions,\n    \n    TRY_CAST(REPLACE(gca_gca, ',', '') AS INTEGER)\n as goal_creating_actions\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__creation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.161056Z", "completed_at": "2025-11-27T05:06:43.167851Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.168276Z", "completed_at": "2025-11-27T05:06:43.195280Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035700082778930664, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__defense", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"defensive_actions_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"defensive_actions_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"defensive_actions_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(tackles_tkl, ',', '') AS INTEGER)\n as tackles_total,\n    \n    TRY_CAST(REPLACE(tackles_tklw, ',', '') AS INTEGER)\n as tackles_won,\n    \n    TRY_CAST(REPLACE(tackles_att_3rd, ',', '') AS INTEGER)\n as tackles_att_3rd,\n    \n    TRY_CAST(REPLACE(unnamed_21_level_0_int, ',', '') AS INTEGER)\n as interceptions,\n    \n    TRY_CAST(REPLACE(unnamed_23_level_0_clr, ',', '') AS INTEGER)\n as clearances,\n    \n    TRY_CAST(REPLACE(blocks_sh, ',', '') AS INTEGER)\n as shots_blocked\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__defense\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.199403Z", "completed_at": "2025-11-27T05:06:43.206897Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.207303Z", "completed_at": "2025-11-27T05:06:43.233312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03525686264038086, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__misc", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"miscellaneous_stats_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"miscellaneous_stats_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"miscellaneous_stats_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(performance_crdy, ',', '') AS INTEGER)\n as yellow_cards,\n    \n    TRY_CAST(REPLACE(performance_crdr, ',', '') AS INTEGER)\n as red_cards,\n    \n    TRY_CAST(REPLACE(performance_fls, ',', '') AS INTEGER)\n as fouls_committed,\n    \n    TRY_CAST(REPLACE(performance_fld, ',', '') AS INTEGER)\n as fouls_drawn,\n    \n    TRY_CAST(REPLACE(performance_off, ',', '') AS INTEGER)\n as offsides,\n    \n    TRY_CAST(REPLACE(performance_recov, ',', '') AS INTEGER)\n as ball_recoveries,\n    \n    TRY_CAST(REPLACE(aerial_duels_won, ',', '') AS INTEGER)\n as aerials_won,\n    \n    TRY_CAST(REPLACE(aerial_duels_lost, ',', '') AS INTEGER)\n as aerials_lost\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__misc\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.237939Z", "completed_at": "2025-11-27T05:06:43.245302Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.245712Z", "completed_at": "2025-11-27T05:06:43.273743Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03734302520751953, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__passing", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"passing_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"passing_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"passing_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(total_cmp, ',', '') AS INTEGER)\n as passes_completed,\n    \n    TRY_CAST(REPLACE(total_att, ',', '') AS INTEGER)\n as passes_attempted,\n    \n    TRY_CAST(REPLACE(total_prgdist, ',', '') AS INTEGER)\n as pass_progressive_distance,\n    \n    TRY_CAST(REPLACE(unnamed_27_level_0_kp, ',', '') AS INTEGER)\n as key_passes,\n    \n    TRY_CAST(REPLACE(unnamed_29_level_0_ppa, ',', '') AS INTEGER)\n as passes_into_penalty_area,\n    \n    TRY_CAST(REPLACE(unnamed_30_level_0_crspa, ',', '') AS INTEGER)\n as crosses_into_penalty_area\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__passing\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.277906Z", "completed_at": "2025-11-27T05:06:43.283861Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.284309Z", "completed_at": "2025-11-27T05:06:43.368962Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0923757553100586, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__playing_time", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"playing_time_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"playing_time_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"playing_time_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_1_level_0_player as player_name,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)\n as matches_played,\n    \n    TRY_CAST(REPLACE(starts_starts, ',', '') AS INTEGER)\n as starts,\n    \n    TRY_CAST(REPLACE(subs_subs, ',', '') AS INTEGER)\n as substitutions_on,\n    \n    TRY_CAST(REPLACE(subs_unsub, ',', '') AS INTEGER)\n as unused_sub,\n    \n    -- Team Success (Plus/Minus)\n    TRY_CAST(team_success_onoff AS FLOAT) as plus_minus_net_per_90\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__playing_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.373750Z", "completed_at": "2025-11-27T05:06:43.380168Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.380581Z", "completed_at": "2025-11-27T05:06:43.408447Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03606605529785156, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__possession", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"possession_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"possession_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"possession_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(touches_touches, ',', '') AS INTEGER)\n as touches,\n    \n    TRY_CAST(REPLACE(touches_att_pen, ',', '') AS INTEGER)\n as touches_att_pen,\n    \n    TRY_CAST(REPLACE(takeons_succ, ',', '') AS INTEGER)\n as takeons_won,\n    \n    TRY_CAST(REPLACE(takeons_att, ',', '') AS INTEGER)\n as takeons_attempted,\n    \n    TRY_CAST(REPLACE(carries_prgdist, ',', '') AS INTEGER)\n as carry_progressive_distance,\n    \n    TRY_CAST(REPLACE(carries_cpa, ',', '') AS INTEGER)\n as carries_into_penalty_area\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__possession\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.413121Z", "completed_at": "2025-11-27T05:06:43.419067Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.419494Z", "completed_at": "2025-11-27T05:06:43.446859Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03523874282836914, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__shooting", "compiled": true, "compiled_code": "\n\nWITH raw_union AS (\n    \n        SELECT *, '2023_2024' as source_season_id FROM \"players\".\"raw\".\"shooting_2023_2024\"\n         UNION ALL \n    \n        SELECT *, '2024_2025' as source_season_id FROM \"players\".\"raw\".\"shooting_2024_2025\"\n         UNION ALL \n    \n        SELECT *, '2025_2026' as source_season_id FROM \"players\".\"raw\".\"shooting_2025_2026\"\n        \n    \n)\n\nSELECT\n    \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n    unnamed_4_level_0_squad  as squad,\n    source_season_id         as season_id,\n    \n    \n    TRY_CAST(REPLACE(standard_sh, ',', '') AS INTEGER)\n as shots_total,\n    \n    TRY_CAST(REPLACE(standard_sot, ',', '') AS INTEGER)\n as shots_on_target,\n    TRY_CAST(standard_dist AS FLOAT) as avg_shot_distance\n\nFROM raw_union\nWHERE unnamed_1_level_0_player != 'Player'", "relation_name": "\"players\".\"main\".\"stg_fbref__shooting\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.451384Z", "completed_at": "2025-11-27T05:06:43.459929Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.460350Z", "completed_at": "2025-11-27T05:06:43.498157Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04829049110412598, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.stg_fbref__standard", "compiled": true, "compiled_code": "-- 1. CONFIGURATION\n\n\nWITH raw_union AS (\n    \n        SELECT \n            *, \n            '2023_2024' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2023_2024\"\n         UNION ALL \n    \n        SELECT \n            *, \n            '2024_2025' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2024_2025\"\n         UNION ALL \n    \n        SELECT \n            *, \n            '2025_2026' as source_season_id \n        FROM \"players\".\"raw\".\"standard_stats_2025_2026\"\n        \n    \n),\n\ncleaned AS (\n    SELECT\n        -- 1. IDENTITY (The Golden Key)\n        \n    md5(concat(\n        coalesce(unnamed_1_level_0_player, ''), \n        '-', \n        coalesce(unnamed_7_level_0_born, ''), \n        '-', \n        coalesce(unnamed_2_level_0_nation, '')\n    ))\n as player_id,\n        \n        -- 2. METADATA\n        unnamed_1_level_0_player as player_name,\n        unnamed_2_level_0_nation as nation,\n        unnamed_4_level_0_squad  as squad,\n        unnamed_3_level_0_pos    as primary_position,\n        unnamed_5_level_0_comp   as competition,\n        source_season_id         as season_id,\n        \n        -- 3. DEMOGRAPHICS\n        \n    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)\n as age,\n        \n    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)\n as birth_year,\n\n        -- 4. PLAYING TIME\n        \n    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)\n as matches_played,\n        \n    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)\n as matches_started,\n        \n    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)\n as minutes_played,\n        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,\n\n        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)\n        \n    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)\n as goals,\n        \n    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)\n as assists,\n        \n    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)\n as goals_assists,\n        \n    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)\n as penalties_made,\n        \n    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)\n as penalties_att,\n        \n        -- 6. EXPECTED METRICS\n        TRY_CAST(expected_xg AS FLOAT) as xg,\n        TRY_CAST(expected_npxg AS FLOAT) as npxg,\n        TRY_CAST(expected_xag AS FLOAT) as xag,\n        \n        -- 7. PROGRESSION\n        \n    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)\n as progressive_carries,\n        \n    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)\n as progressive_passes,\n        \n    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)\n as progressive_receptions\n\n    FROM raw_union\n)\n\nSELECT * FROM cleaned\nWHERE player_name != 'Player' -- Filter header rows\n  AND player_name IS NOT NULL", "relation_name": "\"players\".\"main\".\"stg_fbref__standard\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.502874Z", "completed_at": "2025-11-27T05:06:43.509252Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.509837Z", "completed_at": "2025-11-27T05:06:43.545536Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04407835006713867, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.int_player_season_stats", "compiled": true, "compiled_code": "WITH standard AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__standard\"),\n     shooting AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__shooting\"),\n     passing  AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__passing\"),\n     defense  AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__defense\"),\n     poss     AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__possession\"),\n     misc     AS (SELECT * FROM \"players\".\"main\".\"stg_fbref__misc\")\n\nSELECT\n    -- Anchors\n    s.player_id,\n    s.player_name,\n    s.season_id,\n    s.squad,\n    s.competition,\n    s.nation,\n    s.primary_position,\n    s.age,\n    s.birth_year,\n    s.minutes_played,\n    s.minutes_90s,\n\n    -- Attacking Metrics\n    s.goals,\n    s.assists,\n    s.npxg,\n    s.xag,\n    coalesce(sh.shots_total, 0) as shots_total,\n    coalesce(sh.shots_on_target, 0) as shots_on_target,\n\n    -- Possession & Creation\n    coalesce(p.key_passes, 0) as key_passes,\n    coalesce(p.pass_progressive_distance, 0) as pass_progressive_distance,\n    coalesce(poss.carry_progressive_distance, 0) as carry_progressive_distance,\n    coalesce(poss.takeons_won, 0) as takeons_won,\n\n    -- Defensive Workrate\n    coalesce(d.tackles_won, 0) as tackles_won,\n    coalesce(d.interceptions, 0) as interceptions,\n    coalesce(d.tackles_att_3rd, 0) as tackles_att_3rd,\n    coalesce(m.ball_recoveries, 0) as recoveries,\n    coalesce(m.aerials_won, 0) as aerials_won\n\nFROM standard s\nLEFT JOIN shooting sh USING (player_id, squad, season_id)\nLEFT JOIN passing p   USING (player_id, squad, season_id)\nLEFT JOIN defense d   USING (player_id, squad, season_id)\nLEFT JOIN poss        USING (player_id, squad, season_id)\nLEFT JOIN misc m      USING (player_id, squad, season_id)\n\n-- Filter out rows where the join keys might have drifted or empty names\nWHERE s.player_id IS NOT NULL", "relation_name": "\"players\".\"main\".\"int_player_season_stats\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.550289Z", "completed_at": "2025-11-27T05:06:43.553594Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.554052Z", "completed_at": "2025-11-27T05:06:43.650314Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10141348838806152, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.dim_players", "compiled": true, "compiled_code": "WITH unique_players AS (\n    SELECT \n        player_id,\n        -- Get the most recently used name (in case it changed)\n        arg_max(player_name, season_id) as player_name,\n        -- Get the most recent nation/position\n        arg_max(nation, season_id) as nation,\n        arg_max(primary_position, season_id) as primary_position,\n        max(birth_year) as birth_year\n    FROM \"players\".\"main\".\"int_player_season_stats\"\n    GROUP BY player_id\n)\n\nSELECT * FROM unique_players", "relation_name": "\"players\".\"main\".\"dim_players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-27T05:06:43.654619Z", "completed_at": "2025-11-27T05:06:43.660460Z"}, {"name": "execute", "started_at": "2025-11-27T05:06:43.660913Z", "completed_at": "2025-11-27T05:06:43.768739Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11572480201721191, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nextgeneu_players.mart_scouting_analysis", "compiled": true, "compiled_code": "WITH base_stats AS (\n    SELECT * FROM \"players\".\"main\".\"int_player_season_stats\"\n    WHERE minutes_90s >= 5.0 -- Filter: Remove noise (players with < 5 games)\n),\n\nper_90_calculations AS (\n    SELECT \n        *,\n        -- 1. ATTACK SCORES\n        \n    CASE \n        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0\n        ELSE goals + assists / minutes_90s\n    END\n as goal_contribution_per_90,\n        \n    CASE \n        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0\n        ELSE npxg + xag / minutes_90s\n    END\n as expected_contribution_per_90,\n        \n        -- 2. PROGRESSION SCORES (The \"Engine\" Metric)\n        \n    CASE \n        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0\n        ELSE pass_progressive_distance + carry_progressive_distance / minutes_90s\n    END\n as progression_total_dist_per_90,\n        \n        -- 3. DEFENSIVE SCORES (The \"Workrate\" Metric)\n        \n    CASE \n        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0\n        ELSE tackles_won + interceptions + recoveries / minutes_90s\n    END\n as defensive_actions_per_90,\n        \n        -- 4. FLAGS\n        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect\n    FROM base_stats\n)\n\nSELECT \n    *,\n    -- Percentile Ranks (0.0 to 1.0)\n    -- Compare players only against peers in the SAME position and SAME season\n    PERCENT_RANK() OVER (\n        PARTITION BY season_id, primary_position \n        ORDER BY expected_contribution_per_90 ASC\n    ) as percentile_attacking,\n\n    PERCENT_RANK() OVER (\n        PARTITION BY season_id, primary_position \n        ORDER BY progression_total_dist_per_90 ASC\n    ) as percentile_progression,\n\n    PERCENT_RANK() OVER (\n        PARTITION BY season_id, primary_position \n        ORDER BY defensive_actions_per_90 ASC\n    ) as percentile_defense\n\nFROM per_90_calculations", "relation_name": "\"players\".\"main\".\"mart_scouting_analysis\"", "batch_results": null}], "elapsed_time": 0.8521978855133057, "args": {"require_generic_test_arguments_property": true, "show_all_deprecations": false, "exclude_resource_types": [], "show": false, "introspect": true, "defer": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "strict_mode": false, "invocation_command": "dbt build", "partial_parse_file_diff": true, "version_check": true, "export_saved_queries": false, "populate_cache": true, "indirect_selection": "eager", "project_dir": "/app/transformation", "require_resource_names_without_spaces": true, "upload_to_artifacts_ingest_api": false, "show_resource_report": false, "static_parser": true, "favor_state": false, "cache_selected_only": false, "print": true, "log_level": "info", "validate_macro_args": false, "vars": {}, "require_yaml_configuration_for_mf_time_spines": false, "log_format": "default", "log_level_file": "debug", "profiles_dir": "/app/transformation", "select": [], "require_all_warnings_handled_by_warn_error": false, "send_anonymous_usage_stats": true, "write_json": true, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors": true, "log_file_max_bytes": 10485760, "warn_error_options": {"error": [], "warn": [], "silence": []}, "printer_width": 80, "macro_debugging": false, "quiet": false, "which": "build", "require_nested_cumulative_type_params": false, "partial_parse": true, "empty": false, "log_path": "/app/transformation/logs", "include_saved_query": false, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_vars": false, "use_colors_file": true, "exclude": [], "state_modified_compare_more_unrendered_values": false, "resource_types": [], "use_fast_test_edges": false, "source_freshness_run_project_hooks": true}}