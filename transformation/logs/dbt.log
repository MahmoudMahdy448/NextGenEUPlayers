[0m04:50:13.218408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b012006d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b010772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b000e82b0>]}


============================== 04:50:13.223568 | b7deb886-db19-4fcf-ac75-f8703731a5a1 ==============================
[0m04:50:13.223568 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:50:13.224197 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'empty': 'None', 'log_path': '/app/transformation/logs', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/app/transformation', 'write_json': 'True'}
[0m04:50:13.367868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7deb886-db19-4fcf-ac75-f8703731a5a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b000e9120>]}
[0m04:50:13.381408 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vg4g_vac'
[0m04:50:13.381953 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:50:13.430710 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:50:13.432140 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:50:13.472969 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:50:13.488014 [info ] [MainThread]: Updating lock file in file path: /app/transformation/package-lock.yml
[0m04:50:13.490475 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kray4k_2'
[0m04:50:13.494800 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:50:13.716371 [info ] [MainThread]: Installed from version 1.1.1
[0m04:50:13.717018 [info ] [MainThread]: Updated version available: 1.3.2
[0m04:50:13.717596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7deb886-db19-4fcf-ac75-f8703731a5a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b02fc1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4afff63490>]}
[0m04:50:13.718138 [info ] [MainThread]: 
[0m04:50:13.718646 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m04:50:13.720266 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5631116, "process_in_blocks": "22592", "process_kernel_time": 0.188878, "process_mem_max_rss": "102516", "process_out_blocks": "2240", "process_user_time": 2.015703}
[0m04:50:13.720971 [debug] [MainThread]: Command `dbt deps` succeeded at 04:50:13.720832 after 0.56 seconds
[0m04:50:13.721444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b012006d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b02fc1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b000e8bb0>]}
[0m04:50:13.721951 [debug] [MainThread]: Flushing usage events
[0m04:50:14.110997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:50:24.978963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76beed9706d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76beec871690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76beec872cb0>]}


============================== 04:50:24.984077 | 4b11f203-533c-45db-ba41-b5663d89cbbc ==============================
[0m04:50:24.984077 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:50:24.984758 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/app/transformation/logs', 'log_format': 'default', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/app/transformation', 'fail_fast': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_fbref__standard', 'empty': 'False', 'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m04:50:25.236999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b11f203-533c-45db-ba41-b5663d89cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76beefc2ce50>]}
[0m04:50:25.307425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b11f203-533c-45db-ba41-b5663d89cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76beecb322f0>]}
[0m04:50:25.309316 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m04:50:25.414943 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m04:50:25.415885 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:50:25.416374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b11f203-533c-45db-ba41-b5663d89cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bee6c86950>]}
[0m04:50:27.038282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nextgeneu_players.marts
[0m04:50:27.050841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b11f203-533c-45db-ba41-b5663d89cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bee5e699f0>]}
[0m04:50:27.229461 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m04:50:27.231611 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m04:50:27.248499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b11f203-533c-45db-ba41-b5663d89cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bee8ecd660>]}
[0m04:50:27.249163 [info ] [MainThread]: Found 1 model, 33 sources, 586 macros
[0m04:50:27.249574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b11f203-533c-45db-ba41-b5663d89cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bee8ece380>]}
[0m04:50:27.251139 [info ] [MainThread]: 
[0m04:50:27.251572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:50:27.251975 [info ] [MainThread]: 
[0m04:50:27.252651 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:50:27.253647 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m04:50:27.297103 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m04:50:27.297601 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m04:50:27.297948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:50:27.305634 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m04:50:27.306061 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m04:50:27.306940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:50:27.307329 [debug] [MainThread]: Connection 'list_players' was properly closed.
[0m04:50:27.307765 [info ] [MainThread]: 
[0m04:50:27.308256 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m04:50:27.308928 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/app/data/duckdb/players.db": Conflicting lock is held in PID 0. However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/stable/connect/concurrency
[0m04:50:27.310015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3983612, "process_in_blocks": "9608", "process_kernel_time": 0.218056, "process_mem_max_rss": "159444", "process_out_blocks": "2640", "process_user_time": 3.96303}
[0m04:50:27.310555 [debug] [MainThread]: Command `dbt run` failed at 04:50:27.310427 after 2.40 seconds
[0m04:50:27.311002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bee8ecc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bee8ecf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bee690f6d0>]}
[0m04:50:27.311515 [debug] [MainThread]: Flushing usage events
[0m04:50:27.732276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:50:49.422514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77616ff606d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77616ee45690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77616ee46cb0>]}


============================== 04:50:49.427664 | 55ac068d-d4fe-4ac3-951c-a4d52b74f47d ==============================
[0m04:50:49.427664 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:50:49.428268 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'profiles_dir': '/app/transformation', 'invocation_command': 'dbt run --select stg_fbref__standard', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/app/transformation/logs', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'partial_parse': 'True'}
[0m04:50:49.683640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ac068d-d4fe-4ac3-951c-a4d52b74f47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7761721f8e50>]}
[0m04:50:49.759349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55ac068d-d4fe-4ac3-951c-a4d52b74f47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77616f0e22f0>]}
[0m04:50:49.761272 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m04:50:49.853360 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m04:50:49.981822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:50:49.982412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:50:49.989959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nextgeneu_players.marts
[0m04:50:50.026511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ac068d-d4fe-4ac3-951c-a4d52b74f47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776168e88130>]}
[0m04:50:50.172495 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m04:50:50.174474 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m04:50:50.191190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ac068d-d4fe-4ac3-951c-a4d52b74f47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776168e9f4f0>]}
[0m04:50:50.191685 [info ] [MainThread]: Found 1 model, 33 sources, 586 macros
[0m04:50:50.192100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ac068d-d4fe-4ac3-951c-a4d52b74f47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776168ec4c70>]}
[0m04:50:50.193686 [info ] [MainThread]: 
[0m04:50:50.194143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:50:50.194511 [info ] [MainThread]: 
[0m04:50:50.195121 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:50:50.195997 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m04:50:50.234651 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m04:50:50.235074 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m04:50:50.235411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:50:50.263561 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m04:50:50.264980 [debug] [ThreadPool]: On list_players: Close
[0m04:50:50.265720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m04:50:50.266232 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m04:50:50.274018 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:50:50.274381 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m04:50:50.274683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:50:50.275535 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:50:50.276709 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:50:50.277029 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m04:50:50.277614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:50:50.277923 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:50:50.278259 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m04:50:50.278790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:50:50.279615 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m04:50:50.280046 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:50:50.280500 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m04:50:50.281207 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:50:50.281605 [debug] [ThreadPool]: On create_players_main: Close
[0m04:50:50.282658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m04:50:50.288588 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m04:50:50.288908 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m04:50:50.289196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:50:50.289741 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:50:50.290041 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m04:50:50.290413 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m04:50:50.302417 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m04:50:50.303539 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m04:50:50.304056 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m04:50:50.304386 [debug] [ThreadPool]: On list_players_main: Close
[0m04:50:50.304930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ac068d-d4fe-4ac3-951c-a4d52b74f47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77616edbcbb0>]}
[0m04:50:50.305454 [debug] [MainThread]: Using duckdb connection "master"
[0m04:50:50.305773 [debug] [MainThread]: On master: BEGIN
[0m04:50:50.306069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:50:50.306732 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m04:50:50.307054 [debug] [MainThread]: On master: COMMIT
[0m04:50:50.307397 [debug] [MainThread]: Using duckdb connection "master"
[0m04:50:50.307704 [debug] [MainThread]: On master: COMMIT
[0m04:50:50.308211 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:50:50.308540 [debug] [MainThread]: On master: Close
[0m04:50:50.311562 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__standard
[0m04:50:50.312247 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_fbref__standard ........................... [RUN]
[0m04:50:50.312776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.stg_fbref__standard)
[0m04:50:50.313186 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__standard
[0m04:50:50.328496 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__standard"
[0m04:50:50.329410 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__standard
[0m04:50:50.366807 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__standard"
[0m04:50:50.367771 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:50:50.368174 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: BEGIN
[0m04:50:50.368534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:50:50.369433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:50:50.369813 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:50:50.370291 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

  
  create view "players"."main"."stg_fbref__standard__dbt_tmp" as (
    -- 1. CONFIGURATION


WITH raw_union AS (
    
        SELECT 
            *, 
            '2023_2024' as source_season_id 
        FROM "players"."raw"."standard_stats_2023_2024"
         UNION ALL 
    
        SELECT 
            *, 
            '2024_2025' as source_season_id 
        FROM "players"."raw"."standard_stats_2024_2025"
         UNION ALL 
    
        SELECT 
            *, 
            '2025_2026' as source_season_id 
        FROM "players"."raw"."standard_stats_2025_2026"
        
    
),

cleaned AS (
    SELECT
        -- 1. IDENTITY (The Golden Key)
        
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
        
        -- 2. METADATA
        unnamed_1_level_0_player as player_name,
        unnamed_2_level_0_nation as nation,
        unnamed_4_level_0_squad  as squad,
        unnamed_3_level_0_pos    as primary_position,
        unnamed_5_level_0_comp   as competition,
        source_season_id         as season_id,
        
        -- 3. DEMOGRAPHICS
        
    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)
 as age,
        
    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)
 as birth_year,

        -- 4. PLAYING TIME
        
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
        
    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)
 as matches_started,
        
    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)
 as minutes_played,
        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,

        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)
        
    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)
 as goals,
        
    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)
 as assists,
        
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_assists,
        
    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)
 as penalties_made,
        
    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)
 as penalties_att,
        
        -- 6. EXPECTED METRICS
        TRY_CAST(expected_xg AS FLOAT) as xg,
        TRY_CAST(expected_npxg AS FLOAT) as npxg,
        TRY_CAST(expected_xag AS FLOAT) as xag,
        
        -- 7. PROGRESSION
        
    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)
 as progressive_carries,
        
    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)
 as progressive_passes,
        
    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)
 as progressive_receptions

    FROM raw_union
)

SELECT * FROM cleaned
WHERE player_name != 'Player' -- Filter header rows
  AND player_name IS NOT NULL
  );

[0m04:50:50.372617 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:50:50.378964 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:50:50.379391 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard__dbt_tmp" rename to "stg_fbref__standard"
[0m04:50:50.380145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:50:50.389844 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m04:50:50.390260 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:50:50.390626 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m04:50:50.402981 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m04:50:50.409553 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:50:50.410064 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

      drop view if exists "players"."main"."stg_fbref__standard__dbt_backup" cascade
    
[0m04:50:50.411056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:50:50.413828 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: Close
[0m04:50:50.415653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55ac068d-d4fe-4ac3-951c-a4d52b74f47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776168e9da80>]}
[0m04:50:50.416377 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_fbref__standard ...................... [[32mOK[0m in 0.10s]
[0m04:50:50.417170 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__standard
[0m04:50:50.418309 [debug] [MainThread]: Using duckdb connection "master"
[0m04:50:50.418631 [debug] [MainThread]: On master: BEGIN
[0m04:50:50.418927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:50:50.419645 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m04:50:50.419979 [debug] [MainThread]: On master: COMMIT
[0m04:50:50.420350 [debug] [MainThread]: Using duckdb connection "master"
[0m04:50:50.420663 [debug] [MainThread]: On master: COMMIT
[0m04:50:50.421176 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:50:50.421508 [debug] [MainThread]: On master: Close
[0m04:50:50.421917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:50:50.422324 [debug] [MainThread]: Connection 'model.nextgeneu_players.stg_fbref__standard' was properly closed.
[0m04:50:50.422687 [info ] [MainThread]: 
[0m04:50:50.423111 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m04:50:50.424012 [debug] [MainThread]: Command end result
[0m04:50:50.459988 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m04:50:50.461959 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m04:50:50.468932 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/transformation/target/run_results.json
[0m04:50:50.469282 [info ] [MainThread]: 
[0m04:50:50.469782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:50:50.470232 [info ] [MainThread]: 
[0m04:50:50.470708 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:50:50.471708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1128616, "process_in_blocks": "128", "process_kernel_time": 0.192879, "process_mem_max_rss": "166348", "process_out_blocks": "2752", "process_user_time": 2.688325}
[0m04:50:50.472275 [debug] [MainThread]: Command `dbt run` succeeded at 04:50:50.472149 after 1.11 seconds
[0m04:50:50.472675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77616ff606d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77616fe136d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77616f6f28f0>]}
[0m04:50:50.473079 [debug] [MainThread]: Flushing usage events
[0m04:50:50.863787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:54:44.666731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314db324700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314da215690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314da216cb0>]}


============================== 04:54:44.671824 | 2b00efeb-c9ed-4742-ac6d-b0c72e21feb5 ==============================
[0m04:54:44.671824 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:54:44.672500 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'log_format': 'default', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/app/transformation', 'warn_error': 'None', 'log_path': '/app/transformation/logs'}
[0m04:54:44.940066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314dd0e5360>]}
[0m04:54:45.010387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314da1f3d90>]}
[0m04:54:45.012268 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m04:54:45.106400 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m04:54:45.229261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m04:54:45.229870 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/distribution/stg_fbref__passing.sql
[0m04:54:45.230262 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/distribution/stg_fbref__possession.sql
[0m04:54:45.230661 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/defense/stg_fbref__defense.sql
[0m04:54:45.231017 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/attack/stg_fbref__shooting.sql
[0m04:54:45.231394 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/intermediate/int_player_season_stats.sql
[0m04:54:45.231740 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/general/stg_fbref__misc.sql
[0m04:54:45.232095 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/attack/stg_fbref__creation.sql
[0m04:54:45.232444 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/general/stg_fbref__playing_time.sql
[0m04:54:45.617150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nextgeneu_players.marts
[0m04:54:45.634344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d3979de0>]}
[0m04:54:45.734177 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m04:54:45.736242 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m04:54:45.753290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d302e6e0>]}
[0m04:54:45.753802 [info ] [MainThread]: Found 9 models, 33 sources, 586 macros
[0m04:54:45.754243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d302e740>]}
[0m04:54:45.756533 [info ] [MainThread]: 
[0m04:54:45.756990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:54:45.757425 [info ] [MainThread]: 
[0m04:54:45.758150 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:54:45.765924 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m04:54:45.806409 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m04:54:45.806890 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m04:54:45.807238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:54:45.834465 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m04:54:45.836000 [debug] [ThreadPool]: On list_players: Close
[0m04:54:45.837063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m04:54:45.837666 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m04:54:45.845828 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:54:45.846186 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m04:54:45.846478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:54:45.847646 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:54:45.848907 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:54:45.849289 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m04:54:45.849878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:54:45.850235 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:54:45.850562 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m04:54:45.851161 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:54:45.851995 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m04:54:45.852389 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:54:45.852702 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m04:54:45.853234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:54:45.853572 [debug] [ThreadPool]: On create_players_main: Close
[0m04:54:45.855200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m04:54:45.860972 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m04:54:45.861334 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m04:54:45.861634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:54:45.862267 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:54:45.862593 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m04:54:45.862940 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m04:54:45.874216 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m04:54:45.875416 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m04:54:45.875933 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m04:54:45.876248 [debug] [ThreadPool]: On list_players_main: Close
[0m04:54:45.877045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d4183580>]}
[0m04:54:45.877562 [debug] [MainThread]: Using duckdb connection "master"
[0m04:54:45.877885 [debug] [MainThread]: On master: BEGIN
[0m04:54:45.878206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:54:45.878770 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m04:54:45.879111 [debug] [MainThread]: On master: COMMIT
[0m04:54:45.879431 [debug] [MainThread]: Using duckdb connection "master"
[0m04:54:45.879732 [debug] [MainThread]: On master: COMMIT
[0m04:54:45.880263 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:54:45.880612 [debug] [MainThread]: On master: Close
[0m04:54:45.883725 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__creation
[0m04:54:45.884277 [info ] [Thread-1 (]: 1 of 9 START sql view model main.stg_fbref__creation ........................... [RUN]
[0m04:54:45.884807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.stg_fbref__creation)
[0m04:54:45.885215 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__creation
[0m04:54:45.896072 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__creation"
[0m04:54:45.896754 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__creation
[0m04:54:45.928813 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__creation"
[0m04:54:45.929724 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m04:54:45.930149 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: BEGIN
[0m04:54:45.930520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:45.931483 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:45.931869 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m04:54:45.932303 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

  
  create view "players"."main"."stg_fbref__creation__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(sca_sca, ',', '') AS INTEGER)
 as shot_creating_actions,
    
    TRY_CAST(REPLACE(gca_gca, ',', '') AS INTEGER)
 as goal_creating_actions

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m04:54:45.933800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:45.940295 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m04:54:45.940699 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation__dbt_tmp" rename to "stg_fbref__creation"
[0m04:54:45.941475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:45.951979 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m04:54:45.952403 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m04:54:45.952761 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m04:54:45.971958 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m04:54:45.978663 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m04:54:45.979116 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

      drop view if exists "players"."main"."stg_fbref__creation__dbt_backup" cascade
    
[0m04:54:45.979813 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:45.982396 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: Close
[0m04:54:45.984119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d25b12a0>]}
[0m04:54:45.984779 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main.stg_fbref__creation ...................... [[32mOK[0m in 0.10s]
[0m04:54:45.985499 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__creation
[0m04:54:45.985923 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__defense
[0m04:54:45.986498 [info ] [Thread-1 (]: 2 of 9 START sql view model main.stg_fbref__defense ............................ [RUN]
[0m04:54:45.987017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__creation, now model.nextgeneu_players.stg_fbref__defense)
[0m04:54:45.987469 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__defense
[0m04:54:45.993852 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__defense"
[0m04:54:45.994503 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__defense
[0m04:54:45.997843 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__defense"
[0m04:54:45.998497 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m04:54:45.998873 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: BEGIN
[0m04:54:45.999245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:45.999885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.000304 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m04:54:46.000703 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

  
  create view "players"."main"."stg_fbref__defense__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."defensive_actions_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."defensive_actions_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."defensive_actions_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(tackles_tkl, ',', '') AS INTEGER)
 as tackles_total,
    
    TRY_CAST(REPLACE(tackles_tklw, ',', '') AS INTEGER)
 as tackles_won,
    
    TRY_CAST(REPLACE(tackles_att_3rd, ',', '') AS INTEGER)
 as tackles_att_3rd,
    
    TRY_CAST(REPLACE(unnamed_21_level_0_int, ',', '') AS INTEGER)
 as interceptions,
    
    TRY_CAST(REPLACE(unnamed_23_level_0_clr, ',', '') AS INTEGER)
 as clearances,
    
    TRY_CAST(REPLACE(blocks_sh, ',', '') AS INTEGER)
 as shots_blocked

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m04:54:46.002271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.005375 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m04:54:46.005764 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense__dbt_tmp" rename to "stg_fbref__defense"
[0m04:54:46.006449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.007610 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m04:54:46.007988 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m04:54:46.008359 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m04:54:46.010897 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.013442 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m04:54:46.013831 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

      drop view if exists "players"."main"."stg_fbref__defense__dbt_backup" cascade
    
[0m04:54:46.014491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.016668 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: Close
[0m04:54:46.017351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314da1d7d90>]}
[0m04:54:46.018051 [info ] [Thread-1 (]: 2 of 9 OK created sql view model main.stg_fbref__defense ....................... [[32mOK[0m in 0.03s]
[0m04:54:46.018852 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__defense
[0m04:54:46.019331 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__misc
[0m04:54:46.019879 [info ] [Thread-1 (]: 3 of 9 START sql view model main.stg_fbref__misc ............................... [RUN]
[0m04:54:46.020536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__defense, now model.nextgeneu_players.stg_fbref__misc)
[0m04:54:46.020963 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__misc
[0m04:54:46.027904 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__misc"
[0m04:54:46.028528 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__misc
[0m04:54:46.031821 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__misc"
[0m04:54:46.032426 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m04:54:46.032828 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: BEGIN
[0m04:54:46.033233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:46.033980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.034388 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m04:54:46.034804 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

  
  create view "players"."main"."stg_fbref__misc__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."miscellaneous_stats_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."miscellaneous_stats_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."miscellaneous_stats_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_crdy, ',', '') AS INTEGER)
 as yellow_cards,
    
    TRY_CAST(REPLACE(performance_crdr, ',', '') AS INTEGER)
 as red_cards,
    
    TRY_CAST(REPLACE(performance_fls, ',', '') AS INTEGER)
 as fouls_committed,
    
    TRY_CAST(REPLACE(performance_fld, ',', '') AS INTEGER)
 as fouls_drawn,
    
    TRY_CAST(REPLACE(performance_off, ',', '') AS INTEGER)
 as offsides,
    
    TRY_CAST(REPLACE(performance_recov, ',', '') AS INTEGER)
 as ball_recoveries,
    
    TRY_CAST(REPLACE(aerial_duels_won, ',', '') AS INTEGER)
 as aerials_won,
    
    TRY_CAST(REPLACE(aerial_duels_lost, ',', '') AS INTEGER)
 as aerials_lost

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m04:54:46.036404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.039464 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m04:54:46.039865 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc__dbt_tmp" rename to "stg_fbref__misc"
[0m04:54:46.040568 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.041707 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m04:54:46.042112 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m04:54:46.042486 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m04:54:46.044916 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.047454 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m04:54:46.047824 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

      drop view if exists "players"."main"."stg_fbref__misc__dbt_backup" cascade
    
[0m04:54:46.048467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.049711 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: Close
[0m04:54:46.050299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d6788ca0>]}
[0m04:54:46.050914 [info ] [Thread-1 (]: 3 of 9 OK created sql view model main.stg_fbref__misc .......................... [[32mOK[0m in 0.03s]
[0m04:54:46.051596 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__misc
[0m04:54:46.051997 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__passing
[0m04:54:46.052563 [info ] [Thread-1 (]: 4 of 9 START sql view model main.stg_fbref__passing ............................ [RUN]
[0m04:54:46.053075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__misc, now model.nextgeneu_players.stg_fbref__passing)
[0m04:54:46.053476 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__passing
[0m04:54:46.059940 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__passing"
[0m04:54:46.060545 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__passing
[0m04:54:46.064904 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__passing"
[0m04:54:46.065526 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m04:54:46.065877 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: BEGIN
[0m04:54:46.066232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:46.066876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.067252 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m04:54:46.067631 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

  
  create view "players"."main"."stg_fbref__passing__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."passing_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."passing_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."passing_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(total_cmp, ',', '') AS INTEGER)
 as passes_completed,
    
    TRY_CAST(REPLACE(total_att, ',', '') AS INTEGER)
 as passes_attempted,
    
    TRY_CAST(REPLACE(total_prgdist, ',', '') AS INTEGER)
 as pass_progressive_distance,
    
    TRY_CAST(REPLACE(unnamed_27_level_0_kp, ',', '') AS INTEGER)
 as key_passes,
    
    TRY_CAST(REPLACE(unnamed_29_level_0_ppa, ',', '') AS INTEGER)
 as passes_into_penalty_area,
    
    TRY_CAST(REPLACE(unnamed_30_level_0_crspa, ',', '') AS INTEGER)
 as crosses_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m04:54:46.069870 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.073126 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m04:54:46.073497 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing__dbt_tmp" rename to "stg_fbref__passing"
[0m04:54:46.074190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.075345 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m04:54:46.075777 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m04:54:46.076217 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m04:54:46.079040 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.081669 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m04:54:46.082077 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

      drop view if exists "players"."main"."stg_fbref__passing__dbt_backup" cascade
    
[0m04:54:46.082715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.083985 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: Close
[0m04:54:46.084615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314db6182b0>]}
[0m04:54:46.085276 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main.stg_fbref__passing ....................... [[32mOK[0m in 0.03s]
[0m04:54:46.086014 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__passing
[0m04:54:46.086459 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__playing_time
[0m04:54:46.087015 [info ] [Thread-1 (]: 5 of 9 START sql view model main.stg_fbref__playing_time ....................... [RUN]
[0m04:54:46.087547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__passing, now model.nextgeneu_players.stg_fbref__playing_time)
[0m04:54:46.087928 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__playing_time
[0m04:54:46.093653 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m04:54:46.094239 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__playing_time
[0m04:54:46.097664 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m04:54:46.098254 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m04:54:46.098640 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: BEGIN
[0m04:54:46.099005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:46.099693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.100100 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m04:54:46.100528 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

  
  create view "players"."main"."stg_fbref__playing_time__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."playing_time_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."playing_time_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."playing_time_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_1_level_0_player as player_name,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
    
    TRY_CAST(REPLACE(starts_starts, ',', '') AS INTEGER)
 as starts,
    
    TRY_CAST(REPLACE(subs_subs, ',', '') AS INTEGER)
 as substitutions_on,
    
    TRY_CAST(REPLACE(subs_unsub, ',', '') AS INTEGER)
 as unused_sub,
    
    -- Team Success (Plus/Minus)
    TRY_CAST(team_success_onoff AS FLOAT) as plus_minus_net_per_90

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m04:54:46.102180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.106349 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m04:54:46.106728 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time__dbt_tmp" rename to "stg_fbref__playing_time"
[0m04:54:46.107402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.108523 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m04:54:46.108884 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m04:54:46.109236 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m04:54:46.112123 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m04:54:46.114601 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m04:54:46.115013 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

      drop view if exists "players"."main"."stg_fbref__playing_time__dbt_backup" cascade
    
[0m04:54:46.115674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.116908 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: Close
[0m04:54:46.117514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314db6182b0>]}
[0m04:54:46.118161 [info ] [Thread-1 (]: 5 of 9 OK created sql view model main.stg_fbref__playing_time .................. [[32mOK[0m in 0.03s]
[0m04:54:46.118872 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__playing_time
[0m04:54:46.119349 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__possession
[0m04:54:46.119899 [info ] [Thread-1 (]: 6 of 9 START sql view model main.stg_fbref__possession ......................... [RUN]
[0m04:54:46.120511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__playing_time, now model.nextgeneu_players.stg_fbref__possession)
[0m04:54:46.120863 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__possession
[0m04:54:46.128012 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__possession"
[0m04:54:46.128601 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__possession
[0m04:54:46.132720 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__possession"
[0m04:54:46.133327 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m04:54:46.133720 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: BEGIN
[0m04:54:46.134103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:46.134831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.135235 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m04:54:46.135719 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

  
  create view "players"."main"."stg_fbref__possession__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."possession_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."possession_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."possession_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(touches_touches, ',', '') AS INTEGER)
 as touches,
    
    TRY_CAST(REPLACE(touches_att_pen, ',', '') AS INTEGER)
 as touches_att_pen,
    
    TRY_CAST(REPLACE(takeons_succ, ',', '') AS INTEGER)
 as takeons_won,
    
    TRY_CAST(REPLACE(takeons_att, ',', '') AS INTEGER)
 as takeons_attempted,
    
    TRY_CAST(REPLACE(carries_prgdist, ',', '') AS INTEGER)
 as carry_progressive_distance,
    
    TRY_CAST(REPLACE(carries_cpa, ',', '') AS INTEGER)
 as carries_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m04:54:46.137362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.140831 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m04:54:46.141260 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession__dbt_tmp" rename to "stg_fbref__possession"
[0m04:54:46.141970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.143187 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m04:54:46.143574 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m04:54:46.143932 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m04:54:46.146391 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.149201 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m04:54:46.149610 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

      drop view if exists "players"."main"."stg_fbref__possession__dbt_backup" cascade
    
[0m04:54:46.150322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.151656 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: Close
[0m04:54:46.152266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d03cd2a0>]}
[0m04:54:46.152893 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main.stg_fbref__possession .................... [[32mOK[0m in 0.03s]
[0m04:54:46.153605 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__possession
[0m04:54:46.154019 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__shooting
[0m04:54:46.154583 [info ] [Thread-1 (]: 7 of 9 START sql view model main.stg_fbref__shooting ........................... [RUN]
[0m04:54:46.155116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__possession, now model.nextgeneu_players.stg_fbref__shooting)
[0m04:54:46.155499 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__shooting
[0m04:54:46.161887 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__shooting"
[0m04:54:46.162468 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__shooting
[0m04:54:46.165744 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__shooting"
[0m04:54:46.166320 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m04:54:46.166706 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: BEGIN
[0m04:54:46.167068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:46.167748 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.168223 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m04:54:46.168642 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

  
  create view "players"."main"."stg_fbref__shooting__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."shooting_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."shooting_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."shooting_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(standard_sh, ',', '') AS INTEGER)
 as shots_total,
    
    TRY_CAST(REPLACE(standard_sot, ',', '') AS INTEGER)
 as shots_on_target,
    TRY_CAST(standard_dist AS FLOAT) as avg_shot_distance

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m04:54:46.170072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.173031 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m04:54:46.173461 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting__dbt_tmp" rename to "stg_fbref__shooting"
[0m04:54:46.174194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.175349 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m04:54:46.175742 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m04:54:46.176126 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m04:54:46.178690 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.181951 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m04:54:46.182452 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

      drop view if exists "players"."main"."stg_fbref__shooting__dbt_backup" cascade
    
[0m04:54:46.183062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.184296 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: Close
[0m04:54:46.184853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314db6182b0>]}
[0m04:54:46.185520 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main.stg_fbref__shooting ...................... [[32mOK[0m in 0.03s]
[0m04:54:46.186237 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__shooting
[0m04:54:46.186628 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__standard
[0m04:54:46.187171 [info ] [Thread-1 (]: 8 of 9 START sql view model main.stg_fbref__standard ........................... [RUN]
[0m04:54:46.187700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__shooting, now model.nextgeneu_players.stg_fbref__standard)
[0m04:54:46.188055 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__standard
[0m04:54:46.196292 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__standard"
[0m04:54:46.196870 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__standard
[0m04:54:46.201294 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__standard"
[0m04:54:46.201867 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:54:46.202239 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: BEGIN
[0m04:54:46.202561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:46.203276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.203630 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:54:46.204053 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

  
  create view "players"."main"."stg_fbref__standard__dbt_tmp" as (
    -- 1. CONFIGURATION


WITH raw_union AS (
    
        SELECT 
            *, 
            '2023_2024' as source_season_id 
        FROM "players"."raw"."standard_stats_2023_2024"
         UNION ALL 
    
        SELECT 
            *, 
            '2024_2025' as source_season_id 
        FROM "players"."raw"."standard_stats_2024_2025"
         UNION ALL 
    
        SELECT 
            *, 
            '2025_2026' as source_season_id 
        FROM "players"."raw"."standard_stats_2025_2026"
        
    
),

cleaned AS (
    SELECT
        -- 1. IDENTITY (The Golden Key)
        
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
        
        -- 2. METADATA
        unnamed_1_level_0_player as player_name,
        unnamed_2_level_0_nation as nation,
        unnamed_4_level_0_squad  as squad,
        unnamed_3_level_0_pos    as primary_position,
        unnamed_5_level_0_comp   as competition,
        source_season_id         as season_id,
        
        -- 3. DEMOGRAPHICS
        
    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)
 as age,
        
    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)
 as birth_year,

        -- 4. PLAYING TIME
        
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
        
    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)
 as matches_started,
        
    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)
 as minutes_played,
        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,

        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)
        
    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)
 as goals,
        
    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)
 as assists,
        
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_assists,
        
    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)
 as penalties_made,
        
    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)
 as penalties_att,
        
        -- 6. EXPECTED METRICS
        TRY_CAST(expected_xg AS FLOAT) as xg,
        TRY_CAST(expected_npxg AS FLOAT) as npxg,
        TRY_CAST(expected_xag AS FLOAT) as xag,
        
        -- 7. PROGRESSION
        
    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)
 as progressive_carries,
        
    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)
 as progressive_passes,
        
    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)
 as progressive_receptions

    FROM raw_union
)

SELECT * FROM cleaned
WHERE player_name != 'Player' -- Filter header rows
  AND player_name IS NOT NULL
  );

[0m04:54:46.206997 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.268937 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:54:46.269704 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard" rename to "stg_fbref__standard__dbt_backup"
[0m04:54:46.271100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.274607 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:54:46.275017 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard__dbt_tmp" rename to "stg_fbref__standard"
[0m04:54:46.275769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.278989 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m04:54:46.279414 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:54:46.279790 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m04:54:46.282730 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m04:54:46.285732 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m04:54:46.286252 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

      drop view if exists "players"."main"."stg_fbref__standard__dbt_backup" cascade
    
[0m04:54:46.288270 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.289722 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: Close
[0m04:54:46.290462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d0249cc0>]}
[0m04:54:46.291233 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main.stg_fbref__standard ...................... [[32mOK[0m in 0.10s]
[0m04:54:46.291986 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__standard
[0m04:54:46.292948 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_player_season_stats
[0m04:54:46.293568 [info ] [Thread-1 (]: 9 of 9 START sql view model main.int_player_season_stats ....................... [RUN]
[0m04:54:46.294175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__standard, now model.nextgeneu_players.int_player_season_stats)
[0m04:54:46.294726 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_player_season_stats
[0m04:54:46.301238 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_player_season_stats"
[0m04:54:46.302118 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_player_season_stats
[0m04:54:46.306396 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_player_season_stats"
[0m04:54:46.307142 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m04:54:46.307537 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: BEGIN
[0m04:54:46.307965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:46.308846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:54:46.309264 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m04:54:46.309729 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

  
  create view "players"."main"."int_player_season_stats__dbt_tmp" as (
    WITH standard AS (SELECT * FROM "players"."main"."stg_fbref__standard"),
     shooting AS (SELECT * FROM "players"."main"."stg_fbref__shooting"),
     passing  AS (SELECT * FROM "players"."main"."stg_fbref__passing"),
     defense  AS (SELECT * FROM "players"."main"."stg_fbref__defense"),
     poss     AS (SELECT * FROM "players"."main"."stg_fbref__possession"),
     misc     AS (SELECT * FROM "players"."main"."stg_fbref__misc")

SELECT
    -- Anchors
    s.player_id,
    s.player_name,
    s.season_id,
    s.squad,
    s.nation,
    s.primary_position,
    s.age,
    s.birth_year,
    s.minutes_90s,

    -- Attacking Metrics
    s.goals,
    s.assists,
    s.npxg,
    s.xag,
    coalesce(sh.shots_total, 0) as shots_total,
    coalesce(sh.shots_on_target, 0) as shots_on_target,

    -- Possession & Creation
    coalesce(p.key_passes, 0) as key_passes,
    coalesce(p.pass_progressive_distance, 0) as pass_progressive_distance,
    coalesce(poss.carry_progressive_distance, 0) as carry_progressive_distance,
    coalesce(poss.takeons_won, 0) as takeons_won,

    -- Defensive Workrate
    coalesce(d.tackles_won, 0) as tackles_won,
    coalesce(d.interceptions, 0) as interceptions,
    coalesce(d.tackles_att_3rd, 0) as tackles_att_3rd,
    coalesce(m.ball_recoveries, 0) as recoveries,
    coalesce(m.aerials_won, 0) as aerials_won

FROM standard s
LEFT JOIN shooting sh USING (player_id, squad, season_id)
LEFT JOIN passing p   USING (player_id, squad, season_id)
LEFT JOIN defense d   USING (player_id, squad, season_id)
LEFT JOIN poss        USING (player_id, squad, season_id)
LEFT JOIN misc m      USING (player_id, squad, season_id)

-- Filter out rows where the join keys might have drifted or empty names
WHERE s.player_id IS NOT NULL
  );

[0m04:54:46.316977 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m04:54:46.321989 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m04:54:46.322433 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats__dbt_tmp" rename to "int_player_season_stats"
[0m04:54:46.323227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.324447 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m04:54:46.324857 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m04:54:46.325246 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m04:54:46.327946 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:54:46.331746 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m04:54:46.332253 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

      drop view if exists "players"."main"."int_player_season_stats__dbt_backup" cascade
    
[0m04:54:46.333031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:54:46.334449 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: Close
[0m04:54:46.335115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b00efeb-c9ed-4742-ac6d-b0c72e21feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d416ed10>]}
[0m04:54:46.335791 [info ] [Thread-1 (]: 9 of 9 OK created sql view model main.int_player_season_stats .................. [[32mOK[0m in 0.04s]
[0m04:54:46.336513 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_player_season_stats
[0m04:54:46.337643 [debug] [MainThread]: Using duckdb connection "master"
[0m04:54:46.337968 [debug] [MainThread]: On master: BEGIN
[0m04:54:46.338289 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:54:46.338890 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m04:54:46.339249 [debug] [MainThread]: On master: COMMIT
[0m04:54:46.339565 [debug] [MainThread]: Using duckdb connection "master"
[0m04:54:46.339865 [debug] [MainThread]: On master: COMMIT
[0m04:54:46.340418 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:54:46.340790 [debug] [MainThread]: On master: Close
[0m04:54:46.341293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:54:46.341633 [debug] [MainThread]: Connection 'model.nextgeneu_players.int_player_season_stats' was properly closed.
[0m04:54:46.342160 [info ] [MainThread]: 
[0m04:54:46.342569 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m04:54:46.344772 [debug] [MainThread]: Command end result
[0m04:54:46.390851 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m04:54:46.393388 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m04:54:46.400717 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/transformation/target/run_results.json
[0m04:54:46.401070 [info ] [MainThread]: 
[0m04:54:46.401596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:54:46.402019 [info ] [MainThread]: 
[0m04:54:46.402460 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m04:54:46.403551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7980171, "process_in_blocks": "240", "process_kernel_time": 0.226198, "process_mem_max_rss": "175708", "process_out_blocks": "4648", "process_user_time": 3.317909}
[0m04:54:46.404133 [debug] [MainThread]: Command `dbt run` succeeded at 04:54:46.403986 after 1.80 seconds
[0m04:54:46.404587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314db324700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314da3b3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314d3997340>]}
[0m04:54:46.405128 [debug] [MainThread]: Flushing usage events
[0m04:54:46.914530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:59:12.061923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adf3844730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adf271c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adf271c430>]}


============================== 04:59:12.067136 | 304fb971-a6bf-47d9-b65f-c9593650e10f ==============================
[0m04:59:12.067136 [info ] [MainThread]: Running with dbt=1.10.15
[0m04:59:12.067843 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'log_path': '/app/transformation/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'empty': 'False', 'version_check': 'True', 'warn_error': 'None', 'invocation_command': 'dbt build --select marts', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/transformation', 'static_parser': 'True', 'no_print': 'None'}
[0m04:59:12.322345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '304fb971-a6bf-47d9-b65f-c9593650e10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adf262fb80>]}
[0m04:59:12.393168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '304fb971-a6bf-47d9-b65f-c9593650e10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adf27ecd90>]}
[0m04:59:12.395116 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m04:59:12.490167 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m04:59:12.618316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m04:59:12.619040 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/marts/scouting/mart_scouting_analysis.sql
[0m04:59:12.619461 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/marts/dim_players.sql
[0m04:59:12.974904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304fb971-a6bf-47d9-b65f-c9593650e10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adec190130>]}
[0m04:59:13.082780 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m04:59:13.084790 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m04:59:13.112972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '304fb971-a6bf-47d9-b65f-c9593650e10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adec1d2110>]}
[0m04:59:13.113569 [info ] [MainThread]: Found 11 models, 33 sources, 586 macros
[0m04:59:13.115462 [info ] [MainThread]: 
[0m04:59:13.115897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:13.116327 [info ] [MainThread]: 
[0m04:59:13.116999 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:59:13.123632 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m04:59:13.164262 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m04:59:13.164902 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m04:59:13.165349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:13.198052 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m04:59:13.199690 [debug] [ThreadPool]: On list_players: Close
[0m04:59:13.200540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m04:59:13.201048 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m04:59:13.208853 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:59:13.209257 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m04:59:13.209564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:59:13.210940 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:59:13.212201 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:59:13.212520 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m04:59:13.213050 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:59:13.213397 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:59:13.213703 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m04:59:13.214333 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:59:13.215126 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m04:59:13.215451 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m04:59:13.215745 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m04:59:13.216265 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:59:13.216592 [debug] [ThreadPool]: On create_players_main: Close
[0m04:59:13.218360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m04:59:13.224316 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m04:59:13.224658 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m04:59:13.224951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:59:13.225619 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:59:13.225936 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m04:59:13.226281 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m04:59:13.238379 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m04:59:13.239864 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m04:59:13.240442 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m04:59:13.240755 [debug] [ThreadPool]: On list_players_main: Close
[0m04:59:13.242846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304fb971-a6bf-47d9-b65f-c9593650e10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adec65dff0>]}
[0m04:59:13.243351 [debug] [MainThread]: Using duckdb connection "master"
[0m04:59:13.243681 [debug] [MainThread]: On master: BEGIN
[0m04:59:13.243985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:13.244734 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m04:59:13.245069 [debug] [MainThread]: On master: COMMIT
[0m04:59:13.245433 [debug] [MainThread]: Using duckdb connection "master"
[0m04:59:13.245748 [debug] [MainThread]: On master: COMMIT
[0m04:59:13.246283 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:59:13.246622 [debug] [MainThread]: On master: Close
[0m04:59:13.250646 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.dim_players
[0m04:59:13.251210 [info ] [Thread-1 (]: 1 of 2 START sql table model main.dim_players .................................. [RUN]
[0m04:59:13.251766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.dim_players)
[0m04:59:13.252213 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.dim_players
[0m04:59:13.260806 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.dim_players"
[0m04:59:13.261493 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.dim_players
[0m04:59:13.294455 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.dim_players"
[0m04:59:13.295344 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m04:59:13.295746 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: BEGIN
[0m04:59:13.296142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:59:13.297255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:59:13.297674 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m04:59:13.298077 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

  
    
    

    create  table
      "players"."main"."dim_players__dbt_tmp"
  
    as (
      WITH unique_players AS (
    SELECT 
        player_id,
        -- Get the most recently used name (in case it changed)
        arg_max(player_name, season_id) as player_name,
        -- Get the most recent nation/position
        arg_max(nation, season_id) as nation,
        arg_max(primary_position, season_id) as primary_position,
        max(birth_year) as birth_year
    FROM "players"."main"."int_player_season_stats"
    GROUP BY player_id
)

SELECT * FROM unique_players
    );
  
  
[0m04:59:13.333125 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m04:59:13.340212 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m04:59:13.340650 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players__dbt_tmp" rename to "dim_players"
[0m04:59:13.341496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:59:13.356040 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m04:59:13.356544 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m04:59:13.356941 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m04:59:13.379833 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m04:59:13.386420 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m04:59:13.386861 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

      drop table if exists "players"."main"."dim_players__dbt_backup" cascade
    
[0m04:59:13.387677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:59:13.391262 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: Close
[0m04:59:13.392984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304fb971-a6bf-47d9-b65f-c9593650e10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adf5550250>]}
[0m04:59:13.393672 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.dim_players ............................. [[32mOK[0m in 0.14s]
[0m04:59:13.394360 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.dim_players
[0m04:59:13.394788 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_scouting_analysis
[0m04:59:13.395361 [info ] [Thread-1 (]: 2 of 2 START sql table model main.mart_scouting_analysis ....................... [RUN]
[0m04:59:13.395882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.dim_players, now model.nextgeneu_players.mart_scouting_analysis)
[0m04:59:13.396284 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_scouting_analysis
[0m04:59:13.400995 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_scouting_analysis"
[0m04:59:13.401831 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_scouting_analysis
[0m04:59:13.407359 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_scouting_analysis"
[0m04:59:13.408247 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m04:59:13.408667 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: BEGIN
[0m04:59:13.409057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:59:13.409969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:59:13.410431 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m04:59:13.410884 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_scouting_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_player_season_stats"
    WHERE minutes_90s >= 5.0 -- Filter: Remove noise (players with < 5 games)
),

per_90_calculations AS (
    SELECT 
        *,
        -- 1. ATTACK SCORES
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE goals + assists / minutes_90s
    END
 as goal_contribution_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE npxg + xag / minutes_90s
    END
 as expected_contribution_per_90,
        
        -- 2. PROGRESSION SCORES (The "Engine" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE pass_progressive_distance + carry_progressive_distance / minutes_90s
    END
 as progression_total_dist_per_90,
        
        -- 3. DEFENSIVE SCORES (The "Workrate" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE tackles_won + interceptions + recoveries / minutes_90s
    END
 as defensive_actions_per_90,
        
        -- 4. FLAGS
        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect
    FROM base_stats
)

SELECT 
    *,
    -- Percentile Ranks (0.0 to 1.0)
    -- Compare players only against peers in the SAME position and SAME season
    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY expected_contribution_per_90 ASC
    ) as percentile_attacking,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY progression_total_dist_per_90 ASC
    ) as percentile_progression,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY defensive_actions_per_90 ASC
    ) as percentile_defense

FROM per_90_calculations
    );
  
  
[0m04:59:13.457762 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m04:59:13.461707 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m04:59:13.462171 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis__dbt_tmp" rename to "mart_scouting_analysis"
[0m04:59:13.463117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:59:13.464455 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m04:59:13.464855 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m04:59:13.465244 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m04:59:13.483271 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m04:59:13.486605 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m04:59:13.487041 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

      drop table if exists "players"."main"."mart_scouting_analysis__dbt_backup" cascade
    
[0m04:59:13.487958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:59:13.489439 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: Close
[0m04:59:13.490177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304fb971-a6bf-47d9-b65f-c9593650e10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adec6f0340>]}
[0m04:59:13.490892 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.mart_scouting_analysis .................. [[32mOK[0m in 0.09s]
[0m04:59:13.491582 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_scouting_analysis
[0m04:59:13.493250 [debug] [MainThread]: Using duckdb connection "master"
[0m04:59:13.493595 [debug] [MainThread]: On master: BEGIN
[0m04:59:13.493908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:13.494585 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m04:59:13.494922 [debug] [MainThread]: On master: COMMIT
[0m04:59:13.495279 [debug] [MainThread]: Using duckdb connection "master"
[0m04:59:13.495589 [debug] [MainThread]: On master: COMMIT
[0m04:59:13.496143 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:59:13.496483 [debug] [MainThread]: On master: Close
[0m04:59:13.496964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:13.497314 [debug] [MainThread]: Connection 'model.nextgeneu_players.mart_scouting_analysis' was properly closed.
[0m04:59:13.497688 [info ] [MainThread]: 
[0m04:59:13.498175 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m04:59:13.499338 [debug] [MainThread]: Command end result
[0m04:59:13.538170 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m04:59:13.540246 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m04:59:13.547225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/transformation/target/run_results.json
[0m04:59:13.547548 [info ] [MainThread]: 
[0m04:59:13.548026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:13.548450 [info ] [MainThread]: 
[0m04:59:13.548911 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m04:59:13.550029 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5498374, "process_in_blocks": "4112", "process_kernel_time": 0.25489, "process_mem_max_rss": "357428", "process_out_blocks": "6752", "process_user_time": 3.205194}
[0m04:59:13.550579 [debug] [MainThread]: Command `dbt build` succeeded at 04:59:13.550469 after 1.55 seconds
[0m04:59:13.550963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adf3844730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ade67dbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71adf262dea0>]}
[0m04:59:13.551396 [debug] [MainThread]: Flushing usage events
[0m04:59:13.967128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:05:23.763378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546dabf8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546daa9f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d9abeb30>]}


============================== 05:05:23.768532 | 7f790f71-a1c4-4d61-b51d-08843c30139b ==============================
[0m05:05:23.768532 [info ] [MainThread]: Running with dbt=1.10.15
[0m05:05:23.769124 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'invocation_command': 'dbt build', 'empty': 'False', 'log_format': 'default', 'debug': 'False', 'target_path': 'None', 'log_path': '/app/transformation/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/app/transformation', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m05:05:24.024638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546daa9e650>]}
[0m05:05:24.114737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546da36a980>]}
[0m05:05:24.116743 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:05:24.217278 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m05:05:24.357065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:05:24.357799 [debug] [MainThread]: Partial parsing: updated file: nextgeneu_players://models/intermediate/int_player_season_stats.sql
[0m05:05:24.700811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d2948130>]}
[0m05:05:24.800681 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m05:05:24.802535 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m05:05:24.831832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d29a46d0>]}
[0m05:05:24.832407 [info ] [MainThread]: Found 11 models, 33 sources, 586 macros
[0m05:05:24.835527 [info ] [MainThread]: 
[0m05:05:24.835974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:05:24.836432 [info ] [MainThread]: 
[0m05:05:24.837129 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:05:24.844284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m05:05:24.884075 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m05:05:24.884576 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m05:05:24.884906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:24.914735 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m05:05:24.916333 [debug] [ThreadPool]: On list_players: Close
[0m05:05:24.917076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m05:05:24.917625 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m05:05:24.926694 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m05:05:24.927106 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m05:05:24.927447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:05:24.928541 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:05:24.929782 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m05:05:24.930135 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m05:05:24.930663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:05:24.930994 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m05:05:24.931351 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m05:05:24.931917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:05:24.932734 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m05:05:24.933065 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m05:05:24.933406 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m05:05:24.933938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:05:24.934291 [debug] [ThreadPool]: On create_players_main: Close
[0m05:05:24.936065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m05:05:24.941957 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m05:05:24.942323 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m05:05:24.942623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:05:24.943250 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:05:24.943578 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m05:05:24.943903 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m05:05:24.957418 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m05:05:24.959029 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m05:05:24.959607 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m05:05:24.959920 [debug] [ThreadPool]: On list_players_main: Close
[0m05:05:24.962287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d32f9f90>]}
[0m05:05:24.962760 [debug] [MainThread]: Using duckdb connection "master"
[0m05:05:24.963078 [debug] [MainThread]: On master: BEGIN
[0m05:05:24.963415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:05:24.964046 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:05:24.964408 [debug] [MainThread]: On master: COMMIT
[0m05:05:24.964725 [debug] [MainThread]: Using duckdb connection "master"
[0m05:05:24.965026 [debug] [MainThread]: On master: COMMIT
[0m05:05:24.965634 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:05:24.966043 [debug] [MainThread]: On master: Close
[0m05:05:24.969723 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__creation
[0m05:05:24.970312 [info ] [Thread-1 (]: 1 of 11 START sql view model main.stg_fbref__creation .......................... [RUN]
[0m05:05:24.970858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.stg_fbref__creation)
[0m05:05:24.971309 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__creation
[0m05:05:24.984838 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__creation"
[0m05:05:24.985561 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__creation
[0m05:05:25.016644 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__creation"
[0m05:05:25.017762 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:05:25.018365 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: BEGIN
[0m05:05:25.018842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.020056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.020612 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:05:25.021218 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

  
  create view "players"."main"."stg_fbref__creation__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(sca_sca, ',', '') AS INTEGER)
 as shot_creating_actions,
    
    TRY_CAST(REPLACE(gca_gca, ',', '') AS INTEGER)
 as goal_creating_actions

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:05:25.023536 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.031707 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:05:25.032203 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation" rename to "stg_fbref__creation__dbt_backup"
[0m05:05:25.033188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.036536 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:05:25.036913 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation__dbt_tmp" rename to "stg_fbref__creation"
[0m05:05:25.037622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.051060 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m05:05:25.051610 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:05:25.051978 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m05:05:25.076266 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m05:05:25.084441 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:05:25.084935 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

      drop view if exists "players"."main"."stg_fbref__creation__dbt_backup" cascade
    
[0m05:05:25.087174 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.089873 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: Close
[0m05:05:25.091646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d1c50430>]}
[0m05:05:25.092326 [info ] [Thread-1 (]: 1 of 11 OK created sql view model main.stg_fbref__creation ..................... [[32mOK[0m in 0.12s]
[0m05:05:25.093014 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__creation
[0m05:05:25.093467 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__defense
[0m05:05:25.094077 [info ] [Thread-1 (]: 2 of 11 START sql view model main.stg_fbref__defense ........................... [RUN]
[0m05:05:25.094699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__creation, now model.nextgeneu_players.stg_fbref__defense)
[0m05:05:25.095149 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__defense
[0m05:05:25.101593 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__defense"
[0m05:05:25.102230 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__defense
[0m05:05:25.105974 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__defense"
[0m05:05:25.106625 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:05:25.107004 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: BEGIN
[0m05:05:25.107381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.108262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.108652 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:05:25.109052 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

  
  create view "players"."main"."stg_fbref__defense__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."defensive_actions_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."defensive_actions_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."defensive_actions_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(tackles_tkl, ',', '') AS INTEGER)
 as tackles_total,
    
    TRY_CAST(REPLACE(tackles_tklw, ',', '') AS INTEGER)
 as tackles_won,
    
    TRY_CAST(REPLACE(tackles_att_3rd, ',', '') AS INTEGER)
 as tackles_att_3rd,
    
    TRY_CAST(REPLACE(unnamed_21_level_0_int, ',', '') AS INTEGER)
 as interceptions,
    
    TRY_CAST(REPLACE(unnamed_23_level_0_clr, ',', '') AS INTEGER)
 as clearances,
    
    TRY_CAST(REPLACE(blocks_sh, ',', '') AS INTEGER)
 as shots_blocked

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:05:25.110660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.114459 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:05:25.114929 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense" rename to "stg_fbref__defense__dbt_backup"
[0m05:05:25.115678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.118782 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:05:25.119216 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense__dbt_tmp" rename to "stg_fbref__defense"
[0m05:05:25.119907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.121186 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m05:05:25.121580 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:05:25.121941 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m05:05:25.124531 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.127318 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:05:25.127714 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

      drop view if exists "players"."main"."stg_fbref__defense__dbt_backup" cascade
    
[0m05:05:25.129350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.130673 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: Close
[0m05:05:25.131305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546dacec580>]}
[0m05:05:25.131948 [info ] [Thread-1 (]: 2 of 11 OK created sql view model main.stg_fbref__defense ...................... [[32mOK[0m in 0.04s]
[0m05:05:25.132651 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__defense
[0m05:05:25.133061 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__misc
[0m05:05:25.133618 [info ] [Thread-1 (]: 3 of 11 START sql view model main.stg_fbref__misc .............................. [RUN]
[0m05:05:25.134155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__defense, now model.nextgeneu_players.stg_fbref__misc)
[0m05:05:25.134547 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__misc
[0m05:05:25.142785 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__misc"
[0m05:05:25.143514 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__misc
[0m05:05:25.147167 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__misc"
[0m05:05:25.147776 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:05:25.148171 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: BEGIN
[0m05:05:25.148535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.149324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.149702 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:05:25.150120 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

  
  create view "players"."main"."stg_fbref__misc__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."miscellaneous_stats_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."miscellaneous_stats_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."miscellaneous_stats_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_crdy, ',', '') AS INTEGER)
 as yellow_cards,
    
    TRY_CAST(REPLACE(performance_crdr, ',', '') AS INTEGER)
 as red_cards,
    
    TRY_CAST(REPLACE(performance_fls, ',', '') AS INTEGER)
 as fouls_committed,
    
    TRY_CAST(REPLACE(performance_fld, ',', '') AS INTEGER)
 as fouls_drawn,
    
    TRY_CAST(REPLACE(performance_off, ',', '') AS INTEGER)
 as offsides,
    
    TRY_CAST(REPLACE(performance_recov, ',', '') AS INTEGER)
 as ball_recoveries,
    
    TRY_CAST(REPLACE(aerial_duels_won, ',', '') AS INTEGER)
 as aerials_won,
    
    TRY_CAST(REPLACE(aerial_duels_lost, ',', '') AS INTEGER)
 as aerials_lost

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:05:25.151768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.155042 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:05:25.155450 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc" rename to "stg_fbref__misc__dbt_backup"
[0m05:05:25.156144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.159076 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:05:25.159479 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc__dbt_tmp" rename to "stg_fbref__misc"
[0m05:05:25.160145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.161353 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m05:05:25.161749 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:05:25.162112 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m05:05:25.164599 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.167211 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:05:25.167589 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

      drop view if exists "players"."main"."stg_fbref__misc__dbt_backup" cascade
    
[0m05:05:25.169071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.170322 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: Close
[0m05:05:25.170937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546dacec580>]}
[0m05:05:25.171576 [info ] [Thread-1 (]: 3 of 11 OK created sql view model main.stg_fbref__misc ......................... [[32mOK[0m in 0.04s]
[0m05:05:25.172305 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__misc
[0m05:05:25.172727 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__passing
[0m05:05:25.173284 [info ] [Thread-1 (]: 4 of 11 START sql view model main.stg_fbref__passing ........................... [RUN]
[0m05:05:25.173828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__misc, now model.nextgeneu_players.stg_fbref__passing)
[0m05:05:25.174200 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__passing
[0m05:05:25.182436 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__passing"
[0m05:05:25.182993 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__passing
[0m05:05:25.186350 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__passing"
[0m05:05:25.186904 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:05:25.187275 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: BEGIN
[0m05:05:25.187595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.188284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.188669 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:05:25.189055 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

  
  create view "players"."main"."stg_fbref__passing__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."passing_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."passing_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."passing_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(total_cmp, ',', '') AS INTEGER)
 as passes_completed,
    
    TRY_CAST(REPLACE(total_att, ',', '') AS INTEGER)
 as passes_attempted,
    
    TRY_CAST(REPLACE(total_prgdist, ',', '') AS INTEGER)
 as pass_progressive_distance,
    
    TRY_CAST(REPLACE(unnamed_27_level_0_kp, ',', '') AS INTEGER)
 as key_passes,
    
    TRY_CAST(REPLACE(unnamed_29_level_0_ppa, ',', '') AS INTEGER)
 as passes_into_penalty_area,
    
    TRY_CAST(REPLACE(unnamed_30_level_0_crspa, ',', '') AS INTEGER)
 as crosses_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:05:25.190704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.193777 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:05:25.194166 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing" rename to "stg_fbref__passing__dbt_backup"
[0m05:05:25.194819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.197723 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:05:25.198103 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing__dbt_tmp" rename to "stg_fbref__passing"
[0m05:05:25.198736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.199980 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m05:05:25.200357 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:05:25.200682 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m05:05:25.203230 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.205839 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:05:25.206240 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

      drop view if exists "players"."main"."stg_fbref__passing__dbt_backup" cascade
    
[0m05:05:25.208439 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.209690 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: Close
[0m05:05:25.210300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546dacec580>]}
[0m05:05:25.210915 [info ] [Thread-1 (]: 4 of 11 OK created sql view model main.stg_fbref__passing ...................... [[32mOK[0m in 0.04s]
[0m05:05:25.211653 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__passing
[0m05:05:25.212071 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__playing_time
[0m05:05:25.212664 [info ] [Thread-1 (]: 5 of 11 START sql view model main.stg_fbref__playing_time ...................... [RUN]
[0m05:05:25.213217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__passing, now model.nextgeneu_players.stg_fbref__playing_time)
[0m05:05:25.213628 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__playing_time
[0m05:05:25.220162 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:05:25.220768 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__playing_time
[0m05:05:25.281643 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:05:25.282471 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:05:25.282868 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: BEGIN
[0m05:05:25.283263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.284150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.284538 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:05:25.284946 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

  
  create view "players"."main"."stg_fbref__playing_time__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."playing_time_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."playing_time_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."playing_time_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_1_level_0_player as player_name,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
    
    TRY_CAST(REPLACE(starts_starts, ',', '') AS INTEGER)
 as starts,
    
    TRY_CAST(REPLACE(subs_subs, ',', '') AS INTEGER)
 as substitutions_on,
    
    TRY_CAST(REPLACE(subs_unsub, ',', '') AS INTEGER)
 as unused_sub,
    
    -- Team Success (Plus/Minus)
    TRY_CAST(team_success_onoff AS FLOAT) as plus_minus_net_per_90

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:05:25.286726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.290041 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:05:25.290464 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time" rename to "stg_fbref__playing_time__dbt_backup"
[0m05:05:25.291164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.294178 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:05:25.294577 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time__dbt_tmp" rename to "stg_fbref__playing_time"
[0m05:05:25.295255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.296517 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m05:05:25.296911 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:05:25.297295 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m05:05:25.299703 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.302328 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:05:25.302733 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

      drop view if exists "players"."main"."stg_fbref__playing_time__dbt_backup" cascade
    
[0m05:05:25.304316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.305578 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: Close
[0m05:05:25.306246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d04ec9a0>]}
[0m05:05:25.306931 [info ] [Thread-1 (]: 5 of 11 OK created sql view model main.stg_fbref__playing_time ................. [[32mOK[0m in 0.09s]
[0m05:05:25.307649 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__playing_time
[0m05:05:25.308076 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__possession
[0m05:05:25.308639 [info ] [Thread-1 (]: 6 of 11 START sql view model main.stg_fbref__possession ........................ [RUN]
[0m05:05:25.309161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__playing_time, now model.nextgeneu_players.stg_fbref__possession)
[0m05:05:25.309533 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__possession
[0m05:05:25.315470 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__possession"
[0m05:05:25.316193 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__possession
[0m05:05:25.321305 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__possession"
[0m05:05:25.321902 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:05:25.322300 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: BEGIN
[0m05:05:25.322668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.323346 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.323752 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:05:25.324185 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

  
  create view "players"."main"."stg_fbref__possession__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."possession_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."possession_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."possession_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(touches_touches, ',', '') AS INTEGER)
 as touches,
    
    TRY_CAST(REPLACE(touches_att_pen, ',', '') AS INTEGER)
 as touches_att_pen,
    
    TRY_CAST(REPLACE(takeons_succ, ',', '') AS INTEGER)
 as takeons_won,
    
    TRY_CAST(REPLACE(takeons_att, ',', '') AS INTEGER)
 as takeons_attempted,
    
    TRY_CAST(REPLACE(carries_prgdist, ',', '') AS INTEGER)
 as carry_progressive_distance,
    
    TRY_CAST(REPLACE(carries_cpa, ',', '') AS INTEGER)
 as carries_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:05:25.325762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.328996 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:05:25.329429 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession" rename to "stg_fbref__possession__dbt_backup"
[0m05:05:25.330210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.333271 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:05:25.333675 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession__dbt_tmp" rename to "stg_fbref__possession"
[0m05:05:25.334350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.335620 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m05:05:25.336009 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:05:25.336397 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m05:05:25.338971 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.341574 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:05:25.341979 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

      drop view if exists "players"."main"."stg_fbref__possession__dbt_backup" cascade
    
[0m05:05:25.344238 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.345496 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: Close
[0m05:05:25.346098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d32fbb80>]}
[0m05:05:25.346809 [info ] [Thread-1 (]: 6 of 11 OK created sql view model main.stg_fbref__possession ................... [[32mOK[0m in 0.04s]
[0m05:05:25.347549 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__possession
[0m05:05:25.348031 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__shooting
[0m05:05:25.348841 [info ] [Thread-1 (]: 7 of 11 START sql view model main.stg_fbref__shooting .......................... [RUN]
[0m05:05:25.349566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__possession, now model.nextgeneu_players.stg_fbref__shooting)
[0m05:05:25.350104 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__shooting
[0m05:05:25.355715 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__shooting"
[0m05:05:25.356306 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__shooting
[0m05:05:25.359807 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__shooting"
[0m05:05:25.360392 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:05:25.360759 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: BEGIN
[0m05:05:25.361111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.361790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.362202 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:05:25.362620 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

  
  create view "players"."main"."stg_fbref__shooting__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."shooting_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."shooting_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."shooting_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(standard_sh, ',', '') AS INTEGER)
 as shots_total,
    
    TRY_CAST(REPLACE(standard_sot, ',', '') AS INTEGER)
 as shots_on_target,
    TRY_CAST(standard_dist AS FLOAT) as avg_shot_distance

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:05:25.364053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.368281 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:05:25.368732 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting" rename to "stg_fbref__shooting__dbt_backup"
[0m05:05:25.369406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.372480 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:05:25.372855 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting__dbt_tmp" rename to "stg_fbref__shooting"
[0m05:05:25.373513 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.374748 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m05:05:25.375154 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:05:25.375503 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m05:05:25.377415 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.380006 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:05:25.380438 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

      drop view if exists "players"."main"."stg_fbref__shooting__dbt_backup" cascade
    
[0m05:05:25.382225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.383477 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: Close
[0m05:05:25.384049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d1bd3a30>]}
[0m05:05:25.384708 [info ] [Thread-1 (]: 7 of 11 OK created sql view model main.stg_fbref__shooting ..................... [[32mOK[0m in 0.03s]
[0m05:05:25.385442 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__shooting
[0m05:05:25.385883 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__standard
[0m05:05:25.386542 [info ] [Thread-1 (]: 8 of 11 START sql view model main.stg_fbref__standard .......................... [RUN]
[0m05:05:25.387207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__shooting, now model.nextgeneu_players.stg_fbref__standard)
[0m05:05:25.387768 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__standard
[0m05:05:25.397369 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__standard"
[0m05:05:25.397999 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__standard
[0m05:05:25.401784 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__standard"
[0m05:05:25.402390 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:05:25.402746 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: BEGIN
[0m05:05:25.403076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.403825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.404212 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:05:25.404648 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

  
  create view "players"."main"."stg_fbref__standard__dbt_tmp" as (
    -- 1. CONFIGURATION


WITH raw_union AS (
    
        SELECT 
            *, 
            '2023_2024' as source_season_id 
        FROM "players"."raw"."standard_stats_2023_2024"
         UNION ALL 
    
        SELECT 
            *, 
            '2024_2025' as source_season_id 
        FROM "players"."raw"."standard_stats_2024_2025"
         UNION ALL 
    
        SELECT 
            *, 
            '2025_2026' as source_season_id 
        FROM "players"."raw"."standard_stats_2025_2026"
        
    
),

cleaned AS (
    SELECT
        -- 1. IDENTITY (The Golden Key)
        
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
        
        -- 2. METADATA
        unnamed_1_level_0_player as player_name,
        unnamed_2_level_0_nation as nation,
        unnamed_4_level_0_squad  as squad,
        unnamed_3_level_0_pos    as primary_position,
        unnamed_5_level_0_comp   as competition,
        source_season_id         as season_id,
        
        -- 3. DEMOGRAPHICS
        
    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)
 as age,
        
    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)
 as birth_year,

        -- 4. PLAYING TIME
        
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
        
    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)
 as matches_started,
        
    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)
 as minutes_played,
        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,

        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)
        
    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)
 as goals,
        
    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)
 as assists,
        
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_assists,
        
    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)
 as penalties_made,
        
    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)
 as penalties_att,
        
        -- 6. EXPECTED METRICS
        TRY_CAST(expected_xg AS FLOAT) as xg,
        TRY_CAST(expected_npxg AS FLOAT) as npxg,
        TRY_CAST(expected_xag AS FLOAT) as xag,
        
        -- 7. PROGRESSION
        
    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)
 as progressive_carries,
        
    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)
 as progressive_passes,
        
    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)
 as progressive_receptions

    FROM raw_union
)

SELECT * FROM cleaned
WHERE player_name != 'Player' -- Filter header rows
  AND player_name IS NOT NULL
  );

[0m05:05:25.407124 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.411477 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:05:25.411851 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard" rename to "stg_fbref__standard__dbt_backup"
[0m05:05:25.412572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.415545 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:05:25.415916 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard__dbt_tmp" rename to "stg_fbref__standard"
[0m05:05:25.416606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.417821 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m05:05:25.418208 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:05:25.418546 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m05:05:25.421949 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:05:25.425399 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:05:25.425824 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

      drop view if exists "players"."main"."stg_fbref__standard__dbt_backup" cascade
    
[0m05:05:25.427727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.429054 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: Close
[0m05:05:25.429698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d1c69bd0>]}
[0m05:05:25.430371 [info ] [Thread-1 (]: 8 of 11 OK created sql view model main.stg_fbref__standard ..................... [[32mOK[0m in 0.04s]
[0m05:05:25.431119 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__standard
[0m05:05:25.431919 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_player_season_stats
[0m05:05:25.432530 [info ] [Thread-1 (]: 9 of 11 START sql view model main.int_player_season_stats ...................... [RUN]
[0m05:05:25.433076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__standard, now model.nextgeneu_players.int_player_season_stats)
[0m05:05:25.433491 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_player_season_stats
[0m05:05:25.437950 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_player_season_stats"
[0m05:05:25.438595 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_player_season_stats
[0m05:05:25.442380 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_player_season_stats"
[0m05:05:25.443019 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:05:25.443495 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: BEGIN
[0m05:05:25.443926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.444667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.445057 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:05:25.445530 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

  
  create view "players"."main"."int_player_season_stats__dbt_tmp" as (
    WITH standard AS (SELECT * FROM "players"."main"."stg_fbref__standard"),
     shooting AS (SELECT * FROM "players"."main"."stg_fbref__shooting"),
     passing  AS (SELECT * FROM "players"."main"."stg_fbref__passing"),
     defense  AS (SELECT * FROM "players"."main"."stg_fbref__defense"),
     poss     AS (SELECT * FROM "players"."main"."stg_fbref__possession"),
     misc     AS (SELECT * FROM "players"."main"."stg_fbref__misc")

SELECT
    -- Anchors
    s.player_id,
    s.player_name,
    s.season_id,
    s.squad,
    s.competition,
    s.nation,
    s.primary_position,
    s.age,
    s.birth_year,
    s.minutes_90s,

    -- Attacking Metrics
    s.goals,
    s.assists,
    s.npxg,
    s.xag,
    coalesce(sh.shots_total, 0) as shots_total,
    coalesce(sh.shots_on_target, 0) as shots_on_target,

    -- Possession & Creation
    coalesce(p.key_passes, 0) as key_passes,
    coalesce(p.pass_progressive_distance, 0) as pass_progressive_distance,
    coalesce(poss.carry_progressive_distance, 0) as carry_progressive_distance,
    coalesce(poss.takeons_won, 0) as takeons_won,

    -- Defensive Workrate
    coalesce(d.tackles_won, 0) as tackles_won,
    coalesce(d.interceptions, 0) as interceptions,
    coalesce(d.tackles_att_3rd, 0) as tackles_att_3rd,
    coalesce(m.ball_recoveries, 0) as recoveries,
    coalesce(m.aerials_won, 0) as aerials_won

FROM standard s
LEFT JOIN shooting sh USING (player_id, squad, season_id)
LEFT JOIN passing p   USING (player_id, squad, season_id)
LEFT JOIN defense d   USING (player_id, squad, season_id)
LEFT JOIN poss        USING (player_id, squad, season_id)
LEFT JOIN misc m      USING (player_id, squad, season_id)

-- Filter out rows where the join keys might have drifted or empty names
WHERE s.player_id IS NOT NULL
  );

[0m05:05:25.453066 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m05:05:25.456284 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:05:25.456691 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats" rename to "int_player_season_stats__dbt_backup"
[0m05:05:25.457407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.461555 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:05:25.461959 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats__dbt_tmp" rename to "int_player_season_stats"
[0m05:05:25.462658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.463882 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m05:05:25.464294 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:05:25.464667 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m05:05:25.467263 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.469944 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:05:25.470368 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

      drop view if exists "players"."main"."int_player_season_stats__dbt_backup" cascade
    
[0m05:05:25.472209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.473916 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: Close
[0m05:05:25.474548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d04e29e0>]}
[0m05:05:25.475176 [info ] [Thread-1 (]: 9 of 11 OK created sql view model main.int_player_season_stats ................. [[32mOK[0m in 0.04s]
[0m05:05:25.475845 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_player_season_stats
[0m05:05:25.476647 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.dim_players
[0m05:05:25.477146 [info ] [Thread-1 (]: 10 of 11 START sql table model main.dim_players ................................ [RUN]
[0m05:05:25.477653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.int_player_season_stats, now model.nextgeneu_players.dim_players)
[0m05:05:25.478026 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.dim_players
[0m05:05:25.480918 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.dim_players"
[0m05:05:25.481490 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.dim_players
[0m05:05:25.502068 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.dim_players"
[0m05:05:25.502733 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:05:25.503142 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: BEGIN
[0m05:05:25.503508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.504308 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.504689 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:05:25.505074 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

  
    
    

    create  table
      "players"."main"."dim_players__dbt_tmp"
  
    as (
      WITH unique_players AS (
    SELECT 
        player_id,
        -- Get the most recently used name (in case it changed)
        arg_max(player_name, season_id) as player_name,
        -- Get the most recent nation/position
        arg_max(nation, season_id) as nation,
        arg_max(primary_position, season_id) as primary_position,
        max(birth_year) as birth_year
    FROM "players"."main"."int_player_season_stats"
    GROUP BY player_id
)

SELECT * FROM unique_players
    );
  
  
[0m05:05:25.547899 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m05:05:25.554040 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:05:25.554520 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m05:05:25.555544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.556803 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:05:25.557208 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m05:05:25.558154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.561853 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:05:25.562280 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players" rename to "dim_players__dbt_backup"
[0m05:05:25.563039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.567647 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:05:25.568019 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players__dbt_tmp" rename to "dim_players"
[0m05:05:25.568684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.573239 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m05:05:25.573612 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:05:25.573944 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m05:05:25.580264 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m05:05:25.583118 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:05:25.583514 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

      drop table if exists "players"."main"."dim_players__dbt_backup" cascade
    
[0m05:05:25.585273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.586731 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: Close
[0m05:05:25.587380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d9b6c9d0>]}
[0m05:05:25.588100 [info ] [Thread-1 (]: 10 of 11 OK created sql table model main.dim_players ........................... [[32mOK[0m in 0.11s]
[0m05:05:25.588995 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.dim_players
[0m05:05:25.589468 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_scouting_analysis
[0m05:05:25.590022 [info ] [Thread-1 (]: 11 of 11 START sql table model main.mart_scouting_analysis ..................... [RUN]
[0m05:05:25.590547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.dim_players, now model.nextgeneu_players.mart_scouting_analysis)
[0m05:05:25.590930 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_scouting_analysis
[0m05:05:25.599923 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.600678 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_scouting_analysis
[0m05:05:25.605604 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.606741 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.607441 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: BEGIN
[0m05:05:25.607848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:25.608714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.609277 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.609738 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_scouting_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_player_season_stats"
    WHERE minutes_90s >= 5.0 -- Filter: Remove noise (players with < 5 games)
),

per_90_calculations AS (
    SELECT 
        *,
        -- 1. ATTACK SCORES
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE goals + assists / minutes_90s
    END
 as goal_contribution_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE npxg + xag / minutes_90s
    END
 as expected_contribution_per_90,
        
        -- 2. PROGRESSION SCORES (The "Engine" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE pass_progressive_distance + carry_progressive_distance / minutes_90s
    END
 as progression_total_dist_per_90,
        
        -- 3. DEFENSIVE SCORES (The "Workrate" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE tackles_won + interceptions + recoveries / minutes_90s
    END
 as defensive_actions_per_90,
        
        -- 4. FLAGS
        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect
    FROM base_stats
)

SELECT 
    *,
    -- Percentile Ranks (0.0 to 1.0)
    -- Compare players only against peers in the SAME position and SAME season
    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY expected_contribution_per_90 ASC
    ) as percentile_attacking,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY progression_total_dist_per_90 ASC
    ) as percentile_progression,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY defensive_actions_per_90 ASC
    ) as percentile_defense

FROM per_90_calculations
    );
  
  
[0m05:05:25.659735 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m05:05:25.661182 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.661643 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m05:05:25.662657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.663931 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.664364 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m05:05:25.665265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:05:25.668842 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.669259 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis" rename to "mart_scouting_analysis__dbt_backup"
[0m05:05:25.669951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.674269 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.674676 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis__dbt_tmp" rename to "mart_scouting_analysis"
[0m05:05:25.675430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:05:25.676838 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m05:05:25.677283 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.677679 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m05:05:25.695656 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m05:05:25.699676 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:05:25.700148 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

      drop table if exists "players"."main"."mart_scouting_analysis__dbt_backup" cascade
    
[0m05:05:25.702283 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:05:25.703871 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: Close
[0m05:05:25.704570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f790f71-a1c4-4d61-b51d-08843c30139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d04eada0>]}
[0m05:05:25.705386 [info ] [Thread-1 (]: 11 of 11 OK created sql table model main.mart_scouting_analysis ................ [[32mOK[0m in 0.11s]
[0m05:05:25.706404 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_scouting_analysis
[0m05:05:25.707726 [debug] [MainThread]: Using duckdb connection "master"
[0m05:05:25.708116 [debug] [MainThread]: On master: BEGIN
[0m05:05:25.708462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:05:25.709300 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:05:25.709672 [debug] [MainThread]: On master: COMMIT
[0m05:05:25.710037 [debug] [MainThread]: Using duckdb connection "master"
[0m05:05:25.710422 [debug] [MainThread]: On master: COMMIT
[0m05:05:25.711059 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:05:25.711478 [debug] [MainThread]: On master: Close
[0m05:05:25.711964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:05:25.712334 [debug] [MainThread]: Connection 'model.nextgeneu_players.mart_scouting_analysis' was properly closed.
[0m05:05:25.712872 [info ] [MainThread]: 
[0m05:05:25.713559 [info ] [MainThread]: Finished running 2 table models, 9 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m05:05:25.716942 [debug] [MainThread]: Command end result
[0m05:05:25.764567 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m05:05:25.767128 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m05:05:25.775281 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/transformation/target/run_results.json
[0m05:05:25.775610 [info ] [MainThread]: 
[0m05:05:25.776151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:05:25.776598 [info ] [MainThread]: 
[0m05:05:25.776993 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m05:05:25.778436 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.0765824, "process_in_blocks": "8408", "process_kernel_time": 0.296881, "process_mem_max_rss": "350544", "process_out_blocks": "7448", "process_user_time": 3.698527}
[0m05:05:25.778884 [debug] [MainThread]: Command `dbt build` succeeded at 05:05:25.778780 after 2.08 seconds
[0m05:05:25.779274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546dabf8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546d3267790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546daa9f490>]}
[0m05:05:25.779670 [debug] [MainThread]: Flushing usage events
[0m05:05:26.283140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:06:41.902742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364c4d86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364b39e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364b39f9d0>]}


============================== 05:06:41.907757 | 5332c602-6510-4640-8425-be13ca8f0a4d ==============================
[0m05:06:41.907757 [info ] [MainThread]: Running with dbt=1.10.15
[0m05:06:41.908407 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/app/transformation/logs', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/app/transformation', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt build'}
[0m05:06:42.155971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364e4763e0>]}
[0m05:06:42.226142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364b362bc0>]}
[0m05:06:42.228111 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:06:42.320368 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m05:06:42.446332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:06:42.447134 [debug] [MainThread]: Partial parsing: updated file: nextgeneu_players://models/intermediate/int_player_season_stats.sql
[0m05:06:42.787329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3644254130>]}
[0m05:06:42.890982 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m05:06:42.892848 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m05:06:42.920747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36442a8700>]}
[0m05:06:42.921268 [info ] [MainThread]: Found 11 models, 33 sources, 586 macros
[0m05:06:42.924448 [info ] [MainThread]: 
[0m05:06:42.924933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:06:42.925332 [info ] [MainThread]: 
[0m05:06:42.925944 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:06:42.932969 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m05:06:42.969471 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m05:06:42.969891 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m05:06:42.970238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:06:42.998995 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m05:06:43.000932 [debug] [ThreadPool]: On list_players: Close
[0m05:06:43.001823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m05:06:43.002321 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m05:06:43.009678 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m05:06:43.010013 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m05:06:43.010337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:06:43.011331 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:06:43.012697 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m05:06:43.013027 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m05:06:43.013559 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:06:43.013884 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m05:06:43.014303 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m05:06:43.015054 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:06:43.016045 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m05:06:43.016379 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m05:06:43.016660 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m05:06:43.017188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m05:06:43.017499 [debug] [ThreadPool]: On create_players_main: Close
[0m05:06:43.019245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m05:06:43.024990 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m05:06:43.025362 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m05:06:43.025665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:06:43.026327 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:06:43.026659 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m05:06:43.026993 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m05:06:43.040047 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m05:06:43.041466 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m05:06:43.042015 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m05:06:43.042375 [debug] [ThreadPool]: On list_players_main: Close
[0m05:06:43.044707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3644bfe2c0>]}
[0m05:06:43.045211 [debug] [MainThread]: Using duckdb connection "master"
[0m05:06:43.045538 [debug] [MainThread]: On master: BEGIN
[0m05:06:43.045839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:06:43.046459 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:06:43.046794 [debug] [MainThread]: On master: COMMIT
[0m05:06:43.047142 [debug] [MainThread]: Using duckdb connection "master"
[0m05:06:43.047454 [debug] [MainThread]: On master: COMMIT
[0m05:06:43.048003 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:06:43.048382 [debug] [MainThread]: On master: Close
[0m05:06:43.051573 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__creation
[0m05:06:43.052131 [info ] [Thread-1 (]: 1 of 11 START sql view model main.stg_fbref__creation .......................... [RUN]
[0m05:06:43.052674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.stg_fbref__creation)
[0m05:06:43.053135 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__creation
[0m05:06:43.067057 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__creation"
[0m05:06:43.067868 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__creation
[0m05:06:43.097878 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__creation"
[0m05:06:43.098639 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:06:43.099017 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: BEGIN
[0m05:06:43.099407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.100286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.100663 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:06:43.101051 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

  
  create view "players"."main"."stg_fbref__creation__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(sca_sca, ',', '') AS INTEGER)
 as shot_creating_actions,
    
    TRY_CAST(REPLACE(gca_gca, ',', '') AS INTEGER)
 as goal_creating_actions

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:06:43.102657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.109110 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:06:43.109506 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation" rename to "stg_fbref__creation__dbt_backup"
[0m05:06:43.110222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.113243 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:06:43.113630 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation__dbt_tmp" rename to "stg_fbref__creation"
[0m05:06:43.114311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.125730 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m05:06:43.126143 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:06:43.126502 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m05:06:43.143697 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m05:06:43.150711 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m05:06:43.151135 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

      drop view if exists "players"."main"."stg_fbref__creation__dbt_backup" cascade
    
[0m05:06:43.153054 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.155636 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: Close
[0m05:06:43.157375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363f45ca00>]}
[0m05:06:43.158030 [info ] [Thread-1 (]: 1 of 11 OK created sql view model main.stg_fbref__creation ..................... [[32mOK[0m in 0.10s]
[0m05:06:43.158743 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__creation
[0m05:06:43.159204 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__defense
[0m05:06:43.159758 [info ] [Thread-1 (]: 2 of 11 START sql view model main.stg_fbref__defense ........................... [RUN]
[0m05:06:43.160340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__creation, now model.nextgeneu_players.stg_fbref__defense)
[0m05:06:43.160774 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__defense
[0m05:06:43.167414 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__defense"
[0m05:06:43.168001 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__defense
[0m05:06:43.171528 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__defense"
[0m05:06:43.172146 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:06:43.172513 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: BEGIN
[0m05:06:43.172834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.173586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.173958 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:06:43.174355 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

  
  create view "players"."main"."stg_fbref__defense__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."defensive_actions_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."defensive_actions_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."defensive_actions_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(tackles_tkl, ',', '') AS INTEGER)
 as tackles_total,
    
    TRY_CAST(REPLACE(tackles_tklw, ',', '') AS INTEGER)
 as tackles_won,
    
    TRY_CAST(REPLACE(tackles_att_3rd, ',', '') AS INTEGER)
 as tackles_att_3rd,
    
    TRY_CAST(REPLACE(unnamed_21_level_0_int, ',', '') AS INTEGER)
 as interceptions,
    
    TRY_CAST(REPLACE(unnamed_23_level_0_clr, ',', '') AS INTEGER)
 as clearances,
    
    TRY_CAST(REPLACE(blocks_sh, ',', '') AS INTEGER)
 as shots_blocked

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:06:43.176003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.179200 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:06:43.179567 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense" rename to "stg_fbref__defense__dbt_backup"
[0m05:06:43.180231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.183203 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:06:43.183567 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense__dbt_tmp" rename to "stg_fbref__defense"
[0m05:06:43.184315 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.185526 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m05:06:43.185885 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:06:43.186249 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m05:06:43.188690 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.191836 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m05:06:43.192280 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

      drop view if exists "players"."main"."stg_fbref__defense__dbt_backup" cascade
    
[0m05:06:43.194149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.195402 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: Close
[0m05:06:43.196008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36453b6290>]}
[0m05:06:43.196667 [info ] [Thread-1 (]: 2 of 11 OK created sql view model main.stg_fbref__defense ...................... [[32mOK[0m in 0.04s]
[0m05:06:43.197322 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__defense
[0m05:06:43.197734 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__misc
[0m05:06:43.198278 [info ] [Thread-1 (]: 3 of 11 START sql view model main.stg_fbref__misc .............................. [RUN]
[0m05:06:43.198764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__defense, now model.nextgeneu_players.stg_fbref__misc)
[0m05:06:43.199160 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__misc
[0m05:06:43.206430 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__misc"
[0m05:06:43.207030 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__misc
[0m05:06:43.210410 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__misc"
[0m05:06:43.211030 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:06:43.211431 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: BEGIN
[0m05:06:43.211783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.212459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.212852 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:06:43.213284 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

  
  create view "players"."main"."stg_fbref__misc__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."miscellaneous_stats_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."miscellaneous_stats_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."miscellaneous_stats_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_crdy, ',', '') AS INTEGER)
 as yellow_cards,
    
    TRY_CAST(REPLACE(performance_crdr, ',', '') AS INTEGER)
 as red_cards,
    
    TRY_CAST(REPLACE(performance_fls, ',', '') AS INTEGER)
 as fouls_committed,
    
    TRY_CAST(REPLACE(performance_fld, ',', '') AS INTEGER)
 as fouls_drawn,
    
    TRY_CAST(REPLACE(performance_off, ',', '') AS INTEGER)
 as offsides,
    
    TRY_CAST(REPLACE(performance_recov, ',', '') AS INTEGER)
 as ball_recoveries,
    
    TRY_CAST(REPLACE(aerial_duels_won, ',', '') AS INTEGER)
 as aerials_won,
    
    TRY_CAST(REPLACE(aerial_duels_lost, ',', '') AS INTEGER)
 as aerials_lost

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:06:43.214904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.217995 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:06:43.218405 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc" rename to "stg_fbref__misc__dbt_backup"
[0m05:06:43.219108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.222014 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:06:43.222418 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc__dbt_tmp" rename to "stg_fbref__misc"
[0m05:06:43.223071 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.224299 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m05:06:43.224680 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:06:43.225033 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m05:06:43.227474 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.229955 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m05:06:43.230368 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

      drop view if exists "players"."main"."stg_fbref__misc__dbt_backup" cascade
    
[0m05:06:43.232170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.233433 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: Close
[0m05:06:43.234039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36453b6290>]}
[0m05:06:43.234701 [info ] [Thread-1 (]: 3 of 11 OK created sql view model main.stg_fbref__misc ......................... [[32mOK[0m in 0.04s]
[0m05:06:43.235430 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__misc
[0m05:06:43.235912 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__passing
[0m05:06:43.236594 [info ] [Thread-1 (]: 4 of 11 START sql view model main.stg_fbref__passing ........................... [RUN]
[0m05:06:43.237186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__misc, now model.nextgeneu_players.stg_fbref__passing)
[0m05:06:43.237651 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__passing
[0m05:06:43.244778 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__passing"
[0m05:06:43.245440 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__passing
[0m05:06:43.248926 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__passing"
[0m05:06:43.249577 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:06:43.249967 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: BEGIN
[0m05:06:43.250367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.251182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.251569 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:06:43.251983 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

  
  create view "players"."main"."stg_fbref__passing__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."passing_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."passing_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."passing_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(total_cmp, ',', '') AS INTEGER)
 as passes_completed,
    
    TRY_CAST(REPLACE(total_att, ',', '') AS INTEGER)
 as passes_attempted,
    
    TRY_CAST(REPLACE(total_prgdist, ',', '') AS INTEGER)
 as pass_progressive_distance,
    
    TRY_CAST(REPLACE(unnamed_27_level_0_kp, ',', '') AS INTEGER)
 as key_passes,
    
    TRY_CAST(REPLACE(unnamed_29_level_0_ppa, ',', '') AS INTEGER)
 as passes_into_penalty_area,
    
    TRY_CAST(REPLACE(unnamed_30_level_0_crspa, ',', '') AS INTEGER)
 as crosses_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:06:43.253775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.257007 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:06:43.257496 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing" rename to "stg_fbref__passing__dbt_backup"
[0m05:06:43.258259 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.261608 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:06:43.262024 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing__dbt_tmp" rename to "stg_fbref__passing"
[0m05:06:43.262790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.264073 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m05:06:43.264500 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:06:43.264869 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m05:06:43.267273 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.269889 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m05:06:43.270302 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

      drop view if exists "players"."main"."stg_fbref__passing__dbt_backup" cascade
    
[0m05:06:43.272595 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.273866 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: Close
[0m05:06:43.274492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363f45dcf0>]}
[0m05:06:43.275150 [info ] [Thread-1 (]: 4 of 11 OK created sql view model main.stg_fbref__passing ...................... [[32mOK[0m in 0.04s]
[0m05:06:43.275790 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__passing
[0m05:06:43.276231 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__playing_time
[0m05:06:43.276800 [info ] [Thread-1 (]: 5 of 11 START sql view model main.stg_fbref__playing_time ...................... [RUN]
[0m05:06:43.277316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__passing, now model.nextgeneu_players.stg_fbref__playing_time)
[0m05:06:43.277681 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__playing_time
[0m05:06:43.283412 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:06:43.284029 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__playing_time
[0m05:06:43.344913 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:06:43.345743 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:06:43.346134 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: BEGIN
[0m05:06:43.346478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.347320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.347686 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:06:43.348115 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

  
  create view "players"."main"."stg_fbref__playing_time__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."playing_time_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."playing_time_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."playing_time_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_1_level_0_player as player_name,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
    
    TRY_CAST(REPLACE(starts_starts, ',', '') AS INTEGER)
 as starts,
    
    TRY_CAST(REPLACE(subs_subs, ',', '') AS INTEGER)
 as substitutions_on,
    
    TRY_CAST(REPLACE(subs_unsub, ',', '') AS INTEGER)
 as unused_sub,
    
    -- Team Success (Plus/Minus)
    TRY_CAST(team_success_onoff AS FLOAT) as plus_minus_net_per_90

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:06:43.349831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.353199 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:06:43.353594 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time" rename to "stg_fbref__playing_time__dbt_backup"
[0m05:06:43.354282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.357263 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:06:43.357656 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time__dbt_tmp" rename to "stg_fbref__playing_time"
[0m05:06:43.358328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.359560 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m05:06:43.359952 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:06:43.360346 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m05:06:43.362794 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.365339 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m05:06:43.365707 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

      drop view if exists "players"."main"."stg_fbref__playing_time__dbt_backup" cascade
    
[0m05:06:43.367317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.369124 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: Close
[0m05:06:43.369728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364d7aa0e0>]}
[0m05:06:43.370438 [info ] [Thread-1 (]: 5 of 11 OK created sql view model main.stg_fbref__playing_time ................. [[32mOK[0m in 0.09s]
[0m05:06:43.371377 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__playing_time
[0m05:06:43.371986 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__possession
[0m05:06:43.372591 [info ] [Thread-1 (]: 6 of 11 START sql view model main.stg_fbref__possession ........................ [RUN]
[0m05:06:43.373118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__playing_time, now model.nextgeneu_players.stg_fbref__possession)
[0m05:06:43.373512 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__possession
[0m05:06:43.379677 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__possession"
[0m05:06:43.380320 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__possession
[0m05:06:43.385049 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__possession"
[0m05:06:43.385681 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:06:43.386095 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: BEGIN
[0m05:06:43.386469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.387243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.387642 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:06:43.388072 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

  
  create view "players"."main"."stg_fbref__possession__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."possession_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."possession_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."possession_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(touches_touches, ',', '') AS INTEGER)
 as touches,
    
    TRY_CAST(REPLACE(touches_att_pen, ',', '') AS INTEGER)
 as touches_att_pen,
    
    TRY_CAST(REPLACE(takeons_succ, ',', '') AS INTEGER)
 as takeons_won,
    
    TRY_CAST(REPLACE(takeons_att, ',', '') AS INTEGER)
 as takeons_attempted,
    
    TRY_CAST(REPLACE(carries_prgdist, ',', '') AS INTEGER)
 as carry_progressive_distance,
    
    TRY_CAST(REPLACE(carries_cpa, ',', '') AS INTEGER)
 as carries_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:06:43.389734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.392866 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:06:43.393289 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession" rename to "stg_fbref__possession__dbt_backup"
[0m05:06:43.393985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.396926 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:06:43.397348 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession__dbt_tmp" rename to "stg_fbref__possession"
[0m05:06:43.398013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.399269 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m05:06:43.399671 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:06:43.400044 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m05:06:43.402534 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.405059 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m05:06:43.405479 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

      drop view if exists "players"."main"."stg_fbref__possession__dbt_backup" cascade
    
[0m05:06:43.407325 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.408571 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: Close
[0m05:06:43.409197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36442a2110>]}
[0m05:06:43.409850 [info ] [Thread-1 (]: 6 of 11 OK created sql view model main.stg_fbref__possession ................... [[32mOK[0m in 0.04s]
[0m05:06:43.410615 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__possession
[0m05:06:43.411035 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__shooting
[0m05:06:43.411760 [info ] [Thread-1 (]: 7 of 11 START sql view model main.stg_fbref__shooting .......................... [RUN]
[0m05:06:43.412395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__possession, now model.nextgeneu_players.stg_fbref__shooting)
[0m05:06:43.412855 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__shooting
[0m05:06:43.418599 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__shooting"
[0m05:06:43.419234 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__shooting
[0m05:06:43.422699 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__shooting"
[0m05:06:43.423321 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:06:43.423711 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: BEGIN
[0m05:06:43.424063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.424780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.425174 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:06:43.425585 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

  
  create view "players"."main"."stg_fbref__shooting__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."shooting_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."shooting_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."shooting_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(standard_sh, ',', '') AS INTEGER)
 as shots_total,
    
    TRY_CAST(REPLACE(standard_sot, ',', '') AS INTEGER)
 as shots_on_target,
    TRY_CAST(standard_dist AS FLOAT) as avg_shot_distance

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m05:06:43.427026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.431339 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:06:43.431817 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting" rename to "stg_fbref__shooting__dbt_backup"
[0m05:06:43.432525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.435459 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:06:43.435856 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting__dbt_tmp" rename to "stg_fbref__shooting"
[0m05:06:43.436526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.437737 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m05:06:43.438147 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:06:43.438512 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m05:06:43.440862 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.443467 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m05:06:43.443850 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

      drop view if exists "players"."main"."stg_fbref__shooting__dbt_backup" cascade
    
[0m05:06:43.445715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.446983 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: Close
[0m05:06:43.447614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363f47d690>]}
[0m05:06:43.448261 [info ] [Thread-1 (]: 7 of 11 OK created sql view model main.stg_fbref__shooting ..................... [[32mOK[0m in 0.04s]
[0m05:06:43.448955 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__shooting
[0m05:06:43.449421 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__standard
[0m05:06:43.449988 [info ] [Thread-1 (]: 8 of 11 START sql view model main.stg_fbref__standard .......................... [RUN]
[0m05:06:43.450606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__shooting, now model.nextgeneu_players.stg_fbref__standard)
[0m05:06:43.451060 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__standard
[0m05:06:43.459498 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__standard"
[0m05:06:43.460096 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__standard
[0m05:06:43.463919 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__standard"
[0m05:06:43.464540 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:06:43.464996 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: BEGIN
[0m05:06:43.465417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.466227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.466631 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:06:43.467276 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

  
  create view "players"."main"."stg_fbref__standard__dbt_tmp" as (
    -- 1. CONFIGURATION


WITH raw_union AS (
    
        SELECT 
            *, 
            '2023_2024' as source_season_id 
        FROM "players"."raw"."standard_stats_2023_2024"
         UNION ALL 
    
        SELECT 
            *, 
            '2024_2025' as source_season_id 
        FROM "players"."raw"."standard_stats_2024_2025"
         UNION ALL 
    
        SELECT 
            *, 
            '2025_2026' as source_season_id 
        FROM "players"."raw"."standard_stats_2025_2026"
        
    
),

cleaned AS (
    SELECT
        -- 1. IDENTITY (The Golden Key)
        
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
        
        -- 2. METADATA
        unnamed_1_level_0_player as player_name,
        unnamed_2_level_0_nation as nation,
        unnamed_4_level_0_squad  as squad,
        unnamed_3_level_0_pos    as primary_position,
        unnamed_5_level_0_comp   as competition,
        source_season_id         as season_id,
        
        -- 3. DEMOGRAPHICS
        
    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)
 as age,
        
    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)
 as birth_year,

        -- 4. PLAYING TIME
        
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
        
    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)
 as matches_started,
        
    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)
 as minutes_played,
        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,

        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)
        
    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)
 as goals,
        
    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)
 as assists,
        
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_assists,
        
    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)
 as penalties_made,
        
    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)
 as penalties_att,
        
        -- 6. EXPECTED METRICS
        TRY_CAST(expected_xg AS FLOAT) as xg,
        TRY_CAST(expected_npxg AS FLOAT) as npxg,
        TRY_CAST(expected_xag AS FLOAT) as xag,
        
        -- 7. PROGRESSION
        
    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)
 as progressive_carries,
        
    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)
 as progressive_passes,
        
    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)
 as progressive_receptions

    FROM raw_union
)

SELECT * FROM cleaned
WHERE player_name != 'Player' -- Filter header rows
  AND player_name IS NOT NULL
  );

[0m05:06:43.470796 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:06:43.477357 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:06:43.477808 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard" rename to "stg_fbref__standard__dbt_backup"
[0m05:06:43.478927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.483058 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:06:43.483624 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard__dbt_tmp" rename to "stg_fbref__standard"
[0m05:06:43.484734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.486406 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m05:06:43.486951 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:06:43.487471 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m05:06:43.490672 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:06:43.494406 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m05:06:43.494781 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

      drop view if exists "players"."main"."stg_fbref__standard__dbt_backup" cascade
    
[0m05:06:43.496846 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.498293 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: Close
[0m05:06:43.498917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c363f47d690>]}
[0m05:06:43.499577 [info ] [Thread-1 (]: 8 of 11 OK created sql view model main.stg_fbref__standard ..................... [[32mOK[0m in 0.05s]
[0m05:06:43.500272 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__standard
[0m05:06:43.501161 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_player_season_stats
[0m05:06:43.501658 [info ] [Thread-1 (]: 9 of 11 START sql view model main.int_player_season_stats ...................... [RUN]
[0m05:06:43.502199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__standard, now model.nextgeneu_players.int_player_season_stats)
[0m05:06:43.502591 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_player_season_stats
[0m05:06:43.508678 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_player_season_stats"
[0m05:06:43.509460 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_player_season_stats
[0m05:06:43.514003 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_player_season_stats"
[0m05:06:43.514637 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:06:43.515001 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: BEGIN
[0m05:06:43.515355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.516153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.516513 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:06:43.516902 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

  
  create view "players"."main"."int_player_season_stats__dbt_tmp" as (
    WITH standard AS (SELECT * FROM "players"."main"."stg_fbref__standard"),
     shooting AS (SELECT * FROM "players"."main"."stg_fbref__shooting"),
     passing  AS (SELECT * FROM "players"."main"."stg_fbref__passing"),
     defense  AS (SELECT * FROM "players"."main"."stg_fbref__defense"),
     poss     AS (SELECT * FROM "players"."main"."stg_fbref__possession"),
     misc     AS (SELECT * FROM "players"."main"."stg_fbref__misc")

SELECT
    -- Anchors
    s.player_id,
    s.player_name,
    s.season_id,
    s.squad,
    s.competition,
    s.nation,
    s.primary_position,
    s.age,
    s.birth_year,
    s.minutes_played,
    s.minutes_90s,

    -- Attacking Metrics
    s.goals,
    s.assists,
    s.npxg,
    s.xag,
    coalesce(sh.shots_total, 0) as shots_total,
    coalesce(sh.shots_on_target, 0) as shots_on_target,

    -- Possession & Creation
    coalesce(p.key_passes, 0) as key_passes,
    coalesce(p.pass_progressive_distance, 0) as pass_progressive_distance,
    coalesce(poss.carry_progressive_distance, 0) as carry_progressive_distance,
    coalesce(poss.takeons_won, 0) as takeons_won,

    -- Defensive Workrate
    coalesce(d.tackles_won, 0) as tackles_won,
    coalesce(d.interceptions, 0) as interceptions,
    coalesce(d.tackles_att_3rd, 0) as tackles_att_3rd,
    coalesce(m.ball_recoveries, 0) as recoveries,
    coalesce(m.aerials_won, 0) as aerials_won

FROM standard s
LEFT JOIN shooting sh USING (player_id, squad, season_id)
LEFT JOIN passing p   USING (player_id, squad, season_id)
LEFT JOIN defense d   USING (player_id, squad, season_id)
LEFT JOIN poss        USING (player_id, squad, season_id)
LEFT JOIN misc m      USING (player_id, squad, season_id)

-- Filter out rows where the join keys might have drifted or empty names
WHERE s.player_id IS NOT NULL
  );

[0m05:06:43.524454 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m05:06:43.527967 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:06:43.528354 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats" rename to "int_player_season_stats__dbt_backup"
[0m05:06:43.529041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.533393 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:06:43.533763 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats__dbt_tmp" rename to "int_player_season_stats"
[0m05:06:43.534504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.535935 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m05:06:43.536353 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:06:43.536715 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m05:06:43.539715 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:06:43.542342 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m05:06:43.542757 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

      drop view if exists "players"."main"."int_player_season_stats__dbt_backup" cascade
    
[0m05:06:43.544352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.545662 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: Close
[0m05:06:43.546317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364bc734f0>]}
[0m05:06:43.546973 [info ] [Thread-1 (]: 9 of 11 OK created sql view model main.int_player_season_stats ................. [[32mOK[0m in 0.04s]
[0m05:06:43.547711 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_player_season_stats
[0m05:06:43.548576 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.dim_players
[0m05:06:43.549074 [info ] [Thread-1 (]: 10 of 11 START sql table model main.dim_players ................................ [RUN]
[0m05:06:43.549637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.int_player_season_stats, now model.nextgeneu_players.dim_players)
[0m05:06:43.550024 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.dim_players
[0m05:06:43.553124 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.dim_players"
[0m05:06:43.553737 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.dim_players
[0m05:06:43.573628 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.dim_players"
[0m05:06:43.574281 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:06:43.574643 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: BEGIN
[0m05:06:43.574968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.575763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.576146 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:06:43.576536 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

  
    
    

    create  table
      "players"."main"."dim_players__dbt_tmp"
  
    as (
      WITH unique_players AS (
    SELECT 
        player_id,
        -- Get the most recently used name (in case it changed)
        arg_max(player_name, season_id) as player_name,
        -- Get the most recent nation/position
        arg_max(nation, season_id) as nation,
        arg_max(primary_position, season_id) as primary_position,
        max(birth_year) as birth_year
    FROM "players"."main"."int_player_season_stats"
    GROUP BY player_id
)

SELECT * FROM unique_players
    );
  
  
[0m05:06:43.611669 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m05:06:43.617734 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:06:43.618187 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m05:06:43.619150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.620369 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:06:43.620730 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m05:06:43.621615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.625202 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:06:43.625564 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players" rename to "dim_players__dbt_backup"
[0m05:06:43.626220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.630479 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:06:43.630929 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players__dbt_tmp" rename to "dim_players"
[0m05:06:43.631702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.637169 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m05:06:43.637570 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:06:43.637987 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m05:06:43.643986 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m05:06:43.646745 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m05:06:43.647189 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

      drop table if exists "players"."main"."dim_players__dbt_backup" cascade
    
[0m05:06:43.649112 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.650439 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: Close
[0m05:06:43.651069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3644bff760>]}
[0m05:06:43.651747 [info ] [Thread-1 (]: 10 of 11 OK created sql table model main.dim_players ........................... [[32mOK[0m in 0.10s]
[0m05:06:43.652423 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.dim_players
[0m05:06:43.652847 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_scouting_analysis
[0m05:06:43.653419 [info ] [Thread-1 (]: 11 of 11 START sql table model main.mart_scouting_analysis ..................... [RUN]
[0m05:06:43.653925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.dim_players, now model.nextgeneu_players.mart_scouting_analysis)
[0m05:06:43.654341 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_scouting_analysis
[0m05:06:43.659923 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.660648 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_scouting_analysis
[0m05:06:43.664254 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.664865 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.665276 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: BEGIN
[0m05:06:43.665647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:06:43.666357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.666757 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.667335 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_scouting_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_player_season_stats"
    WHERE minutes_90s >= 5.0 -- Filter: Remove noise (players with < 5 games)
),

per_90_calculations AS (
    SELECT 
        *,
        -- 1. ATTACK SCORES
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE goals + assists / minutes_90s
    END
 as goal_contribution_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE npxg + xag / minutes_90s
    END
 as expected_contribution_per_90,
        
        -- 2. PROGRESSION SCORES (The "Engine" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE pass_progressive_distance + carry_progressive_distance / minutes_90s
    END
 as progression_total_dist_per_90,
        
        -- 3. DEFENSIVE SCORES (The "Workrate" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE tackles_won + interceptions + recoveries / minutes_90s
    END
 as defensive_actions_per_90,
        
        -- 4. FLAGS
        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect
    FROM base_stats
)

SELECT 
    *,
    -- Percentile Ranks (0.0 to 1.0)
    -- Compare players only against peers in the SAME position and SAME season
    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY expected_contribution_per_90 ASC
    ) as percentile_attacking,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY progression_total_dist_per_90 ASC
    ) as percentile_progression,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY defensive_actions_per_90 ASC
    ) as percentile_defense

FROM per_90_calculations
    );
  
  
[0m05:06:43.720607 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m05:06:43.722145 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.722636 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m05:06:43.723643 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.724950 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.725386 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m05:06:43.726372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:06:43.730170 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.730584 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis" rename to "mart_scouting_analysis__dbt_backup"
[0m05:06:43.731319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.736000 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.736424 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis__dbt_tmp" rename to "mart_scouting_analysis"
[0m05:06:43.737135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m05:06:43.738483 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m05:06:43.738888 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.739283 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m05:06:43.759209 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m05:06:43.763877 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m05:06:43.764453 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

      drop table if exists "players"."main"."mart_scouting_analysis__dbt_backup" cascade
    
[0m05:06:43.767022 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:06:43.768920 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: Close
[0m05:06:43.769759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5332c602-6510-4640-8425-be13ca8f0a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364e058070>]}
[0m05:06:43.770644 [info ] [Thread-1 (]: 11 of 11 OK created sql table model main.mart_scouting_analysis ................ [[32mOK[0m in 0.12s]
[0m05:06:43.771439 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_scouting_analysis
[0m05:06:43.773316 [debug] [MainThread]: Using duckdb connection "master"
[0m05:06:43.773697 [debug] [MainThread]: On master: BEGIN
[0m05:06:43.774044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:06:43.774811 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:06:43.775194 [debug] [MainThread]: On master: COMMIT
[0m05:06:43.775558 [debug] [MainThread]: Using duckdb connection "master"
[0m05:06:43.775876 [debug] [MainThread]: On master: COMMIT
[0m05:06:43.776446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:06:43.776803 [debug] [MainThread]: On master: Close
[0m05:06:43.777256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:06:43.777554 [debug] [MainThread]: Connection 'model.nextgeneu_players.mart_scouting_analysis' was properly closed.
[0m05:06:43.778126 [info ] [MainThread]: 
[0m05:06:43.778690 [info ] [MainThread]: Finished running 2 table models, 9 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m05:06:43.781385 [debug] [MainThread]: Command end result
[0m05:06:43.819841 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m05:06:43.821649 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m05:06:43.828826 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/transformation/target/run_results.json
[0m05:06:43.829167 [info ] [MainThread]: 
[0m05:06:43.829623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:06:43.830004 [info ] [MainThread]: 
[0m05:06:43.830452 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m05:06:43.831524 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.9895985, "process_in_blocks": "0", "process_kernel_time": 0.27991, "process_mem_max_rss": "332644", "process_out_blocks": "7480", "process_user_time": 3.590676}
[0m05:06:43.832028 [debug] [MainThread]: Command `dbt build` succeeded at 05:06:43.831922 after 1.99 seconds
[0m05:06:43.832433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364c4d86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3644b94a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c364e4763e0>]}
[0m05:06:43.832829 [debug] [MainThread]: Flushing usage events
[0m05:06:44.321496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:57:26.826147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5da005e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5cb82e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5c8caec0>]}


============================== 02:57:26.881530 | 6ca147e8-16b8-4de8-92cd-2a0d173ef5e6 ==============================
[0m02:57:26.881530 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:57:26.882189 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/app/transformation/logs', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'profiles_dir': '.', 'write_json': 'True', 'introspect': 'True'}
[0m02:57:27.140454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5ca58700>]}
[0m02:57:27.212033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5c8a7bb0>]}
[0m02:57:27.213988 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:57:27.453886 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:57:27.607381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m02:57:27.608100 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/intermediate/int_goalkeeper_season_stats.sql
[0m02:57:27.608519 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/marts/scouting/mart_goalkeeping_analysis.sql
[0m02:57:27.608891 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/defense/stg_fbref__goalkeeping.sql
[0m02:57:27.609290 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/distribution/stg_fbref__pass_types.sql
[0m02:57:27.609702 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/staging/defense/stg_fbref__adv_goalkeeping.sql
[0m02:57:27.610140 [debug] [MainThread]: Partial parsing: updated file: nextgeneu_players://models/intermediate/int_player_season_stats.sql
[0m02:57:27.988961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b561b75e0>]}
[0m02:57:28.097070 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m02:57:28.099132 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m02:57:28.123462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b55712bf0>]}
[0m02:57:28.124085 [info ] [MainThread]: Found 16 models, 33 sources, 586 macros
[0m02:57:28.124497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b56c6b400>]}
[0m02:57:28.127053 [info ] [MainThread]: 
[0m02:57:28.127483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:28.127883 [info ] [MainThread]: 
[0m02:57:28.128559 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:57:28.135693 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m02:57:28.377040 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m02:57:28.377568 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m02:57:28.377964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:28.405580 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m02:57:28.406903 [debug] [ThreadPool]: On list_players: Close
[0m02:57:28.407702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m02:57:28.408197 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m02:57:28.415737 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m02:57:28.416103 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m02:57:28.416449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:28.417602 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:57:28.418791 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m02:57:28.419123 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m02:57:28.419683 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:57:28.420009 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m02:57:28.420361 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m02:57:28.420972 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:57:28.421782 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m02:57:28.422118 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m02:57:28.422473 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m02:57:28.423034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:57:28.423437 [debug] [ThreadPool]: On create_players_main: Close
[0m02:57:28.425651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m02:57:28.431789 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m02:57:28.432136 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m02:57:28.432516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:28.433195 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:57:28.433556 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m02:57:28.433963 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m02:57:28.446460 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:57:28.447815 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m02:57:28.448471 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m02:57:28.448797 [debug] [ThreadPool]: On list_players_main: Close
[0m02:57:28.451108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b561dfdf0>]}
[0m02:57:28.451609 [debug] [MainThread]: Using duckdb connection "master"
[0m02:57:28.451934 [debug] [MainThread]: On master: BEGIN
[0m02:57:28.452244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:28.452869 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:57:28.453205 [debug] [MainThread]: On master: COMMIT
[0m02:57:28.453574 [debug] [MainThread]: Using duckdb connection "master"
[0m02:57:28.453893 [debug] [MainThread]: On master: COMMIT
[0m02:57:28.454482 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:57:28.454823 [debug] [MainThread]: On master: Close
[0m02:57:28.458281 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m02:57:28.458846 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_fbref__adv_goalkeeping ................... [RUN]
[0m02:57:28.459372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.stg_fbref__adv_goalkeeping)
[0m02:57:28.459825 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m02:57:28.470614 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:57:28.471277 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m02:57:28.502878 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:57:28.503647 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:57:28.504059 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: BEGIN
[0m02:57:28.504463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.505549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.505962 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:57:28.506434 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */

  
  create view "players"."main"."stg_fbref__adv_goalkeeping__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    TRY_CAST(expected_psxg AS FLOAT) as psxg, -- Post-Shot Expected Goals (How hard were the shots?)
    TRY_CAST(expected_psxg_1 AS FLOAT) as psxg_plus_minus, -- The "Shot Stopping" Metric
    
    
    TRY_CAST(REPLACE(launched_cmp, ',', '') AS INTEGER)
 as long_passes_completed,
    TRY_CAST(launched_cmp_1 AS FLOAT) as long_pass_completion_pct,
    
    
    TRY_CAST(REPLACE(crosses_stp, ',', '') AS INTEGER)
 as crosses_stopped,
    TRY_CAST(crosses_stp_1 AS FLOAT) as crosses_stopped_pct,
    
    
    TRY_CAST(REPLACE(sweeper_opa, ',', '') AS INTEGER)
 as defensive_actions_outside_pen_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.508156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.514506 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:57:28.514943 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */
alter view "players"."main"."stg_fbref__adv_goalkeeping__dbt_tmp" rename to "stg_fbref__adv_goalkeeping"
[0m02:57:28.515688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.526354 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: COMMIT
[0m02:57:28.526779 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:57:28.527192 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: COMMIT
[0m02:57:28.545838 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m02:57:28.551541 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:57:28.551961 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */

      drop view if exists "players"."main"."stg_fbref__adv_goalkeeping__dbt_backup" cascade
    
[0m02:57:28.552683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.555508 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: Close
[0m02:57:28.558007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5f7096c0>]}
[0m02:57:28.558705 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_fbref__adv_goalkeeping .............. [[32mOK[0m in 0.10s]
[0m02:57:28.559423 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m02:57:28.559910 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__creation
[0m02:57:28.560525 [info ] [Thread-1 (]: 2 of 16 START sql view model main.stg_fbref__creation .......................... [RUN]
[0m02:57:28.561073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__adv_goalkeeping, now model.nextgeneu_players.stg_fbref__creation)
[0m02:57:28.561510 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__creation
[0m02:57:28.566822 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__creation"
[0m02:57:28.567517 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__creation
[0m02:57:28.571055 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__creation"
[0m02:57:28.571753 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:57:28.572169 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: BEGIN
[0m02:57:28.572594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.573284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.573723 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:57:28.574165 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

  
  create view "players"."main"."stg_fbref__creation__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(sca_sca, ',', '') AS INTEGER)
 as shot_creating_actions,
    
    TRY_CAST(REPLACE(gca_gca, ',', '') AS INTEGER)
 as goal_creating_actions

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.575708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.578925 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:57:28.579418 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation" rename to "stg_fbref__creation__dbt_backup"
[0m02:57:28.580496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.583525 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:57:28.583967 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation__dbt_tmp" rename to "stg_fbref__creation"
[0m02:57:28.584646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.587799 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m02:57:28.588201 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:57:28.588598 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m02:57:28.591190 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.594665 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:57:28.595142 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

      drop view if exists "players"."main"."stg_fbref__creation__dbt_backup" cascade
    
[0m02:57:28.597158 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.598458 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: Close
[0m02:57:28.599044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5daf7d30>]}
[0m02:57:28.599822 [info ] [Thread-1 (]: 2 of 16 OK created sql view model main.stg_fbref__creation ..................... [[32mOK[0m in 0.04s]
[0m02:57:28.600725 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__creation
[0m02:57:28.601351 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__defense
[0m02:57:28.602030 [info ] [Thread-1 (]: 3 of 16 START sql view model main.stg_fbref__defense ........................... [RUN]
[0m02:57:28.602590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__creation, now model.nextgeneu_players.stg_fbref__defense)
[0m02:57:28.603138 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__defense
[0m02:57:28.609707 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__defense"
[0m02:57:28.610424 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__defense
[0m02:57:28.614084 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__defense"
[0m02:57:28.614815 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:57:28.615274 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: BEGIN
[0m02:57:28.615688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.616409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.616818 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:57:28.617260 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

  
  create view "players"."main"."stg_fbref__defense__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."defensive_actions_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."defensive_actions_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."defensive_actions_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(tackles_tkl, ',', '') AS INTEGER)
 as tackles_total,
    
    TRY_CAST(REPLACE(tackles_tklw, ',', '') AS INTEGER)
 as tackles_won,
    
    TRY_CAST(REPLACE(tackles_att_3rd, ',', '') AS INTEGER)
 as tackles_att_3rd,
    
    TRY_CAST(REPLACE(unnamed_21_level_0_int, ',', '') AS INTEGER)
 as interceptions,
    
    TRY_CAST(REPLACE(unnamed_23_level_0_clr, ',', '') AS INTEGER)
 as clearances,
    
    TRY_CAST(REPLACE(blocks_sh, ',', '') AS INTEGER)
 as shots_blocked

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.618865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.621984 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:57:28.622431 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense" rename to "stg_fbref__defense__dbt_backup"
[0m02:57:28.623134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.626131 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:57:28.626594 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense__dbt_tmp" rename to "stg_fbref__defense"
[0m02:57:28.627275 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.628573 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m02:57:28.628982 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:57:28.629413 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m02:57:28.632027 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.635262 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:57:28.635704 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

      drop view if exists "players"."main"."stg_fbref__defense__dbt_backup" cascade
    
[0m02:57:28.637377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.638631 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: Close
[0m02:57:28.639230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5daf7d30>]}
[0m02:57:28.639877 [info ] [Thread-1 (]: 3 of 16 OK created sql view model main.stg_fbref__defense ...................... [[32mOK[0m in 0.04s]
[0m02:57:28.640569 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__defense
[0m02:57:28.640995 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__goalkeeping
[0m02:57:28.641576 [info ] [Thread-1 (]: 4 of 16 START sql view model main.stg_fbref__goalkeeping ....................... [RUN]
[0m02:57:28.642115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__defense, now model.nextgeneu_players.stg_fbref__goalkeeping)
[0m02:57:28.642585 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__goalkeeping
[0m02:57:28.649842 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:57:28.650501 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__goalkeeping
[0m02:57:28.654062 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:57:28.654759 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:57:28.655185 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: BEGIN
[0m02:57:28.655681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.656405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.656817 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:57:28.657264 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */

  
  create view "players"."main"."stg_fbref__goalkeeping__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goalkeeping_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goalkeeping_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goalkeeping_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_against,
    
    TRY_CAST(REPLACE(performance_saves, ',', '') AS INTEGER)
 as saves,
    TRY_CAST(performance_save AS FLOAT) as save_pct,
    
    TRY_CAST(REPLACE(performance_cs, ',', '') AS INTEGER)
 as clean_sheets,
    TRY_CAST(performance_cs_1 AS FLOAT) as clean_sheet_pct,
    
    TRY_CAST(REPLACE(penalty_kicks_pka, ',', '') AS INTEGER)
 as pk_allowed,
    
    TRY_CAST(REPLACE(penalty_kicks_pksv, ',', '') AS INTEGER)
 as pk_saved

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.658936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.662038 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:57:28.662463 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */
alter view "players"."main"."stg_fbref__goalkeeping__dbt_tmp" rename to "stg_fbref__goalkeeping"
[0m02:57:28.663159 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.664340 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: COMMIT
[0m02:57:28.664739 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:57:28.665107 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: COMMIT
[0m02:57:28.667571 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.670051 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:57:28.670468 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */

      drop view if exists "players"."main"."stg_fbref__goalkeeping__dbt_backup" cascade
    
[0m02:57:28.671123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.672367 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: Close
[0m02:57:28.672982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5417bca0>]}
[0m02:57:28.673643 [info ] [Thread-1 (]: 4 of 16 OK created sql view model main.stg_fbref__goalkeeping .................. [[32mOK[0m in 0.03s]
[0m02:57:28.674346 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__goalkeeping
[0m02:57:28.674775 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__misc
[0m02:57:28.675381 [info ] [Thread-1 (]: 5 of 16 START sql view model main.stg_fbref__misc .............................. [RUN]
[0m02:57:28.675907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__goalkeeping, now model.nextgeneu_players.stg_fbref__misc)
[0m02:57:28.676370 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__misc
[0m02:57:28.682999 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__misc"
[0m02:57:28.683710 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__misc
[0m02:57:28.745726 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__misc"
[0m02:57:28.746641 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:57:28.747111 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: BEGIN
[0m02:57:28.747536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.748435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.748842 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:57:28.749316 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

  
  create view "players"."main"."stg_fbref__misc__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."miscellaneous_stats_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."miscellaneous_stats_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."miscellaneous_stats_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_crdy, ',', '') AS INTEGER)
 as yellow_cards,
    
    TRY_CAST(REPLACE(performance_crdr, ',', '') AS INTEGER)
 as red_cards,
    
    TRY_CAST(REPLACE(performance_fls, ',', '') AS INTEGER)
 as fouls_committed,
    
    TRY_CAST(REPLACE(performance_fld, ',', '') AS INTEGER)
 as fouls_drawn,
    
    TRY_CAST(REPLACE(performance_off, ',', '') AS INTEGER)
 as offsides,
    
    TRY_CAST(REPLACE(performance_recov, ',', '') AS INTEGER)
 as ball_recoveries,
    
    TRY_CAST(REPLACE(aerial_duels_won, ',', '') AS INTEGER)
 as aerials_won,
    
    TRY_CAST(REPLACE(aerial_duels_lost, ',', '') AS INTEGER)
 as aerials_lost

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.751047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.754382 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:57:28.754810 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc" rename to "stg_fbref__misc__dbt_backup"
[0m02:57:28.755533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.758435 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:57:28.758858 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc__dbt_tmp" rename to "stg_fbref__misc"
[0m02:57:28.759552 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.760796 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m02:57:28.761211 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:57:28.761622 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m02:57:28.764339 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.767118 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:57:28.767664 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

      drop view if exists "players"."main"."stg_fbref__misc__dbt_backup" cascade
    
[0m02:57:28.769252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.770578 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: Close
[0m02:57:28.771208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5daf7d30>]}
[0m02:57:28.771883 [info ] [Thread-1 (]: 5 of 16 OK created sql view model main.stg_fbref__misc ......................... [[32mOK[0m in 0.10s]
[0m02:57:28.772596 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__misc
[0m02:57:28.773039 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__pass_types
[0m02:57:28.773644 [info ] [Thread-1 (]: 6 of 16 START sql view model main.stg_fbref__pass_types ........................ [RUN]
[0m02:57:28.774185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__misc, now model.nextgeneu_players.stg_fbref__pass_types)
[0m02:57:28.774621 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__pass_types
[0m02:57:28.780682 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:57:28.781436 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__pass_types
[0m02:57:28.786686 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:57:28.787428 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:57:28.787940 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: BEGIN
[0m02:57:28.788343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.789216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.789675 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:57:28.790153 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */

  
  create view "players"."main"."stg_fbref__pass_types__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."pass_types_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."pass_types_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."pass_types_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    -- High Value Creation Stats
    
    TRY_CAST(REPLACE(pass_types_tb, ',', '') AS INTEGER)
 as through_balls,
    
    TRY_CAST(REPLACE(pass_types_sw, ',', '') AS INTEGER)
 as switches,
    
    TRY_CAST(REPLACE(pass_types_crs, ',', '') AS INTEGER)
 as crosses,
    
    TRY_CAST(REPLACE(corner_kicks_in, ',', '') AS INTEGER)
 as corners_inswing,
    
    TRY_CAST(REPLACE(corner_kicks_out, ',', '') AS INTEGER)
 as corners_outswing

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.791856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.795244 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:57:28.795723 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */
alter view "players"."main"."stg_fbref__pass_types__dbt_tmp" rename to "stg_fbref__pass_types"
[0m02:57:28.796544 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.797804 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: COMMIT
[0m02:57:28.798280 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:57:28.798696 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: COMMIT
[0m02:57:28.801342 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.804181 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:57:28.804667 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */

      drop view if exists "players"."main"."stg_fbref__pass_types__dbt_backup" cascade
    
[0m02:57:28.805455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.806914 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: Close
[0m02:57:28.807612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5d88c880>]}
[0m02:57:28.808345 [info ] [Thread-1 (]: 6 of 16 OK created sql view model main.stg_fbref__pass_types ................... [[32mOK[0m in 0.03s]
[0m02:57:28.809092 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__pass_types
[0m02:57:28.809592 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__passing
[0m02:57:28.810172 [info ] [Thread-1 (]: 7 of 16 START sql view model main.stg_fbref__passing ........................... [RUN]
[0m02:57:28.810745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__pass_types, now model.nextgeneu_players.stg_fbref__passing)
[0m02:57:28.811260 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__passing
[0m02:57:28.819511 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__passing"
[0m02:57:28.820351 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__passing
[0m02:57:28.824347 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__passing"
[0m02:57:28.825095 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:57:28.825530 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: BEGIN
[0m02:57:28.825925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.826832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.827256 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:57:28.827738 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

  
  create view "players"."main"."stg_fbref__passing__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."passing_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."passing_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."passing_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(total_cmp, ',', '') AS INTEGER)
 as passes_completed,
    
    TRY_CAST(REPLACE(total_att, ',', '') AS INTEGER)
 as passes_attempted,
    
    TRY_CAST(REPLACE(total_prgdist, ',', '') AS INTEGER)
 as pass_progressive_distance,
    
    TRY_CAST(REPLACE(unnamed_27_level_0_kp, ',', '') AS INTEGER)
 as key_passes,
    
    TRY_CAST(REPLACE(unnamed_29_level_0_ppa, ',', '') AS INTEGER)
 as passes_into_penalty_area,
    
    TRY_CAST(REPLACE(unnamed_30_level_0_crspa, ',', '') AS INTEGER)
 as crosses_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.829551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.833159 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:57:28.833607 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing" rename to "stg_fbref__passing__dbt_backup"
[0m02:57:28.834359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.838997 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:57:28.839469 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing__dbt_tmp" rename to "stg_fbref__passing"
[0m02:57:28.840208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.841530 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m02:57:28.841945 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:57:28.842362 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m02:57:28.844985 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.847769 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:57:28.848186 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

      drop view if exists "players"."main"."stg_fbref__passing__dbt_backup" cascade
    
[0m02:57:28.850140 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.851499 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: Close
[0m02:57:28.852141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5630f910>]}
[0m02:57:28.852855 [info ] [Thread-1 (]: 7 of 16 OK created sql view model main.stg_fbref__passing ...................... [[32mOK[0m in 0.04s]
[0m02:57:28.853544 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__passing
[0m02:57:28.853975 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__playing_time
[0m02:57:28.854565 [info ] [Thread-1 (]: 8 of 16 START sql view model main.stg_fbref__playing_time ...................... [RUN]
[0m02:57:28.855111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__passing, now model.nextgeneu_players.stg_fbref__playing_time)
[0m02:57:28.855530 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__playing_time
[0m02:57:28.861452 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:57:28.862182 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__playing_time
[0m02:57:28.866325 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:57:28.867134 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:57:28.867695 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: BEGIN
[0m02:57:28.868204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.869063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.869648 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:57:28.870294 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

  
  create view "players"."main"."stg_fbref__playing_time__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."playing_time_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."playing_time_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."playing_time_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_1_level_0_player as player_name,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
    
    TRY_CAST(REPLACE(starts_starts, ',', '') AS INTEGER)
 as starts,
    
    TRY_CAST(REPLACE(subs_subs, ',', '') AS INTEGER)
 as substitutions_on,
    
    TRY_CAST(REPLACE(subs_unsub, ',', '') AS INTEGER)
 as unused_sub,
    
    -- Team Success (Plus/Minus)
    TRY_CAST(team_success_onoff AS FLOAT) as plus_minus_net_per_90

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.872295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.875685 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:57:28.876133 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time" rename to "stg_fbref__playing_time__dbt_backup"
[0m02:57:28.876884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.881007 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:57:28.881450 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time__dbt_tmp" rename to "stg_fbref__playing_time"
[0m02:57:28.882145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.883425 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m02:57:28.883828 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:57:28.884206 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m02:57:28.886681 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.889253 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:57:28.889722 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

      drop view if exists "players"."main"."stg_fbref__playing_time__dbt_backup" cascade
    
[0m02:57:28.891461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.892817 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: Close
[0m02:57:28.893495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5d88c880>]}
[0m02:57:28.894165 [info ] [Thread-1 (]: 8 of 16 OK created sql view model main.stg_fbref__playing_time ................. [[32mOK[0m in 0.04s]
[0m02:57:28.894884 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__playing_time
[0m02:57:28.895345 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__possession
[0m02:57:28.895920 [info ] [Thread-1 (]: 9 of 16 START sql view model main.stg_fbref__possession ........................ [RUN]
[0m02:57:28.896468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__playing_time, now model.nextgeneu_players.stg_fbref__possession)
[0m02:57:28.896907 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__possession
[0m02:57:28.903402 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__possession"
[0m02:57:28.904206 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__possession
[0m02:57:28.909773 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__possession"
[0m02:57:28.910521 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:57:28.910923 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: BEGIN
[0m02:57:28.911330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.912038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.912451 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:57:28.912883 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

  
  create view "players"."main"."stg_fbref__possession__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."possession_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."possession_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."possession_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(touches_touches, ',', '') AS INTEGER)
 as touches,
    
    TRY_CAST(REPLACE(touches_att_pen, ',', '') AS INTEGER)
 as touches_att_pen,
    
    TRY_CAST(REPLACE(takeons_succ, ',', '') AS INTEGER)
 as takeons_won,
    
    TRY_CAST(REPLACE(takeons_att, ',', '') AS INTEGER)
 as takeons_attempted,
    
    TRY_CAST(REPLACE(carries_prgdist, ',', '') AS INTEGER)
 as carry_progressive_distance,
    
    TRY_CAST(REPLACE(carries_cpa, ',', '') AS INTEGER)
 as carries_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.914530 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.917896 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:57:28.918489 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession" rename to "stg_fbref__possession__dbt_backup"
[0m02:57:28.919470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.923325 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:57:28.923782 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession__dbt_tmp" rename to "stg_fbref__possession"
[0m02:57:28.924464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.925759 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m02:57:28.926149 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:57:28.926536 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m02:57:28.929351 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.933150 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:57:28.933590 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

      drop view if exists "players"."main"."stg_fbref__possession__dbt_backup" cascade
    
[0m02:57:28.935494 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.936752 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: Close
[0m02:57:28.937382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5c8a58d0>]}
[0m02:57:28.938025 [info ] [Thread-1 (]: 9 of 16 OK created sql view model main.stg_fbref__possession ................... [[32mOK[0m in 0.04s]
[0m02:57:28.938707 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__possession
[0m02:57:28.939197 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__shooting
[0m02:57:28.940025 [info ] [Thread-1 (]: 10 of 16 START sql view model main.stg_fbref__shooting ......................... [RUN]
[0m02:57:28.940700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__possession, now model.nextgeneu_players.stg_fbref__shooting)
[0m02:57:28.941188 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__shooting
[0m02:57:28.946675 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__shooting"
[0m02:57:28.947374 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__shooting
[0m02:57:28.950922 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__shooting"
[0m02:57:28.951643 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:57:28.952040 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: BEGIN
[0m02:57:28.952423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.953084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.953512 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:57:28.953946 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

  
  create view "players"."main"."stg_fbref__shooting__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."shooting_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."shooting_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."shooting_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(standard_sh, ',', '') AS INTEGER)
 as shots_total,
    
    TRY_CAST(REPLACE(standard_sot, ',', '') AS INTEGER)
 as shots_on_target,
    TRY_CAST(standard_dist AS FLOAT) as avg_shot_distance

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:57:28.955444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.958559 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:57:28.958958 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting" rename to "stg_fbref__shooting__dbt_backup"
[0m02:57:28.959666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.962693 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:57:28.963103 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting__dbt_tmp" rename to "stg_fbref__shooting"
[0m02:57:28.963799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:28.965028 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m02:57:28.965440 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:57:28.965811 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m02:57:28.968357 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.971888 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:57:28.972331 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

      drop view if exists "players"."main"."stg_fbref__shooting__dbt_backup" cascade
    
[0m02:57:28.974274 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:28.975552 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: Close
[0m02:57:28.976127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b54143400>]}
[0m02:57:28.976763 [info ] [Thread-1 (]: 10 of 16 OK created sql view model main.stg_fbref__shooting .................... [[32mOK[0m in 0.04s]
[0m02:57:28.977436 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__shooting
[0m02:57:28.977854 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__standard
[0m02:57:28.978419 [info ] [Thread-1 (]: 11 of 16 START sql view model main.stg_fbref__standard ......................... [RUN]
[0m02:57:28.978927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__shooting, now model.nextgeneu_players.stg_fbref__standard)
[0m02:57:28.979357 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__standard
[0m02:57:28.987992 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__standard"
[0m02:57:28.988781 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__standard
[0m02:57:28.992449 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__standard"
[0m02:57:28.993163 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:57:28.993605 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: BEGIN
[0m02:57:28.993981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:28.994666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:28.995065 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:57:28.995575 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

  
  create view "players"."main"."stg_fbref__standard__dbt_tmp" as (
    -- 1. CONFIGURATION


WITH raw_union AS (
    
        SELECT 
            *, 
            '2023_2024' as source_season_id 
        FROM "players"."raw"."standard_stats_2023_2024"
         UNION ALL 
    
        SELECT 
            *, 
            '2024_2025' as source_season_id 
        FROM "players"."raw"."standard_stats_2024_2025"
         UNION ALL 
    
        SELECT 
            *, 
            '2025_2026' as source_season_id 
        FROM "players"."raw"."standard_stats_2025_2026"
        
    
),

cleaned AS (
    SELECT
        -- 1. IDENTITY (The Golden Key)
        
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
        
        -- 2. METADATA
        unnamed_1_level_0_player as player_name,
        unnamed_2_level_0_nation as nation,
        unnamed_4_level_0_squad  as squad,
        unnamed_3_level_0_pos    as primary_position,
        unnamed_5_level_0_comp   as competition,
        source_season_id         as season_id,
        
        -- 3. DEMOGRAPHICS
        
    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)
 as age,
        
    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)
 as birth_year,

        -- 4. PLAYING TIME
        
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
        
    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)
 as matches_started,
        
    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)
 as minutes_played,
        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,

        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)
        
    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)
 as goals,
        
    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)
 as assists,
        
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_assists,
        
    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)
 as penalties_made,
        
    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)
 as penalties_att,
        
        -- 6. EXPECTED METRICS
        TRY_CAST(expected_xg AS FLOAT) as xg,
        TRY_CAST(expected_npxg AS FLOAT) as npxg,
        TRY_CAST(expected_xag AS FLOAT) as xag,
        
        -- 7. PROGRESSION
        
    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)
 as progressive_carries,
        
    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)
 as progressive_passes,
        
    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)
 as progressive_receptions

    FROM raw_union
)

SELECT * FROM cleaned
WHERE player_name != 'Player' -- Filter header rows
  AND player_name IS NOT NULL
  );

[0m02:57:28.998030 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:29.001227 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:57:29.001697 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard" rename to "stg_fbref__standard__dbt_backup"
[0m02:57:29.002467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.005461 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:57:29.005878 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard__dbt_tmp" rename to "stg_fbref__standard"
[0m02:57:29.006615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.007850 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m02:57:29.008260 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:57:29.008673 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m02:57:29.011914 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:57:29.014790 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:57:29.015241 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

      drop view if exists "players"."main"."stg_fbref__standard__dbt_backup" cascade
    
[0m02:57:29.017142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.018469 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: Close
[0m02:57:29.019057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5c8a58d0>]}
[0m02:57:29.019722 [info ] [Thread-1 (]: 11 of 16 OK created sql view model main.stg_fbref__standard .................... [[32mOK[0m in 0.04s]
[0m02:57:29.020411 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__standard
[0m02:57:29.021297 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_goalkeeper_season_stats
[0m02:57:29.021818 [info ] [Thread-1 (]: 12 of 16 START sql view model main.int_goalkeeper_season_stats ................. [RUN]
[0m02:57:29.022349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__standard, now model.nextgeneu_players.int_goalkeeper_season_stats)
[0m02:57:29.022766 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_goalkeeper_season_stats
[0m02:57:29.027623 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:57:29.028273 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_goalkeeper_season_stats
[0m02:57:29.032594 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:57:29.033371 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:57:29.033817 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: BEGIN
[0m02:57:29.034204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:29.034891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.035290 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:57:29.035742 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */

  
  create view "players"."main"."int_goalkeeper_season_stats__dbt_tmp" as (
    WITH base AS (SELECT * FROM "players"."main"."stg_fbref__standard"), -- We still need Standard for Age/Nation/Minutes
     gk_basic AS (SELECT * FROM "players"."main"."stg_fbref__goalkeeping"),
     gk_adv   AS (SELECT * FROM "players"."main"."stg_fbref__adv_goalkeeping")

SELECT 
    b.player_id,
    b.player_name,
    b.season_id,
    b.squad,
    b.nation,
    b.age,
    b.minutes_90s,
    
    -- Basic
    g.goals_against,
    g.save_pct,
    g.clean_sheet_pct,
    g.pk_saved,
    
    -- Advanced (The Real Money Stats)
    a.psxg,
    a.psxg_plus_minus, -- Positive = Elite Shot Stopping
    a.crosses_stopped_pct, -- Command of Area
    a.defensive_actions_outside_pen_area as sweeper_actions,
    a.long_pass_completion_pct

FROM base b
INNER JOIN gk_basic g USING (player_id, squad, season_id) -- Inner Join because we ONLY want GKs
LEFT JOIN gk_adv a    USING (player_id, squad, season_id)
  );

[0m02:57:29.039917 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:57:29.042974 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:57:29.043407 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */
alter view "players"."main"."int_goalkeeper_season_stats__dbt_tmp" rename to "int_goalkeeper_season_stats"
[0m02:57:29.044098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.045399 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: COMMIT
[0m02:57:29.045832 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:57:29.046230 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: COMMIT
[0m02:57:29.048538 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:29.051189 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:57:29.051620 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */

      drop view if exists "players"."main"."int_goalkeeper_season_stats__dbt_backup" cascade
    
[0m02:57:29.052286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.053571 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: Close
[0m02:57:29.054166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b56180df0>]}
[0m02:57:29.054819 [info ] [Thread-1 (]: 12 of 16 OK created sql view model main.int_goalkeeper_season_stats ............ [[32mOK[0m in 0.03s]
[0m02:57:29.055497 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_goalkeeper_season_stats
[0m02:57:29.055923 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_player_season_stats
[0m02:57:29.056611 [info ] [Thread-1 (]: 13 of 16 START sql view model main.int_player_season_stats ..................... [RUN]
[0m02:57:29.057176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.int_goalkeeper_season_stats, now model.nextgeneu_players.int_player_season_stats)
[0m02:57:29.057613 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_player_season_stats
[0m02:57:29.062904 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_player_season_stats"
[0m02:57:29.063589 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_player_season_stats
[0m02:57:29.068430 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_player_season_stats"
[0m02:57:29.069130 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:57:29.069570 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: BEGIN
[0m02:57:29.069940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:29.070614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.071042 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:57:29.071753 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

  
  create view "players"."main"."int_player_season_stats__dbt_tmp" as (
    WITH standard AS (SELECT * FROM "players"."main"."stg_fbref__standard"),
     shooting AS (SELECT * FROM "players"."main"."stg_fbref__shooting"),
     passing  AS (SELECT * FROM "players"."main"."stg_fbref__passing"),
     pass_types AS (SELECT * FROM "players"."main"."stg_fbref__pass_types"),
     defense  AS (SELECT * FROM "players"."main"."stg_fbref__defense"),
     poss     AS (SELECT * FROM "players"."main"."stg_fbref__possession"),
     misc     AS (SELECT * FROM "players"."main"."stg_fbref__misc")

SELECT
    -- Anchors
    s.player_id,
    s.player_name,
    s.season_id,
    s.squad,
    s.competition,
    s.nation,
    s.primary_position,
    s.age,
    s.birth_year,
    s.minutes_played,
    s.minutes_90s,

    -- Attacking Metrics
    s.goals,
    s.assists,
    s.npxg,
    s.xag,
    coalesce(sh.shots_total, 0) as shots_total,
    coalesce(sh.shots_on_target, 0) as shots_on_target,

    -- Possession & Creation
    coalesce(p.key_passes, 0) as key_passes,
    coalesce(p.pass_progressive_distance, 0) as pass_progressive_distance,
    coalesce(pt.through_balls, 0) as through_balls,
    coalesce(pt.switches, 0) as switches,
    coalesce(pt.crosses, 0) as crosses,
    coalesce(poss.carry_progressive_distance, 0) as carry_progressive_distance,
    coalesce(poss.takeons_won, 0) as takeons_won,

    -- Defensive Workrate
    coalesce(d.tackles_won, 0) as tackles_won,
    coalesce(d.interceptions, 0) as interceptions,
    coalesce(d.tackles_att_3rd, 0) as tackles_att_3rd,
    coalesce(m.ball_recoveries, 0) as recoveries,
    coalesce(m.aerials_won, 0) as aerials_won

FROM standard s
LEFT JOIN shooting sh USING (player_id, squad, season_id)
LEFT JOIN passing p   USING (player_id, squad, season_id)
LEFT JOIN pass_types pt USING (player_id, squad, season_id)
LEFT JOIN defense d   USING (player_id, squad, season_id)
LEFT JOIN poss        USING (player_id, squad, season_id)
LEFT JOIN misc m      USING (player_id, squad, season_id)

-- Filter out rows where the join keys might have drifted or empty names
WHERE s.player_id IS NOT NULL
  );

[0m02:57:29.082730 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m02:57:29.086080 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:57:29.086551 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats" rename to "int_player_season_stats__dbt_backup"
[0m02:57:29.087317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.090253 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:57:29.090718 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats__dbt_tmp" rename to "int_player_season_stats"
[0m02:57:29.091469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.092723 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m02:57:29.093162 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:57:29.093613 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m02:57:29.096185 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:29.098839 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:57:29.099296 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

      drop view if exists "players"."main"."int_player_season_stats__dbt_backup" cascade
    
[0m02:57:29.101200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.102517 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: Close
[0m02:57:29.103121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b56180df0>]}
[0m02:57:29.103794 [info ] [Thread-1 (]: 13 of 16 OK created sql view model main.int_player_season_stats ................ [[32mOK[0m in 0.05s]
[0m02:57:29.104482 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_player_season_stats
[0m02:57:29.104955 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_goalkeeping_analysis
[0m02:57:29.105575 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_goalkeeping_analysis .................. [RUN]
[0m02:57:29.106276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.int_player_season_stats, now model.nextgeneu_players.mart_goalkeeping_analysis)
[0m02:57:29.106746 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_goalkeeping_analysis
[0m02:57:29.111120 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:57:29.111891 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_goalkeeping_analysis
[0m02:57:29.133230 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:57:29.133996 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:57:29.134549 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: BEGIN
[0m02:57:29.134993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:29.135749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.136157 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:57:29.136619 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_goalkeeping_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_goalkeeper_season_stats"
    WHERE minutes_90s >= 5.0
),

per_90_calculations AS (
    SELECT 
        *,
        -- Normalization
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE psxg_plus_minus / minutes_90s
    END
 as psxg_plus_minus_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE sweeper_actions / minutes_90s
    END
 as sweeper_actions_per_90
    FROM base_stats
)

SELECT 
    *,
    -- Percentiles (Compare GK vs GK only)
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY psxg_plus_minus_per_90 ASC) as percentile_shot_stopping,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY crosses_stopped_pct ASC) as percentile_command,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY sweeper_actions_per_90 ASC) as percentile_sweeping,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY long_pass_completion_pct ASC) as percentile_distribution
FROM per_90_calculations
    );
  
  
[0m02:57:29.165027 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m02:57:29.169106 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:57:29.169553 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */
alter table "players"."main"."mart_goalkeeping_analysis__dbt_tmp" rename to "mart_goalkeeping_analysis"
[0m02:57:29.170425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.175165 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: COMMIT
[0m02:57:29.175597 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:57:29.175971 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: COMMIT
[0m02:57:29.179604 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:57:29.182274 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:57:29.182725 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

      drop table if exists "players"."main"."mart_goalkeeping_analysis__dbt_backup" cascade
    
[0m02:57:29.183379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.184727 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: Close
[0m02:57:29.185423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b56180df0>]}
[0m02:57:29.186113 [info ] [Thread-1 (]: 14 of 16 OK created sql table model main.mart_goalkeeping_analysis ............. [[32mOK[0m in 0.08s]
[0m02:57:29.186912 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_goalkeeping_analysis
[0m02:57:29.187406 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.dim_players
[0m02:57:29.187995 [info ] [Thread-1 (]: 15 of 16 START sql table model main.dim_players ................................ [RUN]
[0m02:57:29.188551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.mart_goalkeeping_analysis, now model.nextgeneu_players.dim_players)
[0m02:57:29.188980 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.dim_players
[0m02:57:29.192090 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.dim_players"
[0m02:57:29.192817 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.dim_players
[0m02:57:29.198000 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.dim_players"
[0m02:57:29.198745 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:57:29.199194 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: BEGIN
[0m02:57:29.199610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:29.200262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.200679 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:57:29.201092 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

  
    
    

    create  table
      "players"."main"."dim_players__dbt_tmp"
  
    as (
      WITH unique_players AS (
    SELECT 
        player_id,
        -- Get the most recently used name (in case it changed)
        arg_max(player_name, season_id) as player_name,
        -- Get the most recent nation/position
        arg_max(nation, season_id) as nation,
        arg_max(primary_position, season_id) as primary_position,
        max(birth_year) as birth_year
    FROM "players"."main"."int_player_season_stats"
    GROUP BY player_id
)

SELECT * FROM unique_players
    );
  
  
[0m02:57:29.236650 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m02:57:29.245101 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:57:29.245649 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m02:57:29.246875 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.248535 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:57:29.249016 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m02:57:29.250097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.254694 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:57:29.255140 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players" rename to "dim_players__dbt_backup"
[0m02:57:29.255937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.260556 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:57:29.260952 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players__dbt_tmp" rename to "dim_players"
[0m02:57:29.261727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.263332 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m02:57:29.263778 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:57:29.264153 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m02:57:29.270777 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m02:57:29.273446 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:57:29.273861 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

      drop table if exists "players"."main"."dim_players__dbt_backup" cascade
    
[0m02:57:29.275455 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.276779 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: Close
[0m02:57:29.277440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b56180df0>]}
[0m02:57:29.278100 [info ] [Thread-1 (]: 15 of 16 OK created sql table model main.dim_players ........................... [[32mOK[0m in 0.09s]
[0m02:57:29.278875 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.dim_players
[0m02:57:29.279346 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_scouting_analysis
[0m02:57:29.279939 [info ] [Thread-1 (]: 16 of 16 START sql table model main.mart_scouting_analysis ..................... [RUN]
[0m02:57:29.280507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.dim_players, now model.nextgeneu_players.mart_scouting_analysis)
[0m02:57:29.280952 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_scouting_analysis
[0m02:57:29.285272 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.286009 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_scouting_analysis
[0m02:57:29.289728 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.290418 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.290837 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: BEGIN
[0m02:57:29.291219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:29.291905 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.292330 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.292809 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_scouting_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_player_season_stats"
    WHERE minutes_90s >= 5.0 -- Filter: Remove noise (players with < 5 games)
),

per_90_calculations AS (
    SELECT 
        *,
        -- 1. ATTACK SCORES
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE goals + assists / minutes_90s
    END
 as goal_contribution_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE npxg + xag / minutes_90s
    END
 as expected_contribution_per_90,
        
        -- 2. PROGRESSION SCORES (The "Engine" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE pass_progressive_distance + carry_progressive_distance / minutes_90s
    END
 as progression_total_dist_per_90,
        
        -- 3. DEFENSIVE SCORES (The "Workrate" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE tackles_won + interceptions + recoveries / minutes_90s
    END
 as defensive_actions_per_90,
        
        -- 4. FLAGS
        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect
    FROM base_stats
)

SELECT 
    *,
    -- Percentile Ranks (0.0 to 1.0)
    -- Compare players only against peers in the SAME position and SAME season
    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY expected_contribution_per_90 ASC
    ) as percentile_attacking,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY progression_total_dist_per_90 ASC
    ) as percentile_progression,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY defensive_actions_per_90 ASC
    ) as percentile_defense

FROM per_90_calculations
    );
  
  
[0m02:57:29.347355 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m02:57:29.348783 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.349207 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m02:57:29.350244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.351494 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.351911 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m02:57:29.352894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:57:29.356639 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.357055 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis" rename to "mart_scouting_analysis__dbt_backup"
[0m02:57:29.357805 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.362196 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.362636 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis__dbt_tmp" rename to "mart_scouting_analysis"
[0m02:57:29.363349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:57:29.364685 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m02:57:29.365091 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.365489 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m02:57:29.388291 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m02:57:29.391461 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:57:29.391899 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

      drop table if exists "players"."main"."mart_scouting_analysis__dbt_backup" cascade
    
[0m02:57:29.394064 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:57:29.395474 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: Close
[0m02:57:29.396125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ca147e8-16b8-4de8-92cd-2a0d173ef5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b56180df0>]}
[0m02:57:29.396812 [info ] [Thread-1 (]: 16 of 16 OK created sql table model main.mart_scouting_analysis ................ [[32mOK[0m in 0.12s]
[0m02:57:29.397554 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_scouting_analysis
[0m02:57:29.399404 [debug] [MainThread]: Using duckdb connection "master"
[0m02:57:29.399759 [debug] [MainThread]: On master: BEGIN
[0m02:57:29.400122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:29.400839 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:57:29.401179 [debug] [MainThread]: On master: COMMIT
[0m02:57:29.401599 [debug] [MainThread]: Using duckdb connection "master"
[0m02:57:29.401958 [debug] [MainThread]: On master: COMMIT
[0m02:57:29.402607 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:57:29.403014 [debug] [MainThread]: On master: Close
[0m02:57:29.403522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:29.403821 [debug] [MainThread]: Connection 'model.nextgeneu_players.mart_scouting_analysis' was properly closed.
[0m02:57:29.404400 [info ] [MainThread]: 
[0m02:57:29.404909 [info ] [MainThread]: Finished running 3 table models, 13 view models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m02:57:29.408142 [debug] [MainThread]: Command end result
[0m02:57:29.453122 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m02:57:29.455225 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m02:57:29.463237 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/transformation/target/run_results.json
[0m02:57:29.463625 [info ] [MainThread]: 
[0m02:57:29.464090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:57:29.464560 [info ] [MainThread]: 
[0m02:57:29.465024 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m02:57:29.466820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7506094, "process_in_blocks": "12896", "process_kernel_time": 0.286934, "process_mem_max_rss": "395360", "process_out_blocks": "8088", "process_user_time": 3.916109}
[0m02:57:29.467334 [debug] [MainThread]: Command `dbt run` succeeded at 02:57:29.467189 after 2.75 seconds
[0m02:57:29.467767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5da005e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5ca58700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b5d8a2a70>]}
[0m02:57:29.468170 [debug] [MainThread]: Flushing usage events
[0m02:57:29.940084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:59:28.549719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b17aec580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b17988ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b16ca2680>]}


============================== 02:59:28.555158 | 20d58a28-f8cb-4352-a304-fc446d116cc4 ==============================
[0m02:59:28.555158 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:59:28.555798 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'empty': 'False', 'debug': 'False', 'quiet': 'False', 'warn_error': 'None', 'log_path': '/app/transformation/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m02:59:28.817433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20d58a28-f8cb-4352-a304-fc446d116cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b17989060>]}
[0m02:59:28.890057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20d58a28-f8cb-4352-a304-fc446d116cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b169b1b40>]}
[0m02:59:28.892061 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:59:28.993739 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:59:29.137925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:59:29.138687 [debug] [MainThread]: Partial parsing: updated file: nextgeneu_players://models/intermediate/int_goalkeeper_season_stats.sql
[0m02:59:29.139139 [debug] [MainThread]: Partial parsing: updated file: nextgeneu_players://models/marts/scouting/mart_goalkeeping_analysis.sql
[0m02:59:29.478621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20d58a28-f8cb-4352-a304-fc446d116cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b10085540>]}
[0m02:59:29.581114 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m02:59:29.583047 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m02:59:29.601091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20d58a28-f8cb-4352-a304-fc446d116cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b100f28c0>]}
[0m02:59:29.601640 [info ] [MainThread]: Found 16 models, 33 sources, 586 macros
[0m02:59:29.602069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d58a28-f8cb-4352-a304-fc446d116cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b100f2920>]}
[0m02:59:29.604683 [info ] [MainThread]: 
[0m02:59:29.605157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:59:29.605591 [info ] [MainThread]: 
[0m02:59:29.606262 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:59:29.613800 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m02:59:29.649948 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m02:59:29.650349 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m02:59:29.650674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:59:29.657465 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m02:59:29.657919 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m02:59:29.658793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:59:29.659107 [debug] [MainThread]: Connection 'list_players' was properly closed.
[0m02:59:29.659501 [info ] [MainThread]: 
[0m02:59:29.659911 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m02:59:29.660612 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/app/data/duckdb/players.db": Conflicting lock is held in PID 0. However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/stable/connect/concurrency
[0m02:59:29.661641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1833078, "process_in_blocks": "1128", "process_kernel_time": 0.196992, "process_mem_max_rss": "159020", "process_out_blocks": "2928", "process_user_time": 2.77089}
[0m02:59:29.662155 [debug] [MainThread]: Command `dbt run` failed at 02:59:29.662017 after 1.18 seconds
[0m02:59:29.662587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b17aec580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b100f0fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b10017910>]}
[0m02:59:29.662984 [debug] [MainThread]: Flushing usage events
[0m02:59:30.061207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:59:46.218870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e7ba05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e6e4ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e6a89570>]}


============================== 02:59:46.223983 | 5b28d087-ad22-419d-bbc1-bc1e6c04b992 ==============================
[0m02:59:46.223983 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:59:46.224603 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/app/transformation/logs', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'profiles_dir': '.', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .'}
[0m02:59:46.477591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e6982260>]}
[0m02:59:46.564225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e6c264d0>]}
[0m02:59:46.566166 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:59:46.658132 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:59:46.790698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:59:46.791137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:59:46.888677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e0aa6ef0>]}
[0m02:59:46.991345 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m02:59:46.993234 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m02:59:47.010965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e0920700>]}
[0m02:59:47.011486 [info ] [MainThread]: Found 16 models, 33 sources, 586 macros
[0m02:59:47.011875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e0922860>]}
[0m02:59:47.014193 [info ] [MainThread]: 
[0m02:59:47.014610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:59:47.014975 [info ] [MainThread]: 
[0m02:59:47.015681 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:59:47.023535 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m02:59:47.061023 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m02:59:47.061414 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m02:59:47.061732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:59:47.091943 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m02:59:47.093243 [debug] [ThreadPool]: On list_players: Close
[0m02:59:47.093938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m02:59:47.094444 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m02:59:47.102271 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m02:59:47.102663 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m02:59:47.102972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:59:47.104121 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:59:47.105319 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m02:59:47.105646 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m02:59:47.106428 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:59:47.106751 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m02:59:47.107061 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m02:59:47.107620 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:59:47.108441 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m02:59:47.108763 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m02:59:47.109058 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m02:59:47.109589 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:59:47.109912 [debug] [ThreadPool]: On create_players_main: Close
[0m02:59:47.112106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m02:59:47.118553 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m02:59:47.118885 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m02:59:47.119176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:59:47.119872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:59:47.120184 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m02:59:47.120549 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m02:59:47.133986 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m02:59:47.135563 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m02:59:47.136108 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m02:59:47.136431 [debug] [ThreadPool]: On list_players_main: Close
[0m02:59:47.139487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e0a74670>]}
[0m02:59:47.139963 [debug] [MainThread]: Using duckdb connection "master"
[0m02:59:47.140283 [debug] [MainThread]: On master: BEGIN
[0m02:59:47.140613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:59:47.141263 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:59:47.141635 [debug] [MainThread]: On master: COMMIT
[0m02:59:47.141946 [debug] [MainThread]: Using duckdb connection "master"
[0m02:59:47.142244 [debug] [MainThread]: On master: COMMIT
[0m02:59:47.142762 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:59:47.143097 [debug] [MainThread]: On master: Close
[0m02:59:47.146345 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m02:59:47.146879 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_fbref__adv_goalkeeping ................... [RUN]
[0m02:59:47.147385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.stg_fbref__adv_goalkeeping)
[0m02:59:47.147739 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m02:59:47.161012 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:59:47.161634 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m02:59:47.192040 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:59:47.192662 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:59:47.193012 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: BEGIN
[0m02:59:47.193368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.194075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.194463 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:59:47.194844 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */

  
  create view "players"."main"."stg_fbref__adv_goalkeeping__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    TRY_CAST(expected_psxg AS FLOAT) as psxg, -- Post-Shot Expected Goals (How hard were the shots?)
    TRY_CAST(expected_psxg_1 AS FLOAT) as psxg_plus_minus, -- The "Shot Stopping" Metric
    
    
    TRY_CAST(REPLACE(launched_cmp, ',', '') AS INTEGER)
 as long_passes_completed,
    TRY_CAST(launched_cmp_1 AS FLOAT) as long_pass_completion_pct,
    
    
    TRY_CAST(REPLACE(crosses_stp, ',', '') AS INTEGER)
 as crosses_stopped,
    TRY_CAST(crosses_stp_1 AS FLOAT) as crosses_stopped_pct,
    
    
    TRY_CAST(REPLACE(sweeper_opa, ',', '') AS INTEGER)
 as defensive_actions_outside_pen_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.196485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.203322 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:59:47.203700 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */
alter view "players"."main"."stg_fbref__adv_goalkeeping" rename to "stg_fbref__adv_goalkeeping__dbt_backup"
[0m02:59:47.204402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.207292 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:59:47.207809 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */
alter view "players"."main"."stg_fbref__adv_goalkeeping__dbt_tmp" rename to "stg_fbref__adv_goalkeeping"
[0m02:59:47.208753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.221057 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: COMMIT
[0m02:59:47.221447 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:59:47.221780 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: COMMIT
[0m02:59:47.233228 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m02:59:47.239413 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m02:59:47.239791 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */

      drop view if exists "players"."main"."stg_fbref__adv_goalkeeping__dbt_backup" cascade
    
[0m02:59:47.241436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.243945 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: Close
[0m02:59:47.245648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e98b1420>]}
[0m02:59:47.246281 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_fbref__adv_goalkeeping .............. [[32mOK[0m in 0.10s]
[0m02:59:47.246939 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m02:59:47.247362 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__creation
[0m02:59:47.247908 [info ] [Thread-1 (]: 2 of 16 START sql view model main.stg_fbref__creation .......................... [RUN]
[0m02:59:47.248451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__adv_goalkeeping, now model.nextgeneu_players.stg_fbref__creation)
[0m02:59:47.248824 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__creation
[0m02:59:47.253896 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__creation"
[0m02:59:47.254704 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__creation
[0m02:59:47.258689 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__creation"
[0m02:59:47.259266 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:59:47.259648 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: BEGIN
[0m02:59:47.259960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.260580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.260925 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:59:47.261281 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

  
  create view "players"."main"."stg_fbref__creation__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(sca_sca, ',', '') AS INTEGER)
 as shot_creating_actions,
    
    TRY_CAST(REPLACE(gca_gca, ',', '') AS INTEGER)
 as goal_creating_actions

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.262748 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.266612 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:59:47.266969 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation" rename to "stg_fbref__creation__dbt_backup"
[0m02:59:47.267624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.270698 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:59:47.271095 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation__dbt_tmp" rename to "stg_fbref__creation"
[0m02:59:47.271776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.273317 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m02:59:47.273883 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:59:47.274384 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m02:59:47.276903 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.279498 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m02:59:47.279890 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

      drop view if exists "players"."main"."stg_fbref__creation__dbt_backup" cascade
    
[0m02:59:47.281460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.282678 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: Close
[0m02:59:47.283254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076db6f1f60>]}
[0m02:59:47.283889 [info ] [Thread-1 (]: 2 of 16 OK created sql view model main.stg_fbref__creation ..................... [[32mOK[0m in 0.03s]
[0m02:59:47.284547 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__creation
[0m02:59:47.284955 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__defense
[0m02:59:47.285506 [info ] [Thread-1 (]: 3 of 16 START sql view model main.stg_fbref__defense ........................... [RUN]
[0m02:59:47.285994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__creation, now model.nextgeneu_players.stg_fbref__defense)
[0m02:59:47.286390 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__defense
[0m02:59:47.292468 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__defense"
[0m02:59:47.293236 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__defense
[0m02:59:47.296766 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__defense"
[0m02:59:47.297374 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:59:47.297753 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: BEGIN
[0m02:59:47.298105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.298731 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.299091 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:59:47.299520 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

  
  create view "players"."main"."stg_fbref__defense__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."defensive_actions_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."defensive_actions_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."defensive_actions_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(tackles_tkl, ',', '') AS INTEGER)
 as tackles_total,
    
    TRY_CAST(REPLACE(tackles_tklw, ',', '') AS INTEGER)
 as tackles_won,
    
    TRY_CAST(REPLACE(tackles_att_3rd, ',', '') AS INTEGER)
 as tackles_att_3rd,
    
    TRY_CAST(REPLACE(unnamed_21_level_0_int, ',', '') AS INTEGER)
 as interceptions,
    
    TRY_CAST(REPLACE(unnamed_23_level_0_clr, ',', '') AS INTEGER)
 as clearances,
    
    TRY_CAST(REPLACE(blocks_sh, ',', '') AS INTEGER)
 as shots_blocked

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.301470 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.305897 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:59:47.306262 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense" rename to "stg_fbref__defense__dbt_backup"
[0m02:59:47.306971 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.309872 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:59:47.310234 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense__dbt_tmp" rename to "stg_fbref__defense"
[0m02:59:47.310903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.312087 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m02:59:47.312451 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:59:47.312773 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m02:59:47.314732 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.317286 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m02:59:47.317691 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

      drop view if exists "players"."main"."stg_fbref__defense__dbt_backup" cascade
    
[0m02:59:47.319335 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.320566 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: Close
[0m02:59:47.321122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d8333b20>]}
[0m02:59:47.321741 [info ] [Thread-1 (]: 3 of 16 OK created sql view model main.stg_fbref__defense ...................... [[32mOK[0m in 0.04s]
[0m02:59:47.322390 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__defense
[0m02:59:47.322785 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__goalkeeping
[0m02:59:47.323323 [info ] [Thread-1 (]: 4 of 16 START sql view model main.stg_fbref__goalkeeping ....................... [RUN]
[0m02:59:47.323807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__defense, now model.nextgeneu_players.stg_fbref__goalkeeping)
[0m02:59:47.324180 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__goalkeeping
[0m02:59:47.329912 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:59:47.330557 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__goalkeeping
[0m02:59:47.334034 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:59:47.334744 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:59:47.335126 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: BEGIN
[0m02:59:47.335518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.336154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.336627 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:59:47.337067 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */

  
  create view "players"."main"."stg_fbref__goalkeeping__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goalkeeping_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goalkeeping_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goalkeeping_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_against,
    
    TRY_CAST(REPLACE(performance_saves, ',', '') AS INTEGER)
 as saves,
    TRY_CAST(performance_save AS FLOAT) as save_pct,
    
    TRY_CAST(REPLACE(performance_cs, ',', '') AS INTEGER)
 as clean_sheets,
    TRY_CAST(performance_cs_1 AS FLOAT) as clean_sheet_pct,
    
    TRY_CAST(REPLACE(penalty_kicks_pka, ',', '') AS INTEGER)
 as pk_allowed,
    
    TRY_CAST(REPLACE(penalty_kicks_pksv, ',', '') AS INTEGER)
 as pk_saved

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.338657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.341782 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:59:47.342179 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */
alter view "players"."main"."stg_fbref__goalkeeping" rename to "stg_fbref__goalkeeping__dbt_backup"
[0m02:59:47.342919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.346762 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:59:47.347177 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */
alter view "players"."main"."stg_fbref__goalkeeping__dbt_tmp" rename to "stg_fbref__goalkeeping"
[0m02:59:47.347873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.349060 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: COMMIT
[0m02:59:47.349454 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:59:47.349854 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: COMMIT
[0m02:59:47.351998 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.354505 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m02:59:47.354859 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */

      drop view if exists "players"."main"."stg_fbref__goalkeeping__dbt_backup" cascade
    
[0m02:59:47.356387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.357561 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: Close
[0m02:59:47.358069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076db6f1f60>]}
[0m02:59:47.358641 [info ] [Thread-1 (]: 4 of 16 OK created sql view model main.stg_fbref__goalkeeping .................. [[32mOK[0m in 0.03s]
[0m02:59:47.359250 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__goalkeeping
[0m02:59:47.359684 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__misc
[0m02:59:47.360200 [info ] [Thread-1 (]: 5 of 16 START sql view model main.stg_fbref__misc .............................. [RUN]
[0m02:59:47.360692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__goalkeeping, now model.nextgeneu_players.stg_fbref__misc)
[0m02:59:47.361057 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__misc
[0m02:59:47.367329 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__misc"
[0m02:59:47.367939 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__misc
[0m02:59:47.371345 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__misc"
[0m02:59:47.371966 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:59:47.372366 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: BEGIN
[0m02:59:47.372724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.373328 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.373702 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:59:47.374107 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

  
  create view "players"."main"."stg_fbref__misc__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."miscellaneous_stats_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."miscellaneous_stats_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."miscellaneous_stats_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_crdy, ',', '') AS INTEGER)
 as yellow_cards,
    
    TRY_CAST(REPLACE(performance_crdr, ',', '') AS INTEGER)
 as red_cards,
    
    TRY_CAST(REPLACE(performance_fls, ',', '') AS INTEGER)
 as fouls_committed,
    
    TRY_CAST(REPLACE(performance_fld, ',', '') AS INTEGER)
 as fouls_drawn,
    
    TRY_CAST(REPLACE(performance_off, ',', '') AS INTEGER)
 as offsides,
    
    TRY_CAST(REPLACE(performance_recov, ',', '') AS INTEGER)
 as ball_recoveries,
    
    TRY_CAST(REPLACE(aerial_duels_won, ',', '') AS INTEGER)
 as aerials_won,
    
    TRY_CAST(REPLACE(aerial_duels_lost, ',', '') AS INTEGER)
 as aerials_lost

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.376395 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.379832 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:59:47.380228 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc" rename to "stg_fbref__misc__dbt_backup"
[0m02:59:47.380975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.384717 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:59:47.385105 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc__dbt_tmp" rename to "stg_fbref__misc"
[0m02:59:47.385781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.386970 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m02:59:47.387361 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:59:47.387898 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m02:59:47.390860 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.393727 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m02:59:47.394124 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

      drop view if exists "players"."main"."stg_fbref__misc__dbt_backup" cascade
    
[0m02:59:47.395932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.397153 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: Close
[0m02:59:47.397717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d83d42e0>]}
[0m02:59:47.398335 [info ] [Thread-1 (]: 5 of 16 OK created sql view model main.stg_fbref__misc ......................... [[32mOK[0m in 0.04s]
[0m02:59:47.398944 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__misc
[0m02:59:47.399359 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__pass_types
[0m02:59:47.399883 [info ] [Thread-1 (]: 6 of 16 START sql view model main.stg_fbref__pass_types ........................ [RUN]
[0m02:59:47.400376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__misc, now model.nextgeneu_players.stg_fbref__pass_types)
[0m02:59:47.400750 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__pass_types
[0m02:59:47.406266 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:59:47.406956 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__pass_types
[0m02:59:47.410492 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:59:47.411321 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:59:47.411827 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: BEGIN
[0m02:59:47.412192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.412845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.413276 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:59:47.413930 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */

  
  create view "players"."main"."stg_fbref__pass_types__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."pass_types_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."pass_types_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."pass_types_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    -- High Value Creation Stats
    
    TRY_CAST(REPLACE(pass_types_tb, ',', '') AS INTEGER)
 as through_balls,
    
    TRY_CAST(REPLACE(pass_types_sw, ',', '') AS INTEGER)
 as switches,
    
    TRY_CAST(REPLACE(pass_types_crs, ',', '') AS INTEGER)
 as crosses,
    
    TRY_CAST(REPLACE(corner_kicks_in, ',', '') AS INTEGER)
 as corners_inswing,
    
    TRY_CAST(REPLACE(corner_kicks_out, ',', '') AS INTEGER)
 as corners_outswing

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.415593 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.418710 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:59:47.419068 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */
alter view "players"."main"."stg_fbref__pass_types" rename to "stg_fbref__pass_types__dbt_backup"
[0m02:59:47.419718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.422708 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:59:47.423064 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */
alter view "players"."main"."stg_fbref__pass_types__dbt_tmp" rename to "stg_fbref__pass_types"
[0m02:59:47.423708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.424903 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: COMMIT
[0m02:59:47.425251 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:59:47.425591 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: COMMIT
[0m02:59:47.427627 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.431122 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m02:59:47.431512 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */

      drop view if exists "players"."main"."stg_fbref__pass_types__dbt_backup" cascade
    
[0m02:59:47.433263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.434490 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: Close
[0m02:59:47.435026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d829b6a0>]}
[0m02:59:47.435633 [info ] [Thread-1 (]: 6 of 16 OK created sql view model main.stg_fbref__pass_types ................... [[32mOK[0m in 0.03s]
[0m02:59:47.436270 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__pass_types
[0m02:59:47.436679 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__passing
[0m02:59:47.437194 [info ] [Thread-1 (]: 7 of 16 START sql view model main.stg_fbref__passing ........................... [RUN]
[0m02:59:47.437700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__pass_types, now model.nextgeneu_players.stg_fbref__passing)
[0m02:59:47.438065 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__passing
[0m02:59:47.444041 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__passing"
[0m02:59:47.444699 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__passing
[0m02:59:47.448157 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__passing"
[0m02:59:47.448819 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:59:47.449195 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: BEGIN
[0m02:59:47.449577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.450185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.450597 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:59:47.451011 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

  
  create view "players"."main"."stg_fbref__passing__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."passing_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."passing_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."passing_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(total_cmp, ',', '') AS INTEGER)
 as passes_completed,
    
    TRY_CAST(REPLACE(total_att, ',', '') AS INTEGER)
 as passes_attempted,
    
    TRY_CAST(REPLACE(total_prgdist, ',', '') AS INTEGER)
 as pass_progressive_distance,
    
    TRY_CAST(REPLACE(unnamed_27_level_0_kp, ',', '') AS INTEGER)
 as key_passes,
    
    TRY_CAST(REPLACE(unnamed_29_level_0_ppa, ',', '') AS INTEGER)
 as passes_into_penalty_area,
    
    TRY_CAST(REPLACE(unnamed_30_level_0_crspa, ',', '') AS INTEGER)
 as crosses_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.452635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.455775 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:59:47.456177 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing" rename to "stg_fbref__passing__dbt_backup"
[0m02:59:47.456862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.459825 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:59:47.460217 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing__dbt_tmp" rename to "stg_fbref__passing"
[0m02:59:47.460895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.462419 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m02:59:47.462969 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:59:47.463493 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m02:59:47.466256 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.469553 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m02:59:47.469947 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

      drop view if exists "players"."main"."stg_fbref__passing__dbt_backup" cascade
    
[0m02:59:47.471679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.472893 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: Close
[0m02:59:47.473466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d82ba800>]}
[0m02:59:47.474047 [info ] [Thread-1 (]: 7 of 16 OK created sql view model main.stg_fbref__passing ...................... [[32mOK[0m in 0.04s]
[0m02:59:47.474727 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__passing
[0m02:59:47.475139 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__playing_time
[0m02:59:47.475695 [info ] [Thread-1 (]: 8 of 16 START sql view model main.stg_fbref__playing_time ...................... [RUN]
[0m02:59:47.476169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__passing, now model.nextgeneu_players.stg_fbref__playing_time)
[0m02:59:47.476570 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__playing_time
[0m02:59:47.543719 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:59:47.544491 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__playing_time
[0m02:59:47.548236 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:59:47.548920 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:59:47.549321 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: BEGIN
[0m02:59:47.549685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.550548 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.550925 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:59:47.551363 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

  
  create view "players"."main"."stg_fbref__playing_time__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."playing_time_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."playing_time_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."playing_time_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_1_level_0_player as player_name,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
    
    TRY_CAST(REPLACE(starts_starts, ',', '') AS INTEGER)
 as starts,
    
    TRY_CAST(REPLACE(subs_subs, ',', '') AS INTEGER)
 as substitutions_on,
    
    TRY_CAST(REPLACE(subs_unsub, ',', '') AS INTEGER)
 as unused_sub,
    
    -- Team Success (Plus/Minus)
    TRY_CAST(team_success_onoff AS FLOAT) as plus_minus_net_per_90

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.553156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.556483 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:59:47.556869 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time" rename to "stg_fbref__playing_time__dbt_backup"
[0m02:59:47.557643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.560630 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:59:47.561020 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time__dbt_tmp" rename to "stg_fbref__playing_time"
[0m02:59:47.561736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.563096 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m02:59:47.563602 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:59:47.563977 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m02:59:47.566782 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.569331 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m02:59:47.569739 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

      drop view if exists "players"."main"."stg_fbref__playing_time__dbt_backup" cascade
    
[0m02:59:47.571550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.572802 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: Close
[0m02:59:47.573415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d82ba800>]}
[0m02:59:47.574036 [info ] [Thread-1 (]: 8 of 16 OK created sql view model main.stg_fbref__playing_time ................. [[32mOK[0m in 0.10s]
[0m02:59:47.574708 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__playing_time
[0m02:59:47.575142 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__possession
[0m02:59:47.575696 [info ] [Thread-1 (]: 9 of 16 START sql view model main.stg_fbref__possession ........................ [RUN]
[0m02:59:47.576214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__playing_time, now model.nextgeneu_players.stg_fbref__possession)
[0m02:59:47.576626 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__possession
[0m02:59:47.583429 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__possession"
[0m02:59:47.584068 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__possession
[0m02:59:47.587583 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__possession"
[0m02:59:47.588215 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:59:47.588609 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: BEGIN
[0m02:59:47.588952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.589573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.589943 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:59:47.590357 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

  
  create view "players"."main"."stg_fbref__possession__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."possession_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."possession_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."possession_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(touches_touches, ',', '') AS INTEGER)
 as touches,
    
    TRY_CAST(REPLACE(touches_att_pen, ',', '') AS INTEGER)
 as touches_att_pen,
    
    TRY_CAST(REPLACE(takeons_succ, ',', '') AS INTEGER)
 as takeons_won,
    
    TRY_CAST(REPLACE(takeons_att, ',', '') AS INTEGER)
 as takeons_attempted,
    
    TRY_CAST(REPLACE(carries_prgdist, ',', '') AS INTEGER)
 as carry_progressive_distance,
    
    TRY_CAST(REPLACE(carries_cpa, ',', '') AS INTEGER)
 as carries_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.591911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.594930 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:59:47.595337 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession" rename to "stg_fbref__possession__dbt_backup"
[0m02:59:47.596000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.598976 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:59:47.599379 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession__dbt_tmp" rename to "stg_fbref__possession"
[0m02:59:47.600070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.601265 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m02:59:47.601662 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:59:47.602022 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m02:59:47.604670 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.607417 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m02:59:47.607866 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

      drop view if exists "players"."main"."stg_fbref__possession__dbt_backup" cascade
    
[0m02:59:47.610114 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.611579 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: Close
[0m02:59:47.612137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d8297610>]}
[0m02:59:47.612763 [info ] [Thread-1 (]: 9 of 16 OK created sql view model main.stg_fbref__possession ................... [[32mOK[0m in 0.04s]
[0m02:59:47.613450 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__possession
[0m02:59:47.613874 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__shooting
[0m02:59:47.614516 [info ] [Thread-1 (]: 10 of 16 START sql view model main.stg_fbref__shooting ......................... [RUN]
[0m02:59:47.615036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__possession, now model.nextgeneu_players.stg_fbref__shooting)
[0m02:59:47.615436 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__shooting
[0m02:59:47.620732 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__shooting"
[0m02:59:47.621324 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__shooting
[0m02:59:47.625976 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__shooting"
[0m02:59:47.626564 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:59:47.626913 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: BEGIN
[0m02:59:47.627220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.627849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.628264 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:59:47.628658 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

  
  create view "players"."main"."stg_fbref__shooting__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."shooting_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."shooting_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."shooting_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(standard_sh, ',', '') AS INTEGER)
 as shots_total,
    
    TRY_CAST(REPLACE(standard_sot, ',', '') AS INTEGER)
 as shots_on_target,
    TRY_CAST(standard_dist AS FLOAT) as avg_shot_distance

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m02:59:47.630081 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.633137 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:59:47.633510 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting" rename to "stg_fbref__shooting__dbt_backup"
[0m02:59:47.634155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.637024 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:59:47.637427 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting__dbt_tmp" rename to "stg_fbref__shooting"
[0m02:59:47.638061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.639240 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m02:59:47.639625 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:59:47.639943 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m02:59:47.642002 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.644446 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m02:59:47.644811 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

      drop view if exists "players"."main"."stg_fbref__shooting__dbt_backup" cascade
    
[0m02:59:47.646344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.647539 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: Close
[0m02:59:47.648052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d82ba800>]}
[0m02:59:47.648635 [info ] [Thread-1 (]: 10 of 16 OK created sql view model main.stg_fbref__shooting .................... [[32mOK[0m in 0.03s]
[0m02:59:47.649284 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__shooting
[0m02:59:47.649712 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__standard
[0m02:59:47.650228 [info ] [Thread-1 (]: 11 of 16 START sql view model main.stg_fbref__standard ......................... [RUN]
[0m02:59:47.650742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__shooting, now model.nextgeneu_players.stg_fbref__standard)
[0m02:59:47.651086 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__standard
[0m02:59:47.658989 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__standard"
[0m02:59:47.659636 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__standard
[0m02:59:47.664512 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__standard"
[0m02:59:47.665152 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:59:47.665552 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: BEGIN
[0m02:59:47.665908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.666577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.666961 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:59:47.667472 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

  
  create view "players"."main"."stg_fbref__standard__dbt_tmp" as (
    -- 1. CONFIGURATION


WITH raw_union AS (
    
        SELECT 
            *, 
            '2023_2024' as source_season_id 
        FROM "players"."raw"."standard_stats_2023_2024"
         UNION ALL 
    
        SELECT 
            *, 
            '2024_2025' as source_season_id 
        FROM "players"."raw"."standard_stats_2024_2025"
         UNION ALL 
    
        SELECT 
            *, 
            '2025_2026' as source_season_id 
        FROM "players"."raw"."standard_stats_2025_2026"
        
    
),

cleaned AS (
    SELECT
        -- 1. IDENTITY (The Golden Key)
        
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
        
        -- 2. METADATA
        unnamed_1_level_0_player as player_name,
        unnamed_2_level_0_nation as nation,
        unnamed_4_level_0_squad  as squad,
        unnamed_3_level_0_pos    as primary_position,
        unnamed_5_level_0_comp   as competition,
        source_season_id         as season_id,
        
        -- 3. DEMOGRAPHICS
        
    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)
 as age,
        
    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)
 as birth_year,

        -- 4. PLAYING TIME
        
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
        
    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)
 as matches_started,
        
    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)
 as minutes_played,
        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,

        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)
        
    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)
 as goals,
        
    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)
 as assists,
        
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_assists,
        
    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)
 as penalties_made,
        
    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)
 as penalties_att,
        
        -- 6. EXPECTED METRICS
        TRY_CAST(expected_xg AS FLOAT) as xg,
        TRY_CAST(expected_npxg AS FLOAT) as npxg,
        TRY_CAST(expected_xag AS FLOAT) as xag,
        
        -- 7. PROGRESSION
        
    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)
 as progressive_carries,
        
    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)
 as progressive_passes,
        
    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)
 as progressive_receptions

    FROM raw_union
)

SELECT * FROM cleaned
WHERE player_name != 'Player' -- Filter header rows
  AND player_name IS NOT NULL
  );

[0m02:59:47.669835 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.672961 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:59:47.673376 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard" rename to "stg_fbref__standard__dbt_backup"
[0m02:59:47.674108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.677021 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:59:47.677447 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard__dbt_tmp" rename to "stg_fbref__standard"
[0m02:59:47.678180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.679517 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m02:59:47.679933 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:59:47.680320 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m02:59:47.683076 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.685600 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m02:59:47.685994 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

      drop view if exists "players"."main"."stg_fbref__standard__dbt_backup" cascade
    
[0m02:59:47.687666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.688888 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: Close
[0m02:59:47.689453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d8297610>]}
[0m02:59:47.690042 [info ] [Thread-1 (]: 11 of 16 OK created sql view model main.stg_fbref__standard .................... [[32mOK[0m in 0.04s]
[0m02:59:47.690685 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__standard
[0m02:59:47.691554 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_goalkeeper_season_stats
[0m02:59:47.692027 [info ] [Thread-1 (]: 12 of 16 START sql view model main.int_goalkeeper_season_stats ................. [RUN]
[0m02:59:47.692535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__standard, now model.nextgeneu_players.int_goalkeeper_season_stats)
[0m02:59:47.692880 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_goalkeeper_season_stats
[0m02:59:47.696245 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:59:47.696900 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_goalkeeper_season_stats
[0m02:59:47.702501 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:59:47.703142 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:59:47.703548 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: BEGIN
[0m02:59:47.703909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.704521 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.704908 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:59:47.705347 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */

  
  create view "players"."main"."int_goalkeeper_season_stats__dbt_tmp" as (
    WITH base AS (SELECT * FROM "players"."main"."stg_fbref__standard"), -- We still need Standard for Age/Nation/Minutes
     gk_basic AS (SELECT * FROM "players"."main"."stg_fbref__goalkeeping"),
     gk_adv   AS (SELECT * FROM "players"."main"."stg_fbref__adv_goalkeeping")

SELECT 
    b.player_id,
    b.player_name,
    b.season_id,
    b.squad,
    b.nation,
    b.age,
    b.birth_year,
    b.minutes_90s,
    
    -- Basic
    g.goals_against,
    g.save_pct,
    g.clean_sheet_pct,
    g.pk_saved,
    
    -- Advanced (The Real Money Stats)
    a.psxg,
    a.psxg_plus_minus, -- Positive = Elite Shot Stopping
    a.crosses_stopped_pct, -- Command of Area
    a.defensive_actions_outside_pen_area as sweeper_actions,
    a.long_pass_completion_pct

FROM base b
INNER JOIN gk_basic g USING (player_id, squad, season_id) -- Inner Join because we ONLY want GKs
LEFT JOIN gk_adv a    USING (player_id, squad, season_id)
  );

[0m02:59:47.709174 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:59:47.712262 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:59:47.712683 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */
alter view "players"."main"."int_goalkeeper_season_stats" rename to "int_goalkeeper_season_stats__dbt_backup"
[0m02:59:47.713381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.716284 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:59:47.716708 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */
alter view "players"."main"."int_goalkeeper_season_stats__dbt_tmp" rename to "int_goalkeeper_season_stats"
[0m02:59:47.717416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.718646 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: COMMIT
[0m02:59:47.719072 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:59:47.719432 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: COMMIT
[0m02:59:47.721593 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.724083 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m02:59:47.724484 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */

      drop view if exists "players"."main"."int_goalkeeper_season_stats__dbt_backup" cascade
    
[0m02:59:47.726364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.727565 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: Close
[0m02:59:47.728103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d821fd30>]}
[0m02:59:47.728698 [info ] [Thread-1 (]: 12 of 16 OK created sql view model main.int_goalkeeper_season_stats ............ [[32mOK[0m in 0.04s]
[0m02:59:47.729334 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_goalkeeper_season_stats
[0m02:59:47.729756 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_player_season_stats
[0m02:59:47.730409 [info ] [Thread-1 (]: 13 of 16 START sql view model main.int_player_season_stats ..................... [RUN]
[0m02:59:47.730917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.int_goalkeeper_season_stats, now model.nextgeneu_players.int_player_season_stats)
[0m02:59:47.731269 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_player_season_stats
[0m02:59:47.735785 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_player_season_stats"
[0m02:59:47.736474 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_player_season_stats
[0m02:59:47.740436 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_player_season_stats"
[0m02:59:47.741120 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:59:47.741534 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: BEGIN
[0m02:59:47.741895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.742522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.742906 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:59:47.743368 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

  
  create view "players"."main"."int_player_season_stats__dbt_tmp" as (
    WITH standard AS (SELECT * FROM "players"."main"."stg_fbref__standard"),
     shooting AS (SELECT * FROM "players"."main"."stg_fbref__shooting"),
     passing  AS (SELECT * FROM "players"."main"."stg_fbref__passing"),
     pass_types AS (SELECT * FROM "players"."main"."stg_fbref__pass_types"),
     defense  AS (SELECT * FROM "players"."main"."stg_fbref__defense"),
     poss     AS (SELECT * FROM "players"."main"."stg_fbref__possession"),
     misc     AS (SELECT * FROM "players"."main"."stg_fbref__misc")

SELECT
    -- Anchors
    s.player_id,
    s.player_name,
    s.season_id,
    s.squad,
    s.competition,
    s.nation,
    s.primary_position,
    s.age,
    s.birth_year,
    s.minutes_played,
    s.minutes_90s,

    -- Attacking Metrics
    s.goals,
    s.assists,
    s.npxg,
    s.xag,
    coalesce(sh.shots_total, 0) as shots_total,
    coalesce(sh.shots_on_target, 0) as shots_on_target,

    -- Possession & Creation
    coalesce(p.key_passes, 0) as key_passes,
    coalesce(p.pass_progressive_distance, 0) as pass_progressive_distance,
    coalesce(pt.through_balls, 0) as through_balls,
    coalesce(pt.switches, 0) as switches,
    coalesce(pt.crosses, 0) as crosses,
    coalesce(poss.carry_progressive_distance, 0) as carry_progressive_distance,
    coalesce(poss.takeons_won, 0) as takeons_won,

    -- Defensive Workrate
    coalesce(d.tackles_won, 0) as tackles_won,
    coalesce(d.interceptions, 0) as interceptions,
    coalesce(d.tackles_att_3rd, 0) as tackles_att_3rd,
    coalesce(m.ball_recoveries, 0) as recoveries,
    coalesce(m.aerials_won, 0) as aerials_won

FROM standard s
LEFT JOIN shooting sh USING (player_id, squad, season_id)
LEFT JOIN passing p   USING (player_id, squad, season_id)
LEFT JOIN pass_types pt USING (player_id, squad, season_id)
LEFT JOIN defense d   USING (player_id, squad, season_id)
LEFT JOIN poss        USING (player_id, squad, season_id)
LEFT JOIN misc m      USING (player_id, squad, season_id)

-- Filter out rows where the join keys might have drifted or empty names
WHERE s.player_id IS NOT NULL
  );

[0m02:59:47.751449 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m02:59:47.755734 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:59:47.756238 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats" rename to "int_player_season_stats__dbt_backup"
[0m02:59:47.757026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.759949 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:59:47.760368 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats__dbt_tmp" rename to "int_player_season_stats"
[0m02:59:47.761069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.762270 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m02:59:47.762684 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:59:47.763046 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m02:59:47.765445 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.767944 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m02:59:47.768358 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

      drop view if exists "players"."main"."int_player_season_stats__dbt_backup" cascade
    
[0m02:59:47.770503 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:47.771723 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: Close
[0m02:59:47.772343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076db6c2680>]}
[0m02:59:47.772939 [info ] [Thread-1 (]: 13 of 16 OK created sql view model main.int_player_season_stats ................ [[32mOK[0m in 0.04s]
[0m02:59:47.773582 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_player_season_stats
[0m02:59:47.773988 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_goalkeeping_analysis
[0m02:59:47.774664 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_goalkeeping_analysis .................. [RUN]
[0m02:59:47.775138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.int_player_season_stats, now model.nextgeneu_players.mart_goalkeeping_analysis)
[0m02:59:47.775526 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_goalkeeping_analysis
[0m02:59:47.780161 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.780886 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_goalkeeping_analysis
[0m02:59:47.800772 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.801459 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.801847 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: BEGIN
[0m02:59:47.802201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.802948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.803373 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.803790 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_goalkeeping_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_goalkeeper_season_stats"
    WHERE minutes_90s >= 5.0
),

per_90_calculations AS (
    SELECT 
        *,
        -- Normalization
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE psxg_plus_minus / minutes_90s
    END
 as psxg_plus_minus_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE sweeper_actions / minutes_90s
    END
 as sweeper_actions_per_90,
        
        -- FLAGS
        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect
    FROM base_stats
)

SELECT 
    *,
    -- Percentiles (Compare GK vs GK only)
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY psxg_plus_minus_per_90 ASC) as percentile_shot_stopping,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY crosses_stopped_pct ASC) as percentile_command,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY sweeper_actions_per_90 ASC) as percentile_sweeping,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY long_pass_completion_pct ASC) as percentile_distribution
FROM per_90_calculations
    );
  
  
[0m02:59:47.828282 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m02:59:47.834277 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.834713 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_goalkeeping_analysis'
  
[0m02:59:47.835709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.836907 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.837315 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_goalkeeping_analysis'
  
[0m02:59:47.838218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.843176 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.843583 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */
alter table "players"."main"."mart_goalkeeping_analysis" rename to "mart_goalkeeping_analysis__dbt_backup"
[0m02:59:47.844277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.847296 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.847696 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */
alter table "players"."main"."mart_goalkeeping_analysis__dbt_tmp" rename to "mart_goalkeeping_analysis"
[0m02:59:47.848390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.852931 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: COMMIT
[0m02:59:47.853339 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.853699 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: COMMIT
[0m02:59:47.856990 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:59:47.859610 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m02:59:47.859991 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

      drop table if exists "players"."main"."mart_goalkeeping_analysis__dbt_backup" cascade
    
[0m02:59:47.861637 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.862887 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: Close
[0m02:59:47.863548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d8240e80>]}
[0m02:59:47.864174 [info ] [Thread-1 (]: 14 of 16 OK created sql table model main.mart_goalkeeping_analysis ............. [[32mOK[0m in 0.09s]
[0m02:59:47.864862 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_goalkeeping_analysis
[0m02:59:47.865249 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.dim_players
[0m02:59:47.865779 [info ] [Thread-1 (]: 15 of 16 START sql table model main.dim_players ................................ [RUN]
[0m02:59:47.866325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.mart_goalkeeping_analysis, now model.nextgeneu_players.dim_players)
[0m02:59:47.866696 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.dim_players
[0m02:59:47.869500 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.dim_players"
[0m02:59:47.870076 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.dim_players
[0m02:59:47.874537 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.dim_players"
[0m02:59:47.875111 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:59:47.875475 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: BEGIN
[0m02:59:47.875796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.876468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.876842 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:59:47.877223 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

  
    
    

    create  table
      "players"."main"."dim_players__dbt_tmp"
  
    as (
      WITH unique_players AS (
    SELECT 
        player_id,
        -- Get the most recently used name (in case it changed)
        arg_max(player_name, season_id) as player_name,
        -- Get the most recent nation/position
        arg_max(nation, season_id) as nation,
        arg_max(primary_position, season_id) as primary_position,
        max(birth_year) as birth_year
    FROM "players"."main"."int_player_season_stats"
    GROUP BY player_id
)

SELECT * FROM unique_players
    );
  
  
[0m02:59:47.917850 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m02:59:47.919714 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:59:47.920233 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m02:59:47.921903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.923569 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:59:47.924291 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m02:59:47.925374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.932459 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:59:47.933248 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players" rename to "dim_players__dbt_backup"
[0m02:59:47.934239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.938541 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:59:47.938958 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players__dbt_tmp" rename to "dim_players"
[0m02:59:47.939789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:47.941162 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m02:59:47.941566 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:59:47.941910 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m02:59:47.948636 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m02:59:47.951483 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m02:59:47.951855 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

      drop table if exists "players"."main"."dim_players__dbt_backup" cascade
    
[0m02:59:47.953576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.954856 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: Close
[0m02:59:47.955482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d8240e80>]}
[0m02:59:47.956123 [info ] [Thread-1 (]: 15 of 16 OK created sql table model main.dim_players ........................... [[32mOK[0m in 0.09s]
[0m02:59:47.956785 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.dim_players
[0m02:59:47.957192 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_scouting_analysis
[0m02:59:47.957753 [info ] [Thread-1 (]: 16 of 16 START sql table model main.mart_scouting_analysis ..................... [RUN]
[0m02:59:47.958246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.dim_players, now model.nextgeneu_players.mart_scouting_analysis)
[0m02:59:47.958656 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_scouting_analysis
[0m02:59:47.962782 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:47.963430 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_scouting_analysis
[0m02:59:47.967109 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:47.967740 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:47.968106 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: BEGIN
[0m02:59:47.968474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:47.969175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:47.969566 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:47.969987 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_scouting_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_player_season_stats"
    WHERE minutes_90s >= 5.0 -- Filter: Remove noise (players with < 5 games)
),

per_90_calculations AS (
    SELECT 
        *,
        -- 1. ATTACK SCORES
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE goals + assists / minutes_90s
    END
 as goal_contribution_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE npxg + xag / minutes_90s
    END
 as expected_contribution_per_90,
        
        -- 2. PROGRESSION SCORES (The "Engine" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE pass_progressive_distance + carry_progressive_distance / minutes_90s
    END
 as progression_total_dist_per_90,
        
        -- 3. DEFENSIVE SCORES (The "Workrate" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE tackles_won + interceptions + recoveries / minutes_90s
    END
 as defensive_actions_per_90,
        
        -- 4. FLAGS
        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect
    FROM base_stats
)

SELECT 
    *,
    -- Percentile Ranks (0.0 to 1.0)
    -- Compare players only against peers in the SAME position and SAME season
    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY expected_contribution_per_90 ASC
    ) as percentile_attacking,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY progression_total_dist_per_90 ASC
    ) as percentile_progression,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY defensive_actions_per_90 ASC
    ) as percentile_defense

FROM per_90_calculations
    );
  
  
[0m02:59:48.023266 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m02:59:48.024691 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:48.025092 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m02:59:48.026062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:48.027269 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:48.027691 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m02:59:48.028606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:59:48.032191 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:48.032590 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis" rename to "mart_scouting_analysis__dbt_backup"
[0m02:59:48.033281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:48.037852 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:48.038282 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis__dbt_tmp" rename to "mart_scouting_analysis"
[0m02:59:48.039099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:59:48.040690 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m02:59:48.041185 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:48.041630 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m02:59:48.057669 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m02:59:48.060860 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m02:59:48.061229 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

      drop table if exists "players"."main"."mart_scouting_analysis__dbt_backup" cascade
    
[0m02:59:48.063421 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:59:48.064774 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: Close
[0m02:59:48.065391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b28d087-ad22-419d-bbc1-bc1e6c04b992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076d83b1960>]}
[0m02:59:48.066002 [info ] [Thread-1 (]: 16 of 16 OK created sql table model main.mart_scouting_analysis ................ [[32mOK[0m in 0.11s]
[0m02:59:48.066637 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_scouting_analysis
[0m02:59:48.068043 [debug] [MainThread]: Using duckdb connection "master"
[0m02:59:48.068389 [debug] [MainThread]: On master: BEGIN
[0m02:59:48.068690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:59:48.069287 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:59:48.069635 [debug] [MainThread]: On master: COMMIT
[0m02:59:48.069944 [debug] [MainThread]: Using duckdb connection "master"
[0m02:59:48.070233 [debug] [MainThread]: On master: COMMIT
[0m02:59:48.070747 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:59:48.071060 [debug] [MainThread]: On master: Close
[0m02:59:48.071468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:59:48.071790 [debug] [MainThread]: Connection 'model.nextgeneu_players.mart_scouting_analysis' was properly closed.
[0m02:59:48.072215 [info ] [MainThread]: 
[0m02:59:48.072637 [info ] [MainThread]: Finished running 3 table models, 13 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m02:59:48.076362 [debug] [MainThread]: Command end result
[0m02:59:48.114578 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m02:59:48.116654 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m02:59:48.125385 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/transformation/target/run_results.json
[0m02:59:48.125729 [info ] [MainThread]: 
[0m02:59:48.126161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:59:48.126570 [info ] [MainThread]: 
[0m02:59:48.126957 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m02:59:48.127930 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9704198, "process_in_blocks": "0", "process_kernel_time": 0.282992, "process_mem_max_rss": "396476", "process_out_blocks": "6768", "process_user_time": 3.574272}
[0m02:59:48.128405 [debug] [MainThread]: Command `dbt run` succeeded at 02:59:48.128280 after 1.97 seconds
[0m02:59:48.128776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e7ba05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e69820b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7076e7a43850>]}
[0m02:59:48.129158 [debug] [MainThread]: Flushing usage events
[0m02:59:48.585509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:46:47.644749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efae24645b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efae1328940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efae1328f70>]}


============================== 03:46:47.739126 | 9913f819-a6f1-4906-9b16-00a027fc2a61 ==============================
[0m03:46:47.739126 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:46:47.739876 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '.', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/app/transformation/logs', 'printer_width': '80', 'invocation_command': 'dbt run --select mart_player_trends --profiles-dir .', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m03:46:51.220297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9913f819-a6f1-4906-9b16-00a027fc2a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efae12c99f0>]}
[0m03:46:51.292430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9913f819-a6f1-4906-9b16-00a027fc2a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efae1c24880>]}
[0m03:46:51.295938 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:46:51.653667 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:46:51.871407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:46:51.872117 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/marts/scouting/mart_player_trends.sql
[0m03:46:52.224382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9913f819-a6f1-4906-9b16-00a027fc2a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efada151810>]}
[0m03:46:52.324668 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m03:46:52.327189 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m03:46:52.352423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9913f819-a6f1-4906-9b16-00a027fc2a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efada1ccbe0>]}
[0m03:46:52.353032 [info ] [MainThread]: Found 17 models, 33 sources, 586 macros
[0m03:46:52.353504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9913f819-a6f1-4906-9b16-00a027fc2a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efada1ccb20>]}
[0m03:46:52.355125 [info ] [MainThread]: 
[0m03:46:52.355541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:46:52.355881 [info ] [MainThread]: 
[0m03:46:52.356474 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:46:52.357365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m03:46:52.629812 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m03:46:52.630358 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m03:46:52.630726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:53.517870 [debug] [ThreadPool]: SQL status: OK in 0.887 seconds
[0m03:46:53.519502 [debug] [ThreadPool]: On list_players: Close
[0m03:46:53.520352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m03:46:53.520855 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m03:46:53.528511 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m03:46:53.528850 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m03:46:53.529146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:46:53.530483 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:46:53.531859 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m03:46:53.532276 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m03:46:53.533020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:46:53.533451 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m03:46:53.533856 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m03:46:53.534637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:46:53.535796 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m03:46:53.536210 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m03:46:53.536614 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m03:46:53.537288 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:46:53.537751 [debug] [ThreadPool]: On create_players_main: Close
[0m03:46:53.547733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m03:46:53.556471 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m03:46:53.556943 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m03:46:53.557383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:46:53.558481 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:46:53.558894 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m03:46:53.559301 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m03:46:53.625728 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m03:46:53.627552 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m03:46:53.628409 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m03:46:53.628742 [debug] [ThreadPool]: On list_players_main: Close
[0m03:46:53.631943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9913f819-a6f1-4906-9b16-00a027fc2a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efada1cf0d0>]}
[0m03:46:53.632453 [debug] [MainThread]: Using duckdb connection "master"
[0m03:46:53.632743 [debug] [MainThread]: On master: BEGIN
[0m03:46:53.633001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:46:53.633710 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:46:53.634029 [debug] [MainThread]: On master: COMMIT
[0m03:46:53.634339 [debug] [MainThread]: Using duckdb connection "master"
[0m03:46:53.634616 [debug] [MainThread]: On master: COMMIT
[0m03:46:53.635103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:46:53.635440 [debug] [MainThread]: On master: Close
[0m03:46:53.638732 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_player_trends
[0m03:46:53.639266 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_player_trends ........................... [RUN]
[0m03:46:53.639763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.mart_player_trends)
[0m03:46:53.640114 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_player_trends
[0m03:46:53.649575 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_player_trends"
[0m03:46:53.650131 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_player_trends
[0m03:46:53.685294 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_player_trends"
[0m03:46:53.686067 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m03:46:53.686474 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: BEGIN
[0m03:46:53.686915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:53.688311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:46:53.688702 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m03:46:53.689140 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */

  
    
    

    create  table
      "players"."main"."mart_player_trends__dbt_tmp"
  
    as (
      WITH combined_stats AS (
    -- OUTFIELDERS
    SELECT 
        player_id, player_name, season_id, squad, age, primary_position,
        minutes_90s,
        
        -- 1. The Raw Scoring Metrics (Keep these for everyone!)
        goals,
        npxg,
        expected_contribution_per_90, -- (npxG + xAG)
        
        -- 2. The Specialist Metrics
        progression_total_dist_per_90,
        defensive_actions_per_90,
        0.0 as gk_metric
    FROM "players"."main"."mart_scouting_analysis"
    
    UNION ALL
    
    -- GOALKEEPERS (Scoring is irrelevant, set to 0)
    SELECT 
        player_id, player_name, season_id, squad, age, 'GK' as primary_position,
        minutes_90s,
        
        0 as goals,
        0.0 as npxg,
        0.0 as expected_contribution_per_90,
        
        0.0 as progression_total_dist_per_90,
        0.0 as defensive_actions_per_90,
        psxg_plus_minus_per_90 as gk_metric
    FROM "players"."main"."mart_goalkeeping_analysis"
),

calc_indices AS (
    SELECT 
        *,
        -- TRACK A: The Specialist Index (Role-Based)
        CASE 
            WHEN primary_position IN ('MF', 'MF,DF') THEN progression_total_dist_per_90
            WHEN primary_position IN ('DF', 'DF,MF') THEN defensive_actions_per_90
            WHEN primary_position = 'GK' THEN gk_metric
            ELSE expected_contribution_per_90 -- For Attackers, Specialist = Scoring
        END as specialist_index,
        
        -- TRACK B: The Universal Scoring Index (For all Outfielders)
        expected_contribution_per_90 as scoring_index
    FROM combined_stats
    WHERE minutes_90s >= 5.0
)

SELECT 
    player_id, player_name, season_id, primary_position, age,
    
    -- Metrics
    specialist_index,
    scoring_index,
    goals,
    npxg,
    
    -- Trends (Calculated on the Specialist Index)
    specialist_index - LAG(specialist_index) OVER (
        PARTITION BY player_id ORDER BY season_id
    ) as yoy_change_specialist,
    
    scoring_index - LAG(scoring_index) OVER (
        PARTITION BY player_id ORDER BY season_id
    ) as yoy_change_scoring

FROM calc_indices
    );
  
  
[0m03:46:53.750290 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m03:46:53.759163 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m03:46:53.759633 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */
alter table "players"."main"."mart_player_trends__dbt_tmp" rename to "mart_player_trends"
[0m03:46:53.760803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:46:53.774633 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: COMMIT
[0m03:46:53.775081 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m03:46:53.775437 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: COMMIT
[0m03:46:53.786779 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m03:46:53.793530 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m03:46:53.793979 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */

      drop table if exists "players"."main"."mart_player_trends__dbt_backup" cascade
    
[0m03:46:53.794821 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:46:53.798591 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: Close
[0m03:46:53.801348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9913f819-a6f1-4906-9b16-00a027fc2a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efad9590220>]}
[0m03:46:53.802320 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.mart_player_trends ...................... [[32mOK[0m in 0.16s]
[0m03:46:53.803191 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_player_trends
[0m03:46:53.804963 [debug] [MainThread]: Using duckdb connection "master"
[0m03:46:53.805399 [debug] [MainThread]: On master: BEGIN
[0m03:46:53.805749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:46:53.806518 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:46:53.806907 [debug] [MainThread]: On master: COMMIT
[0m03:46:53.807224 [debug] [MainThread]: Using duckdb connection "master"
[0m03:46:53.807555 [debug] [MainThread]: On master: COMMIT
[0m03:46:53.808057 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:46:53.808453 [debug] [MainThread]: On master: Close
[0m03:46:53.809078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:46:53.809501 [debug] [MainThread]: Connection 'model.nextgeneu_players.mart_player_trends' was properly closed.
[0m03:46:53.809911 [info ] [MainThread]: 
[0m03:46:53.810418 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m03:46:53.811460 [debug] [MainThread]: Command end result
[0m03:46:53.855205 [debug] [MainThread]: Wrote artifact WritableManifest to /app/transformation/target/manifest.json
[0m03:46:53.857154 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/transformation/target/semantic_manifest.json
[0m03:46:53.864112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/transformation/target/run_results.json
[0m03:46:53.864484 [info ] [MainThread]: 
[0m03:46:53.864965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:46:53.865342 [info ] [MainThread]: 
[0m03:46:53.865747 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:46:53.867544 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3364873, "process_in_blocks": "178816", "process_kernel_time": 0.377315, "process_mem_max_rss": "220256", "process_out_blocks": "5416", "process_user_time": 3.321583}
[0m03:46:53.868033 [debug] [MainThread]: Command `dbt run` succeeded at 03:46:53.867896 after 6.34 seconds
[0m03:46:53.868445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efae24645b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efae12ca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efae2307850>]}
[0m03:46:53.868847 [debug] [MainThread]: Flushing usage events
[0m03:46:54.258889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:21.140193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe1649c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe17f08470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe16a08890>]}


============================== 09:08:21.203647 | 81d93c3f-6431-46dc-a71e-c1a41dce7848 ==============================
[0m09:08:21.203647 [info ] [MainThread]: Running with dbt=1.10.15
[0m09:08:21.204618 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/workspaces/NextGenEUPlayers/transformation', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt build', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/NextGenEUPlayers/transformation/logs', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m09:08:21.539533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81d93c3f-6431-46dc-a71e-c1a41dce7848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe10087950>]}
[0m09:08:21.614167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81d93c3f-6431-46dc-a71e-c1a41dce7848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe10198e30>]}
[0m09:08:21.616225 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:08:21.750646 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m09:08:21.872292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m09:08:21.873391 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/marts/scouting/mart_squad_profile.sql
[0m09:08:21.873969 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/marts/scouting/mart_player_consistency.sql
[0m09:08:21.874525 [debug] [MainThread]: Partial parsing: added file: nextgeneu_players://models/marts/scouting/mart_transfer_valuation.sql
[0m09:08:22.272143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81d93c3f-6431-46dc-a71e-c1a41dce7848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe0f47f110>]}
[0m09:08:22.360265 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/NextGenEUPlayers/transformation/target/manifest.json
[0m09:08:22.362474 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/NextGenEUPlayers/transformation/target/semantic_manifest.json
[0m09:08:22.393560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81d93c3f-6431-46dc-a71e-c1a41dce7848', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe10003ad0>]}
[0m09:08:22.394283 [info ] [MainThread]: Found 20 models, 33 sources, 586 macros
[0m09:08:22.398017 [info ] [MainThread]: 
[0m09:08:22.398650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:22.399196 [info ] [MainThread]: 
[0m09:08:22.400083 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:08:22.407021 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m09:08:22.670214 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m09:08:22.670877 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m09:08:22.671488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:22.958174 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m09:08:22.958898 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m09:08:22.960087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:22.960573 [debug] [MainThread]: Connection 'list_players' was properly closed.
[0m09:08:22.961094 [info ] [MainThread]: 
[0m09:08:22.961688 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m09:08:22.962435 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/app/data/duckdb/players.db": No such file or directory
[0m09:08:22.963912 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.8984393, "process_in_blocks": "40296", "process_kernel_time": 0.401262, "process_mem_max_rss": "176812", "process_out_blocks": "3064", "process_user_time": 3.863158}
[0m09:08:22.964599 [debug] [MainThread]: Command `dbt build` failed at 09:08:22.964452 after 1.90 seconds
[0m09:08:22.965140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe16a23bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe0f35da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afe10001700>]}
[0m09:08:22.965701 [debug] [MainThread]: Flushing usage events
[0m09:08:23.362364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:47.375512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b28a0a1e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b28a02604d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b28a086a2d0>]}


============================== 09:08:47.379116 | e92c4ccd-0523-485f-a4ac-c6320385c7ec ==============================
[0m09:08:47.379116 [info ] [MainThread]: Running with dbt=1.10.15
[0m09:08:47.379877 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_path': '/workspaces/NextGenEUPlayers/transformation/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'fail_fast': 'False', 'empty': 'False', 'no_print': 'None', 'invocation_command': 'dbt build', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/workspaces/NextGenEUPlayers/transformation', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True'}
[0m09:08:47.641791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e92c4ccd-0523-485f-a4ac-c6320385c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2899fc9100>]}
[0m09:08:47.712946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e92c4ccd-0523-485f-a4ac-c6320385c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b28a0260f80>]}
[0m09:08:47.714956 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:08:47.822778 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m09:08:47.911006 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:08:47.911710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e92c4ccd-0523-485f-a4ac-c6320385c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2899b9fa70>]}
[0m09:08:49.520800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e92c4ccd-0523-485f-a4ac-c6320385c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b289991f9e0>]}
[0m09:08:49.600780 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/NextGenEUPlayers/transformation/target/manifest.json
[0m09:08:49.603047 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/NextGenEUPlayers/transformation/target/semantic_manifest.json
[0m09:08:49.632976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e92c4ccd-0523-485f-a4ac-c6320385c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b28999713a0>]}
[0m09:08:49.633684 [info ] [MainThread]: Found 20 models, 33 sources, 586 macros
[0m09:08:49.637335 [info ] [MainThread]: 
[0m09:08:49.637867 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:49.638375 [info ] [MainThread]: 
[0m09:08:49.639100 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:08:49.645301 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m09:08:49.686071 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m09:08:49.686672 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m09:08:49.687237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:49.693241 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m09:08:49.693774 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m09:08:49.694816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:49.695289 [debug] [MainThread]: Connection 'list_players' was properly closed.
[0m09:08:49.695777 [info ] [MainThread]: 
[0m09:08:49.696314 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m09:08:49.696990 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/workspaces/NextGenEUPlayers/data/duckdb/players.db": Conflicting lock is held in python3.10 (PID 87358). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/stable/connect/concurrency
[0m09:08:49.698092 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.397537, "process_in_blocks": "0", "process_kernel_time": 0.301027, "process_mem_max_rss": "180044", "process_out_blocks": "3000", "process_user_time": 4.92945}
[0m09:08:49.698750 [debug] [MainThread]: Command `dbt build` failed at 09:08:49.698637 after 2.40 seconds
[0m09:08:49.699266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b289f936ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b28987b03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2899fc9580>]}
[0m09:08:49.699782 [debug] [MainThread]: Flushing usage events
[0m09:08:50.068051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:07.573909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ac2a0f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ac26494f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ac267db20>]}


============================== 09:10:07.577420 | bf5b2659-dcb7-4708-9076-ca56d3330d43 ==============================
[0m09:10:07.577420 [info ] [MainThread]: Running with dbt=1.10.15
[0m09:10:07.578203 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'log_path': '/workspaces/NextGenEUPlayers/transformation/logs', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt build', 'debug': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/workspaces/NextGenEUPlayers/transformation', 'empty': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m09:10:07.846552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ac1d3b500>]}
[0m09:10:07.918124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ac26b98b0>]}
[0m09:10:07.920056 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:10:08.037579 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m09:10:08.149007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:10:08.149561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:10:08.189806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abc1719a0>]}
[0m09:10:08.275143 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/NextGenEUPlayers/transformation/target/manifest.json
[0m09:10:08.277373 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/NextGenEUPlayers/transformation/target/semantic_manifest.json
[0m09:10:08.421423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abbebffb0>]}
[0m09:10:08.422224 [info ] [MainThread]: Found 20 models, 33 sources, 586 macros
[0m09:10:08.426314 [info ] [MainThread]: 
[0m09:10:08.426927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:08.427517 [info ] [MainThread]: 
[0m09:10:08.428381 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:10:08.435931 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_players'
[0m09:10:08.478321 [debug] [ThreadPool]: Using duckdb connection "list_players"
[0m09:10:08.478915 [debug] [ThreadPool]: On list_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"players"'
    
  
  
[0m09:10:08.479385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:08.511681 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m09:10:08.513436 [debug] [ThreadPool]: On list_players: Close
[0m09:10:08.514363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_players, now create_players_main)
[0m09:10:08.514964 [debug] [ThreadPool]: Creating schema "database: "players"
schema: "main"
"
[0m09:10:08.522438 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m09:10:08.522901 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='players'
        and type='sqlite'
    
  
[0m09:10:08.523329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:08.524446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:08.525892 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m09:10:08.526327 [debug] [ThreadPool]: On create_players_main: BEGIN
[0m09:10:08.526960 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:08.527399 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m09:10:08.527793 [debug] [ThreadPool]: On create_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "create_players_main"} */

    
    
        create schema if not exists "players"."main"
    
[0m09:10:08.528457 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:08.529388 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m09:10:08.529822 [debug] [ThreadPool]: Using duckdb connection "create_players_main"
[0m09:10:08.530222 [debug] [ThreadPool]: On create_players_main: COMMIT
[0m09:10:08.530861 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:08.531303 [debug] [ThreadPool]: On create_players_main: Close
[0m09:10:08.533809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_players_main, now list_players_main)
[0m09:10:08.539462 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m09:10:08.539906 [debug] [ThreadPool]: On list_players_main: BEGIN
[0m09:10:08.540334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:08.541077 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:08.541546 [debug] [ThreadPool]: Using duckdb connection "list_players_main"
[0m09:10:08.541949 [debug] [ThreadPool]: On list_players_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "connection_name": "list_players_main"} */
select
      'players' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'players'
  
[0m09:10:08.718037 [debug] [ThreadPool]: SQL status: OK in 0.176 seconds
[0m09:10:08.719996 [debug] [ThreadPool]: On list_players_main: ROLLBACK
[0m09:10:08.721444 [debug] [ThreadPool]: Failed to rollback 'list_players_main'
[0m09:10:08.721909 [debug] [ThreadPool]: On list_players_main: Close
[0m09:10:08.725316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ac3ba59d0>]}
[0m09:10:08.725955 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:08.726439 [debug] [MainThread]: On master: BEGIN
[0m09:10:08.726870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:08.727742 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:10:08.728211 [debug] [MainThread]: On master: COMMIT
[0m09:10:08.728737 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:08.729173 [debug] [MainThread]: On master: COMMIT
[0m09:10:08.729893 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:10:08.730372 [debug] [MainThread]: On master: Close
[0m09:10:08.733541 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m09:10:08.734287 [info ] [Thread-1 (]: 1 of 20 START sql view model main.stg_fbref__adv_goalkeeping ................... [RUN]
[0m09:10:08.735043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_players_main, now model.nextgeneu_players.stg_fbref__adv_goalkeeping)
[0m09:10:08.735613 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m09:10:08.750408 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m09:10:08.751456 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m09:10:08.784863 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m09:10:08.785992 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m09:10:08.786575 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: BEGIN
[0m09:10:08.787078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:08.788160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.788710 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m09:10:08.789308 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */

  
  create view "players"."main"."stg_fbref__adv_goalkeeping__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."advanced_goalkeeping_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    TRY_CAST(expected_psxg AS FLOAT) as psxg, -- Post-Shot Expected Goals (How hard were the shots?)
    TRY_CAST(expected_psxg_1 AS FLOAT) as psxg_plus_minus, -- The "Shot Stopping" Metric
    
    
    TRY_CAST(REPLACE(launched_cmp, ',', '') AS INTEGER)
 as long_passes_completed,
    TRY_CAST(launched_cmp_1 AS FLOAT) as long_pass_completion_pct,
    
    
    TRY_CAST(REPLACE(crosses_stp, ',', '') AS INTEGER)
 as crosses_stopped,
    TRY_CAST(crosses_stp_1 AS FLOAT) as crosses_stopped_pct,
    
    
    TRY_CAST(REPLACE(sweeper_opa, ',', '') AS INTEGER)
 as defensive_actions_outside_pen_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:08.791242 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.798545 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m09:10:08.799320 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */
alter view "players"."main"."stg_fbref__adv_goalkeeping" rename to "stg_fbref__adv_goalkeeping__dbt_backup"
[0m09:10:08.800598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.804330 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m09:10:08.805029 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */
alter view "players"."main"."stg_fbref__adv_goalkeeping__dbt_tmp" rename to "stg_fbref__adv_goalkeeping"
[0m09:10:08.806093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.822804 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: COMMIT
[0m09:10:08.823755 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m09:10:08.824557 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: COMMIT
[0m09:10:08.838655 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:10:08.848050 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__adv_goalkeeping"
[0m09:10:08.848876 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__adv_goalkeeping"} */

      drop view if exists "players"."main"."stg_fbref__adv_goalkeeping__dbt_backup" cascade
    
[0m09:10:08.851914 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:08.854938 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__adv_goalkeeping: Close
[0m09:10:08.857403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abc1197f0>]}
[0m09:10:08.858274 [info ] [Thread-1 (]: 1 of 20 OK created sql view model main.stg_fbref__adv_goalkeeping .............. [[32mOK[0m in 0.12s]
[0m09:10:08.859080 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__adv_goalkeeping
[0m09:10:08.859695 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__creation
[0m09:10:08.860403 [info ] [Thread-1 (]: 2 of 20 START sql view model main.stg_fbref__creation .......................... [RUN]
[0m09:10:08.861243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__adv_goalkeeping, now model.nextgeneu_players.stg_fbref__creation)
[0m09:10:08.861795 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__creation
[0m09:10:08.867577 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__creation"
[0m09:10:08.868411 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__creation
[0m09:10:08.872028 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__creation"
[0m09:10:08.872876 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m09:10:08.873416 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: BEGIN
[0m09:10:08.873907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:08.874907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.875501 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m09:10:08.876078 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

  
  create view "players"."main"."stg_fbref__creation__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goal_and_shot_creation_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(sca_sca, ',', '') AS INTEGER)
 as shot_creating_actions,
    
    TRY_CAST(REPLACE(gca_gca, ',', '') AS INTEGER)
 as goal_creating_actions

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:08.877997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.883873 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m09:10:08.884448 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation" rename to "stg_fbref__creation__dbt_backup"
[0m09:10:08.885847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.890666 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m09:10:08.891529 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */
alter view "players"."main"."stg_fbref__creation__dbt_tmp" rename to "stg_fbref__creation"
[0m09:10:08.892881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.895316 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m09:10:08.896093 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m09:10:08.896714 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: COMMIT
[0m09:10:08.899794 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:10:08.902965 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__creation"
[0m09:10:08.903577 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__creation"} */

      drop view if exists "players"."main"."stg_fbref__creation__dbt_backup" cascade
    
[0m09:10:08.905561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.907188 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__creation: Close
[0m09:10:08.907944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2aba976960>]}
[0m09:10:08.908746 [info ] [Thread-1 (]: 2 of 20 OK created sql view model main.stg_fbref__creation ..................... [[32mOK[0m in 0.05s]
[0m09:10:08.909520 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__creation
[0m09:10:08.910075 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__defense
[0m09:10:08.910802 [info ] [Thread-1 (]: 3 of 20 START sql view model main.stg_fbref__defense ........................... [RUN]
[0m09:10:08.911440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__creation, now model.nextgeneu_players.stg_fbref__defense)
[0m09:10:08.911950 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__defense
[0m09:10:08.918043 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__defense"
[0m09:10:08.918864 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__defense
[0m09:10:08.922357 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__defense"
[0m09:10:08.923139 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m09:10:08.923656 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: BEGIN
[0m09:10:08.924139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:08.925105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.925607 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m09:10:08.926110 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

  
  create view "players"."main"."stg_fbref__defense__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."defensive_actions_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."defensive_actions_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."defensive_actions_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(tackles_tkl, ',', '') AS INTEGER)
 as tackles_total,
    
    TRY_CAST(REPLACE(tackles_tklw, ',', '') AS INTEGER)
 as tackles_won,
    
    TRY_CAST(REPLACE(tackles_att_3rd, ',', '') AS INTEGER)
 as tackles_att_3rd,
    
    TRY_CAST(REPLACE(unnamed_21_level_0_int, ',', '') AS INTEGER)
 as interceptions,
    
    TRY_CAST(REPLACE(unnamed_23_level_0_clr, ',', '') AS INTEGER)
 as clearances,
    
    TRY_CAST(REPLACE(blocks_sh, ',', '') AS INTEGER)
 as shots_blocked

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:08.927869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.931106 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m09:10:08.931638 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense" rename to "stg_fbref__defense__dbt_backup"
[0m09:10:08.932581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:08.935622 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m09:10:08.936171 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */
alter view "players"."main"."stg_fbref__defense__dbt_tmp" rename to "stg_fbref__defense"
[0m09:10:08.937046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:08.938504 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m09:10:08.939024 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m09:10:08.939508 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: COMMIT
[0m09:10:08.942428 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:08.945029 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__defense"
[0m09:10:08.945561 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__defense"} */

      drop view if exists "players"."main"."stg_fbref__defense__dbt_backup" cascade
    
[0m09:10:08.947484 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.948977 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__defense: Close
[0m09:10:08.949697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abaa6cc20>]}
[0m09:10:08.950460 [info ] [Thread-1 (]: 3 of 20 OK created sql view model main.stg_fbref__defense ...................... [[32mOK[0m in 0.04s]
[0m09:10:08.951224 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__defense
[0m09:10:08.951793 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__goalkeeping
[0m09:10:08.952503 [info ] [Thread-1 (]: 4 of 20 START sql view model main.stg_fbref__goalkeeping ....................... [RUN]
[0m09:10:08.953110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__defense, now model.nextgeneu_players.stg_fbref__goalkeeping)
[0m09:10:08.953644 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__goalkeeping
[0m09:10:08.959680 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m09:10:08.960540 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__goalkeeping
[0m09:10:08.966014 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m09:10:08.966915 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m09:10:08.967453 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: BEGIN
[0m09:10:08.967935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:08.969407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.969887 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m09:10:08.970400 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */

  
  create view "players"."main"."stg_fbref__goalkeeping__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."goalkeeping_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."goalkeeping_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."goalkeeping_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_against,
    
    TRY_CAST(REPLACE(performance_saves, ',', '') AS INTEGER)
 as saves,
    TRY_CAST(performance_save AS FLOAT) as save_pct,
    
    TRY_CAST(REPLACE(performance_cs, ',', '') AS INTEGER)
 as clean_sheets,
    TRY_CAST(performance_cs_1 AS FLOAT) as clean_sheet_pct,
    
    TRY_CAST(REPLACE(penalty_kicks_pka, ',', '') AS INTEGER)
 as pk_allowed,
    
    TRY_CAST(REPLACE(penalty_kicks_pksv, ',', '') AS INTEGER)
 as pk_saved

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:08.972322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.975742 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m09:10:08.976262 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */
alter view "players"."main"."stg_fbref__goalkeeping" rename to "stg_fbref__goalkeeping__dbt_backup"
[0m09:10:08.977123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:08.980371 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m09:10:08.980901 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */
alter view "players"."main"."stg_fbref__goalkeeping__dbt_tmp" rename to "stg_fbref__goalkeeping"
[0m09:10:08.981888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:08.983343 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: COMMIT
[0m09:10:08.983852 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m09:10:08.984349 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: COMMIT
[0m09:10:08.986990 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:08.989877 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__goalkeeping"
[0m09:10:08.990407 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__goalkeeping"} */

      drop view if exists "players"."main"."stg_fbref__goalkeeping__dbt_backup" cascade
    
[0m09:10:08.992350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:08.993876 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__goalkeeping: Close
[0m09:10:08.994602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abaa5f350>]}
[0m09:10:08.995391 [info ] [Thread-1 (]: 4 of 20 OK created sql view model main.stg_fbref__goalkeeping .................. [[32mOK[0m in 0.04s]
[0m09:10:08.996138 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__goalkeeping
[0m09:10:08.996706 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__misc
[0m09:10:08.997416 [info ] [Thread-1 (]: 5 of 20 START sql view model main.stg_fbref__misc .............................. [RUN]
[0m09:10:08.998017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__goalkeeping, now model.nextgeneu_players.stg_fbref__misc)
[0m09:10:08.998550 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__misc
[0m09:10:09.006109 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__misc"
[0m09:10:09.006997 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__misc
[0m09:10:09.010399 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__misc"
[0m09:10:09.011201 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m09:10:09.011743 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: BEGIN
[0m09:10:09.012233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.013229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.013761 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m09:10:09.014317 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

  
  create view "players"."main"."stg_fbref__misc__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."miscellaneous_stats_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."miscellaneous_stats_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."miscellaneous_stats_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(performance_crdy, ',', '') AS INTEGER)
 as yellow_cards,
    
    TRY_CAST(REPLACE(performance_crdr, ',', '') AS INTEGER)
 as red_cards,
    
    TRY_CAST(REPLACE(performance_fls, ',', '') AS INTEGER)
 as fouls_committed,
    
    TRY_CAST(REPLACE(performance_fld, ',', '') AS INTEGER)
 as fouls_drawn,
    
    TRY_CAST(REPLACE(performance_off, ',', '') AS INTEGER)
 as offsides,
    
    TRY_CAST(REPLACE(performance_recov, ',', '') AS INTEGER)
 as ball_recoveries,
    
    TRY_CAST(REPLACE(aerial_duels_won, ',', '') AS INTEGER)
 as aerials_won,
    
    TRY_CAST(REPLACE(aerial_duels_lost, ',', '') AS INTEGER)
 as aerials_lost

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:09.016219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.019511 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m09:10:09.020050 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc" rename to "stg_fbref__misc__dbt_backup"
[0m09:10:09.020936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.024055 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m09:10:09.024599 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */
alter view "players"."main"."stg_fbref__misc__dbt_tmp" rename to "stg_fbref__misc"
[0m09:10:09.025446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.026824 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m09:10:09.027366 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m09:10:09.027860 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: COMMIT
[0m09:10:09.030464 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.033023 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__misc"
[0m09:10:09.033578 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__misc"} */

      drop view if exists "players"."main"."stg_fbref__misc__dbt_backup" cascade
    
[0m09:10:09.035349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.036772 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__misc: Close
[0m09:10:09.037480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abaa6ee70>]}
[0m09:10:09.038224 [info ] [Thread-1 (]: 5 of 20 OK created sql view model main.stg_fbref__misc ......................... [[32mOK[0m in 0.04s]
[0m09:10:09.039053 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__misc
[0m09:10:09.039618 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__pass_types
[0m09:10:09.040308 [info ] [Thread-1 (]: 6 of 20 START sql view model main.stg_fbref__pass_types ........................ [RUN]
[0m09:10:09.040963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__misc, now model.nextgeneu_players.stg_fbref__pass_types)
[0m09:10:09.041498 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__pass_types
[0m09:10:09.048004 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__pass_types"
[0m09:10:09.048896 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__pass_types
[0m09:10:09.054577 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__pass_types"
[0m09:10:09.055481 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m09:10:09.056011 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: BEGIN
[0m09:10:09.056523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.057541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.058051 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m09:10:09.058606 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */

  
  create view "players"."main"."stg_fbref__pass_types__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."pass_types_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."pass_types_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."pass_types_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    -- High Value Creation Stats
    
    TRY_CAST(REPLACE(pass_types_tb, ',', '') AS INTEGER)
 as through_balls,
    
    TRY_CAST(REPLACE(pass_types_sw, ',', '') AS INTEGER)
 as switches,
    
    TRY_CAST(REPLACE(pass_types_crs, ',', '') AS INTEGER)
 as crosses,
    
    TRY_CAST(REPLACE(corner_kicks_in, ',', '') AS INTEGER)
 as corners_inswing,
    
    TRY_CAST(REPLACE(corner_kicks_out, ',', '') AS INTEGER)
 as corners_outswing

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:09.060732 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.065909 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m09:10:09.066686 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */
alter view "players"."main"."stg_fbref__pass_types" rename to "stg_fbref__pass_types__dbt_backup"
[0m09:10:09.068047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.073061 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m09:10:09.073788 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */
alter view "players"."main"."stg_fbref__pass_types__dbt_tmp" rename to "stg_fbref__pass_types"
[0m09:10:09.074980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.076660 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: COMMIT
[0m09:10:09.077287 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m09:10:09.077849 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: COMMIT
[0m09:10:09.080926 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.084792 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__pass_types"
[0m09:10:09.085348 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__pass_types"} */

      drop view if exists "players"."main"."stg_fbref__pass_types__dbt_backup" cascade
    
[0m09:10:09.087305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.088880 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__pass_types: Close
[0m09:10:09.089605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abab90410>]}
[0m09:10:09.090389 [info ] [Thread-1 (]: 6 of 20 OK created sql view model main.stg_fbref__pass_types ................... [[32mOK[0m in 0.05s]
[0m09:10:09.091130 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__pass_types
[0m09:10:09.091680 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__passing
[0m09:10:09.092370 [info ] [Thread-1 (]: 7 of 20 START sql view model main.stg_fbref__passing ........................... [RUN]
[0m09:10:09.093066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__pass_types, now model.nextgeneu_players.stg_fbref__passing)
[0m09:10:09.093670 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__passing
[0m09:10:09.100424 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__passing"
[0m09:10:09.101349 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__passing
[0m09:10:09.104844 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__passing"
[0m09:10:09.105699 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m09:10:09.106224 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: BEGIN
[0m09:10:09.106758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.107788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.108315 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m09:10:09.108903 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

  
  create view "players"."main"."stg_fbref__passing__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."passing_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."passing_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."passing_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(total_cmp, ',', '') AS INTEGER)
 as passes_completed,
    
    TRY_CAST(REPLACE(total_att, ',', '') AS INTEGER)
 as passes_attempted,
    
    TRY_CAST(REPLACE(total_prgdist, ',', '') AS INTEGER)
 as pass_progressive_distance,
    
    TRY_CAST(REPLACE(unnamed_27_level_0_kp, ',', '') AS INTEGER)
 as key_passes,
    
    TRY_CAST(REPLACE(unnamed_29_level_0_ppa, ',', '') AS INTEGER)
 as passes_into_penalty_area,
    
    TRY_CAST(REPLACE(unnamed_30_level_0_crspa, ',', '') AS INTEGER)
 as crosses_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:09.110951 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.114320 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m09:10:09.114878 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing" rename to "stg_fbref__passing__dbt_backup"
[0m09:10:09.115835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.119194 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m09:10:09.119763 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */
alter view "players"."main"."stg_fbref__passing__dbt_tmp" rename to "stg_fbref__passing"
[0m09:10:09.120708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.122130 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m09:10:09.122699 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m09:10:09.123198 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: COMMIT
[0m09:10:09.126290 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:10:09.128999 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__passing"
[0m09:10:09.129550 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__passing"} */

      drop view if exists "players"."main"."stg_fbref__passing__dbt_backup" cascade
    
[0m09:10:09.131448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.133159 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__passing: Close
[0m09:10:09.134052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2aba95be90>]}
[0m09:10:09.134989 [info ] [Thread-1 (]: 7 of 20 OK created sql view model main.stg_fbref__passing ...................... [[32mOK[0m in 0.04s]
[0m09:10:09.135799 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__passing
[0m09:10:09.136544 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__playing_time
[0m09:10:09.137484 [info ] [Thread-1 (]: 8 of 20 START sql view model main.stg_fbref__playing_time ...................... [RUN]
[0m09:10:09.138420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__passing, now model.nextgeneu_players.stg_fbref__playing_time)
[0m09:10:09.138997 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__playing_time
[0m09:10:09.147442 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m09:10:09.148314 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__playing_time
[0m09:10:09.151721 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__playing_time"
[0m09:10:09.152527 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m09:10:09.153045 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: BEGIN
[0m09:10:09.153554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.154561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.155061 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m09:10:09.155608 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

  
  create view "players"."main"."stg_fbref__playing_time__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."playing_time_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."playing_time_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."playing_time_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_1_level_0_player as player_name,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
    
    TRY_CAST(REPLACE(starts_starts, ',', '') AS INTEGER)
 as starts,
    
    TRY_CAST(REPLACE(subs_subs, ',', '') AS INTEGER)
 as substitutions_on,
    
    TRY_CAST(REPLACE(subs_unsub, ',', '') AS INTEGER)
 as unused_sub,
    
    -- Team Success (Plus/Minus)
    TRY_CAST(team_success_onoff AS FLOAT) as plus_minus_net_per_90

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:09.157531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.160689 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m09:10:09.161207 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time" rename to "stg_fbref__playing_time__dbt_backup"
[0m09:10:09.162066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.165112 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m09:10:09.165648 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */
alter view "players"."main"."stg_fbref__playing_time__dbt_tmp" rename to "stg_fbref__playing_time"
[0m09:10:09.166471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.167820 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m09:10:09.168346 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m09:10:09.168840 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: COMMIT
[0m09:10:09.171658 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.174489 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__playing_time"
[0m09:10:09.174991 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__playing_time"} */

      drop view if exists "players"."main"."stg_fbref__playing_time__dbt_backup" cascade
    
[0m09:10:09.177402 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.178911 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__playing_time: Close
[0m09:10:09.179620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abaa6f2f0>]}
[0m09:10:09.180388 [info ] [Thread-1 (]: 8 of 20 OK created sql view model main.stg_fbref__playing_time ................. [[32mOK[0m in 0.04s]
[0m09:10:09.181204 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__playing_time
[0m09:10:09.181771 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__possession
[0m09:10:09.182458 [info ] [Thread-1 (]: 9 of 20 START sql view model main.stg_fbref__possession ........................ [RUN]
[0m09:10:09.183143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__playing_time, now model.nextgeneu_players.stg_fbref__possession)
[0m09:10:09.183722 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__possession
[0m09:10:09.190588 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__possession"
[0m09:10:09.191440 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__possession
[0m09:10:09.194811 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__possession"
[0m09:10:09.195604 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m09:10:09.196111 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: BEGIN
[0m09:10:09.196622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.197646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.198144 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m09:10:09.198697 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

  
  create view "players"."main"."stg_fbref__possession__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."possession_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."possession_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."possession_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(touches_touches, ',', '') AS INTEGER)
 as touches,
    
    TRY_CAST(REPLACE(touches_att_pen, ',', '') AS INTEGER)
 as touches_att_pen,
    
    TRY_CAST(REPLACE(takeons_succ, ',', '') AS INTEGER)
 as takeons_won,
    
    TRY_CAST(REPLACE(takeons_att, ',', '') AS INTEGER)
 as takeons_attempted,
    
    TRY_CAST(REPLACE(carries_prgdist, ',', '') AS INTEGER)
 as carry_progressive_distance,
    
    TRY_CAST(REPLACE(carries_cpa, ',', '') AS INTEGER)
 as carries_into_penalty_area

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:09.200534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.203834 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m09:10:09.204381 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession" rename to "stg_fbref__possession__dbt_backup"
[0m09:10:09.205237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.208451 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m09:10:09.208984 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */
alter view "players"."main"."stg_fbref__possession__dbt_tmp" rename to "stg_fbref__possession"
[0m09:10:09.209887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.211326 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m09:10:09.211861 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m09:10:09.212364 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: COMMIT
[0m09:10:09.215153 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.219901 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__possession"
[0m09:10:09.220432 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__possession"} */

      drop view if exists "players"."main"."stg_fbref__possession__dbt_backup" cascade
    
[0m09:10:09.222322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.223774 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__possession: Close
[0m09:10:09.224491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ab8ab53d0>]}
[0m09:10:09.225223 [info ] [Thread-1 (]: 9 of 20 OK created sql view model main.stg_fbref__possession ................... [[32mOK[0m in 0.04s]
[0m09:10:09.226012 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__possession
[0m09:10:09.226573 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__shooting
[0m09:10:09.227268 [info ] [Thread-1 (]: 10 of 20 START sql view model main.stg_fbref__shooting ......................... [RUN]
[0m09:10:09.227891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__possession, now model.nextgeneu_players.stg_fbref__shooting)
[0m09:10:09.228408 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__shooting
[0m09:10:09.234497 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__shooting"
[0m09:10:09.235352 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__shooting
[0m09:10:09.238850 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__shooting"
[0m09:10:09.239669 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m09:10:09.240179 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: BEGIN
[0m09:10:09.240704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.241665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.242175 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m09:10:09.242737 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

  
  create view "players"."main"."stg_fbref__shooting__dbt_tmp" as (
    

WITH raw_union AS (
    
        SELECT *, '2023_2024' as source_season_id FROM "players"."raw"."shooting_2023_2024"
         UNION ALL 
    
        SELECT *, '2024_2025' as source_season_id FROM "players"."raw"."shooting_2024_2025"
         UNION ALL 
    
        SELECT *, '2025_2026' as source_season_id FROM "players"."raw"."shooting_2025_2026"
        
    
)

SELECT
    
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
    unnamed_4_level_0_squad  as squad,
    source_season_id         as season_id,
    
    
    TRY_CAST(REPLACE(standard_sh, ',', '') AS INTEGER)
 as shots_total,
    
    TRY_CAST(REPLACE(standard_sot, ',', '') AS INTEGER)
 as shots_on_target,
    TRY_CAST(standard_dist AS FLOAT) as avg_shot_distance

FROM raw_union
WHERE unnamed_1_level_0_player != 'Player'
  );

[0m09:10:09.244541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.247772 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m09:10:09.248317 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting" rename to "stg_fbref__shooting__dbt_backup"
[0m09:10:09.249147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.252199 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m09:10:09.252743 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */
alter view "players"."main"."stg_fbref__shooting__dbt_tmp" rename to "stg_fbref__shooting"
[0m09:10:09.253567 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.254913 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m09:10:09.255448 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m09:10:09.255949 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: COMMIT
[0m09:10:09.258513 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.261052 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__shooting"
[0m09:10:09.261593 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__shooting"} */

      drop view if exists "players"."main"."stg_fbref__shooting__dbt_backup" cascade
    
[0m09:10:09.263361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.264743 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__shooting: Close
[0m09:10:09.265423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2aba955eb0>]}
[0m09:10:09.266155 [info ] [Thread-1 (]: 10 of 20 OK created sql view model main.stg_fbref__shooting .................... [[32mOK[0m in 0.04s]
[0m09:10:09.266898 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__shooting
[0m09:10:09.267440 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.stg_fbref__standard
[0m09:10:09.268115 [info ] [Thread-1 (]: 11 of 20 START sql view model main.stg_fbref__standard ......................... [RUN]
[0m09:10:09.268732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__shooting, now model.nextgeneu_players.stg_fbref__standard)
[0m09:10:09.269266 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.stg_fbref__standard
[0m09:10:09.278059 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.stg_fbref__standard"
[0m09:10:09.278937 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.stg_fbref__standard
[0m09:10:09.282299 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.stg_fbref__standard"
[0m09:10:09.283134 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m09:10:09.283677 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: BEGIN
[0m09:10:09.284163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.285180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.285714 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m09:10:09.286305 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

  
  create view "players"."main"."stg_fbref__standard__dbt_tmp" as (
    -- 1. CONFIGURATION


WITH raw_union AS (
    
        SELECT 
            *, 
            '2023_2024' as source_season_id 
        FROM "players"."raw"."standard_stats_2023_2024"
         UNION ALL 
    
        SELECT 
            *, 
            '2024_2025' as source_season_id 
        FROM "players"."raw"."standard_stats_2024_2025"
         UNION ALL 
    
        SELECT 
            *, 
            '2025_2026' as source_season_id 
        FROM "players"."raw"."standard_stats_2025_2026"
        
    
),

cleaned AS (
    SELECT
        -- 1. IDENTITY (The Golden Key)
        
    md5(concat(
        coalesce(unnamed_1_level_0_player, ''), 
        '-', 
        coalesce(unnamed_7_level_0_born, ''), 
        '-', 
        coalesce(unnamed_2_level_0_nation, '')
    ))
 as player_id,
        
        -- 2. METADATA
        unnamed_1_level_0_player as player_name,
        unnamed_2_level_0_nation as nation,
        unnamed_4_level_0_squad  as squad,
        unnamed_3_level_0_pos    as primary_position,
        unnamed_5_level_0_comp   as competition,
        source_season_id         as season_id,
        
        -- 3. DEMOGRAPHICS
        
    TRY_CAST(SPLIT_PART(unnamed_6_level_0_age, '-', 1) AS INTEGER)
 as age,
        
    TRY_CAST(REPLACE(unnamed_7_level_0_born, ',', '') AS INTEGER)
 as birth_year,

        -- 4. PLAYING TIME
        
    TRY_CAST(REPLACE(playing_time_mp, ',', '') AS INTEGER)
 as matches_played,
        
    TRY_CAST(REPLACE(playing_time_starts, ',', '') AS INTEGER)
 as matches_started,
        
    TRY_CAST(REPLACE(playing_time_min, ',', '') AS INTEGER)
 as minutes_played,
        TRY_CAST(playing_time_90s AS FLOAT) as minutes_90s,

        -- 5. PERFORMANCE METRICS (Using the macro to handle commas/types)
        
    TRY_CAST(REPLACE(performance_gls, ',', '') AS INTEGER)
 as goals,
        
    TRY_CAST(REPLACE(performance_ast, ',', '') AS INTEGER)
 as assists,
        
    TRY_CAST(REPLACE(performance_ga, ',', '') AS INTEGER)
 as goals_assists,
        
    TRY_CAST(REPLACE(performance_pk, ',', '') AS INTEGER)
 as penalties_made,
        
    TRY_CAST(REPLACE(performance_pkatt, ',', '') AS INTEGER)
 as penalties_att,
        
        -- 6. EXPECTED METRICS
        TRY_CAST(expected_xg AS FLOAT) as xg,
        TRY_CAST(expected_npxg AS FLOAT) as npxg,
        TRY_CAST(expected_xag AS FLOAT) as xag,
        
        -- 7. PROGRESSION
        
    TRY_CAST(REPLACE(progression_prgc, ',', '') AS INTEGER)
 as progressive_carries,
        
    TRY_CAST(REPLACE(progression_prgp, ',', '') AS INTEGER)
 as progressive_passes,
        
    TRY_CAST(REPLACE(progression_prgr, ',', '') AS INTEGER)
 as progressive_receptions

    FROM raw_union
)

SELECT * FROM cleaned
WHERE player_name != 'Player' -- Filter header rows
  AND player_name IS NOT NULL
  );

[0m09:10:09.289063 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.292452 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m09:10:09.293076 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard" rename to "stg_fbref__standard__dbt_backup"
[0m09:10:09.294092 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.299419 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m09:10:09.300232 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */
alter view "players"."main"."stg_fbref__standard__dbt_tmp" rename to "stg_fbref__standard"
[0m09:10:09.301784 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.303629 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m09:10:09.304180 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m09:10:09.304717 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: COMMIT
[0m09:10:09.308106 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:10:09.310934 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.stg_fbref__standard"
[0m09:10:09.311485 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.stg_fbref__standard"} */

      drop view if exists "players"."main"."stg_fbref__standard__dbt_backup" cascade
    
[0m09:10:09.313548 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.315265 [debug] [Thread-1 (]: On model.nextgeneu_players.stg_fbref__standard: Close
[0m09:10:09.315997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ab8ac2ea0>]}
[0m09:10:09.316775 [info ] [Thread-1 (]: 11 of 20 OK created sql view model main.stg_fbref__standard .................... [[32mOK[0m in 0.05s]
[0m09:10:09.317621 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.stg_fbref__standard
[0m09:10:09.318615 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_goalkeeper_season_stats
[0m09:10:09.319223 [info ] [Thread-1 (]: 12 of 20 START sql view model main.int_goalkeeper_season_stats ................. [RUN]
[0m09:10:09.319891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.stg_fbref__standard, now model.nextgeneu_players.int_goalkeeper_season_stats)
[0m09:10:09.320666 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_goalkeeper_season_stats
[0m09:10:09.326185 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m09:10:09.326941 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_goalkeeper_season_stats
[0m09:10:09.330422 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m09:10:09.331189 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m09:10:09.331710 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: BEGIN
[0m09:10:09.332157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.333057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.333554 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m09:10:09.334045 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */

  
  create view "players"."main"."int_goalkeeper_season_stats__dbt_tmp" as (
    WITH base AS (SELECT * FROM "players"."main"."stg_fbref__standard"), -- We still need Standard for Age/Nation/Minutes
     gk_basic AS (SELECT * FROM "players"."main"."stg_fbref__goalkeeping"),
     gk_adv   AS (SELECT * FROM "players"."main"."stg_fbref__adv_goalkeeping")

SELECT 
    b.player_id,
    b.player_name,
    b.season_id,
    b.squad,
    b.nation,
    b.age,
    b.birth_year,
    b.minutes_90s,
    
    -- Basic
    g.goals_against,
    g.save_pct,
    g.clean_sheet_pct,
    g.pk_saved,
    
    -- Advanced (The Real Money Stats)
    a.psxg,
    a.psxg_plus_minus, -- Positive = Elite Shot Stopping
    a.crosses_stopped_pct, -- Command of Area
    a.defensive_actions_outside_pen_area as sweeper_actions,
    a.long_pass_completion_pct

FROM base b
INNER JOIN gk_basic g USING (player_id, squad, season_id) -- Inner Join because we ONLY want GKs
LEFT JOIN gk_adv a    USING (player_id, squad, season_id)
  );

[0m09:10:09.338784 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:10:09.341998 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m09:10:09.342507 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */
alter view "players"."main"."int_goalkeeper_season_stats" rename to "int_goalkeeper_season_stats__dbt_backup"
[0m09:10:09.343341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.346372 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m09:10:09.346859 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */
alter view "players"."main"."int_goalkeeper_season_stats__dbt_tmp" rename to "int_goalkeeper_season_stats"
[0m09:10:09.347650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.348981 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: COMMIT
[0m09:10:09.349483 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m09:10:09.349931 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: COMMIT
[0m09:10:09.352297 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.354941 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_goalkeeper_season_stats"
[0m09:10:09.355442 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_goalkeeper_season_stats"} */

      drop view if exists "players"."main"."int_goalkeeper_season_stats__dbt_backup" cascade
    
[0m09:10:09.357332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.358683 [debug] [Thread-1 (]: On model.nextgeneu_players.int_goalkeeper_season_stats: Close
[0m09:10:09.359533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abaa6e540>]}
[0m09:10:09.360650 [info ] [Thread-1 (]: 12 of 20 OK created sql view model main.int_goalkeeper_season_stats ............ [[32mOK[0m in 0.04s]
[0m09:10:09.361588 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_goalkeeper_season_stats
[0m09:10:09.362131 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.int_player_season_stats
[0m09:10:09.362881 [info ] [Thread-1 (]: 13 of 20 START sql view model main.int_player_season_stats ..................... [RUN]
[0m09:10:09.363966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.int_goalkeeper_season_stats, now model.nextgeneu_players.int_player_season_stats)
[0m09:10:09.364573 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.int_player_season_stats
[0m09:10:09.369472 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.int_player_season_stats"
[0m09:10:09.370261 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.int_player_season_stats
[0m09:10:09.373582 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.int_player_season_stats"
[0m09:10:09.374376 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m09:10:09.374892 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: BEGIN
[0m09:10:09.375388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.376372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.376874 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m09:10:09.377433 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

  
  create view "players"."main"."int_player_season_stats__dbt_tmp" as (
    WITH standard AS (SELECT * FROM "players"."main"."stg_fbref__standard"),
     shooting AS (SELECT * FROM "players"."main"."stg_fbref__shooting"),
     passing  AS (SELECT * FROM "players"."main"."stg_fbref__passing"),
     pass_types AS (SELECT * FROM "players"."main"."stg_fbref__pass_types"),
     defense  AS (SELECT * FROM "players"."main"."stg_fbref__defense"),
     poss     AS (SELECT * FROM "players"."main"."stg_fbref__possession"),
     misc     AS (SELECT * FROM "players"."main"."stg_fbref__misc")

SELECT
    -- Anchors
    s.player_id,
    s.player_name,
    s.season_id,
    s.squad,
    s.competition,
    s.nation,
    s.primary_position,
    s.age,
    s.birth_year,
    s.minutes_played,
    s.minutes_90s,

    -- Attacking Metrics
    s.goals,
    s.assists,
    s.npxg,
    s.xag,
    coalesce(sh.shots_total, 0) as shots_total,
    coalesce(sh.shots_on_target, 0) as shots_on_target,

    -- Possession & Creation
    coalesce(p.key_passes, 0) as key_passes,
    coalesce(p.pass_progressive_distance, 0) as pass_progressive_distance,
    coalesce(pt.through_balls, 0) as through_balls,
    coalesce(pt.switches, 0) as switches,
    coalesce(pt.crosses, 0) as crosses,
    coalesce(poss.carry_progressive_distance, 0) as carry_progressive_distance,
    coalesce(poss.takeons_won, 0) as takeons_won,

    -- Defensive Workrate
    coalesce(d.tackles_won, 0) as tackles_won,
    coalesce(d.interceptions, 0) as interceptions,
    coalesce(d.tackles_att_3rd, 0) as tackles_att_3rd,
    coalesce(m.ball_recoveries, 0) as recoveries,
    coalesce(m.aerials_won, 0) as aerials_won

FROM standard s
LEFT JOIN shooting sh USING (player_id, squad, season_id)
LEFT JOIN passing p   USING (player_id, squad, season_id)
LEFT JOIN pass_types pt USING (player_id, squad, season_id)
LEFT JOIN defense d   USING (player_id, squad, season_id)
LEFT JOIN poss        USING (player_id, squad, season_id)
LEFT JOIN misc m      USING (player_id, squad, season_id)

-- Filter out rows where the join keys might have drifted or empty names
WHERE s.player_id IS NOT NULL
  );

[0m09:10:09.386421 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:10:09.392425 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m09:10:09.393004 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats" rename to "int_player_season_stats__dbt_backup"
[0m09:10:09.394141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.397324 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m09:10:09.397859 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */
alter view "players"."main"."int_player_season_stats__dbt_tmp" rename to "int_player_season_stats"
[0m09:10:09.398842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.400236 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m09:10:09.400781 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m09:10:09.401273 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: COMMIT
[0m09:10:09.404578 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:10:09.407787 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.int_player_season_stats"
[0m09:10:09.408378 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.int_player_season_stats"} */

      drop view if exists "players"."main"."int_player_season_stats__dbt_backup" cascade
    
[0m09:10:09.411183 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.413144 [debug] [Thread-1 (]: On model.nextgeneu_players.int_player_season_stats: Close
[0m09:10:09.413924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ab8b04c20>]}
[0m09:10:09.415155 [info ] [Thread-1 (]: 13 of 20 OK created sql view model main.int_player_season_stats ................ [[32mOK[0m in 0.05s]
[0m09:10:09.416145 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.int_player_season_stats
[0m09:10:09.416697 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_goalkeeping_analysis
[0m09:10:09.417518 [info ] [Thread-1 (]: 14 of 20 START sql table model main.mart_goalkeeping_analysis .................. [RUN]
[0m09:10:09.418157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.int_player_season_stats, now model.nextgeneu_players.mart_goalkeeping_analysis)
[0m09:10:09.418664 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_goalkeeping_analysis
[0m09:10:09.423744 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.424574 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_goalkeeping_analysis
[0m09:10:09.445146 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.446056 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.446578 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: BEGIN
[0m09:10:09.447021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.447952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.448445 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.448930 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_goalkeeping_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_goalkeeper_season_stats"
    WHERE minutes_90s >= 5.0
),

per_90_calculations AS (
    SELECT 
        *,
        -- Normalization
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE psxg_plus_minus / minutes_90s
    END
 as psxg_plus_minus_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE sweeper_actions / minutes_90s
    END
 as sweeper_actions_per_90,
        
        -- FLAGS
        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect
    FROM base_stats
)

SELECT 
    *,
    -- Percentiles (Compare GK vs GK only)
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY psxg_plus_minus_per_90 ASC) as percentile_shot_stopping,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY crosses_stopped_pct ASC) as percentile_command,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY sweeper_actions_per_90 ASC) as percentile_sweeping,
    PERCENT_RANK() OVER (PARTITION BY season_id ORDER BY long_pass_completion_pct ASC) as percentile_distribution
FROM per_90_calculations
    );
  
  
[0m09:10:09.483490 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m09:10:09.489841 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.490423 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_goalkeeping_analysis'
  
[0m09:10:09.491641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.493054 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.493564 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_goalkeeping_analysis'
  
[0m09:10:09.494754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.498599 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.499138 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */
alter table "players"."main"."mart_goalkeeping_analysis" rename to "mart_goalkeeping_analysis__dbt_backup"
[0m09:10:09.500042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.503766 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.504311 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */
alter table "players"."main"."mart_goalkeeping_analysis__dbt_tmp" rename to "mart_goalkeeping_analysis"
[0m09:10:09.505323 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.511403 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: COMMIT
[0m09:10:09.511904 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.512508 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: COMMIT
[0m09:10:09.517592 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:10:09.520413 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_goalkeeping_analysis"
[0m09:10:09.520927 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_goalkeeping_analysis"} */

      drop table if exists "players"."main"."mart_goalkeeping_analysis__dbt_backup" cascade
    
[0m09:10:09.523030 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.524511 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_goalkeeping_analysis: Close
[0m09:10:09.525196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2aba9d0590>]}
[0m09:10:09.525957 [info ] [Thread-1 (]: 14 of 20 OK created sql table model main.mart_goalkeeping_analysis ............. [[32mOK[0m in 0.11s]
[0m09:10:09.526721 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_goalkeeping_analysis
[0m09:10:09.527277 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.dim_players
[0m09:10:09.527941 [info ] [Thread-1 (]: 15 of 20 START sql table model main.dim_players ................................ [RUN]
[0m09:10:09.528562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.mart_goalkeeping_analysis, now model.nextgeneu_players.dim_players)
[0m09:10:09.529059 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.dim_players
[0m09:10:09.531988 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.dim_players"
[0m09:10:09.532780 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.dim_players
[0m09:10:09.538153 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.dim_players"
[0m09:10:09.538954 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m09:10:09.539467 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: BEGIN
[0m09:10:09.539931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.540808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.541310 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m09:10:09.541804 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

  
    
    

    create  table
      "players"."main"."dim_players__dbt_tmp"
  
    as (
      WITH unique_players AS (
    SELECT 
        player_id,
        -- Get the most recently used name (in case it changed)
        arg_max(player_name, season_id) as player_name,
        -- Get the most recent nation/position
        arg_max(nation, season_id) as nation,
        arg_max(primary_position, season_id) as primary_position,
        max(birth_year) as birth_year
    FROM "players"."main"."int_player_season_stats"
    GROUP BY player_id
)

SELECT * FROM unique_players
    );
  
  
[0m09:10:09.578509 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m09:10:09.579995 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m09:10:09.580564 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m09:10:09.581742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.583155 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m09:10:09.583701 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_players'
  
[0m09:10:09.584834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.588414 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m09:10:09.589059 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players" rename to "dim_players__dbt_backup"
[0m09:10:09.590026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.593165 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m09:10:09.593730 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */
alter table "players"."main"."dim_players__dbt_tmp" rename to "dim_players"
[0m09:10:09.594811 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.596322 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m09:10:09.596853 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m09:10:09.597363 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: COMMIT
[0m09:10:09.604105 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:10:09.607009 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.dim_players"
[0m09:10:09.607570 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.dim_players"} */

      drop table if exists "players"."main"."dim_players__dbt_backup" cascade
    
[0m09:10:09.609542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.611103 [debug] [Thread-1 (]: On model.nextgeneu_players.dim_players: Close
[0m09:10:09.611827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abbf2b680>]}
[0m09:10:09.612588 [info ] [Thread-1 (]: 15 of 20 OK created sql table model main.dim_players ........................... [[32mOK[0m in 0.08s]
[0m09:10:09.613365 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.dim_players
[0m09:10:09.613910 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_scouting_analysis
[0m09:10:09.614590 [info ] [Thread-1 (]: 16 of 20 START sql table model main.mart_scouting_analysis ..................... [RUN]
[0m09:10:09.615188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.dim_players, now model.nextgeneu_players.mart_scouting_analysis)
[0m09:10:09.615723 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_scouting_analysis
[0m09:10:09.620093 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.621225 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_scouting_analysis
[0m09:10:09.624902 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.625641 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.626115 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: BEGIN
[0m09:10:09.626585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.627633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.628445 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.629366 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

  
    
    

    create  table
      "players"."main"."mart_scouting_analysis__dbt_tmp"
  
    as (
      WITH base_stats AS (
    SELECT * FROM "players"."main"."int_player_season_stats"
    WHERE minutes_90s >= 5.0 -- Filter: Remove noise (players with < 5 games)
),

per_90_calculations AS (
    SELECT 
        *,
        -- 1. ATTACK SCORES
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE goals + assists / minutes_90s
    END
 as goal_contribution_per_90,
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE npxg + xag / minutes_90s
    END
 as expected_contribution_per_90,
        
        -- 2. PROGRESSION SCORES (The "Engine" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE pass_progressive_distance + carry_progressive_distance / minutes_90s
    END
 as progression_total_dist_per_90,
        
        -- 3. DEFENSIVE SCORES (The "Workrate" Metric)
        
    CASE 
        WHEN minutes_90s = 0 OR minutes_90s IS NULL THEN 0
        ELSE tackles_won + interceptions + recoveries / minutes_90s
    END
 as defensive_actions_per_90,
        
        -- 4. FLAGS
        CASE WHEN (2026 - birth_year) <= 23 THEN TRUE ELSE FALSE END as is_u23_prospect
    FROM base_stats
)

SELECT 
    *,
    -- Percentile Ranks (0.0 to 1.0)
    -- Compare players only against peers in the SAME position and SAME season
    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY expected_contribution_per_90 ASC
    ) as percentile_attacking,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY progression_total_dist_per_90 ASC
    ) as percentile_progression,

    PERCENT_RANK() OVER (
        PARTITION BY season_id, primary_position 
        ORDER BY defensive_actions_per_90 ASC
    ) as percentile_defense

FROM per_90_calculations
    );
  
  
[0m09:10:09.688512 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m09:10:09.690056 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.690664 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m09:10:09.691895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.693386 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.693925 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_scouting_analysis'
  
[0m09:10:09.695062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.698697 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.699239 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis" rename to "mart_scouting_analysis__dbt_backup"
[0m09:10:09.700270 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.703513 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.704070 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */
alter table "players"."main"."mart_scouting_analysis__dbt_tmp" rename to "mart_scouting_analysis"
[0m09:10:09.705024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.706644 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m09:10:09.707183 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.707711 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: COMMIT
[0m09:10:09.725833 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:10:09.728923 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_scouting_analysis"
[0m09:10:09.729504 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_scouting_analysis"} */

      drop table if exists "players"."main"."mart_scouting_analysis__dbt_backup" cascade
    
[0m09:10:09.731882 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.733422 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_scouting_analysis: Close
[0m09:10:09.734108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ac2bedc70>]}
[0m09:10:09.734896 [info ] [Thread-1 (]: 16 of 20 OK created sql table model main.mart_scouting_analysis ................ [[32mOK[0m in 0.12s]
[0m09:10:09.735755 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_scouting_analysis
[0m09:10:09.736718 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_player_trends
[0m09:10:09.737358 [info ] [Thread-1 (]: 17 of 20 START sql table model main.mart_player_trends ......................... [RUN]
[0m09:10:09.738024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.mart_scouting_analysis, now model.nextgeneu_players.mart_player_trends)
[0m09:10:09.738563 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_player_trends
[0m09:10:09.744718 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.745540 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_player_trends
[0m09:10:09.749154 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.749995 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.750615 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: BEGIN
[0m09:10:09.751109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.752265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.752829 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.753433 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */

  
    
    

    create  table
      "players"."main"."mart_player_trends__dbt_tmp"
  
    as (
      WITH combined_stats AS (
    -- OUTFIELDERS
    SELECT 
        player_id, player_name, season_id, squad, age, primary_position,
        minutes_90s,
        
        -- 1. The Raw Scoring Metrics (Keep these for everyone!)
        goals,
        npxg,
        expected_contribution_per_90, -- (npxG + xAG)
        
        -- 2. The Specialist Metrics
        progression_total_dist_per_90,
        defensive_actions_per_90,
        0.0 as gk_metric
    FROM "players"."main"."mart_scouting_analysis"
    
    UNION ALL
    
    -- GOALKEEPERS (Scoring is irrelevant, set to 0)
    SELECT 
        player_id, player_name, season_id, squad, age, 'GK' as primary_position,
        minutes_90s,
        
        0 as goals,
        0.0 as npxg,
        0.0 as expected_contribution_per_90,
        
        0.0 as progression_total_dist_per_90,
        0.0 as defensive_actions_per_90,
        psxg_plus_minus_per_90 as gk_metric
    FROM "players"."main"."mart_goalkeeping_analysis"
),

calc_indices AS (
    SELECT 
        *,
        -- TRACK A: The Specialist Index (Role-Based)
        CASE 
            WHEN primary_position IN ('MF', 'MF,DF') THEN progression_total_dist_per_90
            WHEN primary_position IN ('DF', 'DF,MF') THEN defensive_actions_per_90
            WHEN primary_position = 'GK' THEN gk_metric
            ELSE expected_contribution_per_90 -- For Attackers, Specialist = Scoring
        END as specialist_index,
        
        -- TRACK B: The Universal Scoring Index (For all Outfielders)
        expected_contribution_per_90 as scoring_index
    FROM combined_stats
    WHERE minutes_90s >= 5.0
)

SELECT 
    player_id, player_name, season_id, primary_position, age,
    
    -- Metrics
    specialist_index,
    scoring_index,
    goals,
    npxg,
    
    -- Trends (Calculated on the Specialist Index)
    specialist_index - LAG(specialist_index) OVER (
        PARTITION BY player_id ORDER BY season_id
    ) as yoy_change_specialist,
    
    scoring_index - LAG(scoring_index) OVER (
        PARTITION BY player_id ORDER BY season_id
    ) as yoy_change_scoring

FROM calc_indices
    );
  
  
[0m09:10:09.764573 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:10:09.766327 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.766890 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_player_trends'
  
[0m09:10:09.768012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.769515 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.770058 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'mart_player_trends'
  
[0m09:10:09.771197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.774890 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.775457 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */
alter table "players"."main"."mart_player_trends" rename to "mart_player_trends__dbt_backup"
[0m09:10:09.776393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.779654 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.780346 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */
alter table "players"."main"."mart_player_trends__dbt_tmp" rename to "mart_player_trends"
[0m09:10:09.781391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.782863 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: COMMIT
[0m09:10:09.783410 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.783911 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: COMMIT
[0m09:10:09.793153 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m09:10:09.796266 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_trends"
[0m09:10:09.796826 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_trends"} */

      drop table if exists "players"."main"."mart_player_trends__dbt_backup" cascade
    
[0m09:10:09.799068 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:09.800639 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_trends: Close
[0m09:10:09.801361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abaa6e120>]}
[0m09:10:09.802131 [info ] [Thread-1 (]: 17 of 20 OK created sql table model main.mart_player_trends .................... [[32mOK[0m in 0.06s]
[0m09:10:09.802907 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_player_trends
[0m09:10:09.803446 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_squad_profile
[0m09:10:09.804201 [info ] [Thread-1 (]: 18 of 20 START sql table model main.mart_squad_profile ......................... [RUN]
[0m09:10:09.804879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.mart_player_trends, now model.nextgeneu_players.mart_squad_profile)
[0m09:10:09.805382 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_squad_profile
[0m09:10:09.808499 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_squad_profile"
[0m09:10:09.809305 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_squad_profile
[0m09:10:09.813402 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_squad_profile"
[0m09:10:09.814085 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_squad_profile"
[0m09:10:09.814581 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_squad_profile: BEGIN
[0m09:10:09.815023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.815950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.816447 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_squad_profile"
[0m09:10:09.816924 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_squad_profile: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_squad_profile"} */

  
    
    

    create  table
      "players"."main"."mart_squad_profile__dbt_tmp"
  
    as (
      WITH player_stats AS (
    SELECT * FROM "players"."main"."mart_scouting_analysis"
)

SELECT
    squad,
    season_id,
    competition,
    primary_position,
    
    -- Squad Depth Info
    count(distinct player_id) as depth_count,
    avg(age) as avg_age,
    
    -- The "Bar" to beat (Average Starter Performance)
    -- We assume "Starters" are those with > 15.0 90s played
    avg(CASE WHEN minutes_90s > 15 THEN expected_contribution_per_90 END) as starter_avg_xG_xAG,
    avg(CASE WHEN minutes_90s > 15 THEN progression_total_dist_per_90 END) as starter_avg_progression,
    avg(CASE WHEN minutes_90s > 15 THEN defensive_actions_per_90 END) as starter_avg_def_actions

FROM player_stats
GROUP BY 1, 2, 3, 4
    );
  
  
[0m09:10:09.824400 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:10:09.827662 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_squad_profile"
[0m09:10:09.828169 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_squad_profile: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_squad_profile"} */
alter table "players"."main"."mart_squad_profile__dbt_tmp" rename to "mart_squad_profile"
[0m09:10:09.829019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.830396 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_squad_profile: COMMIT
[0m09:10:09.830900 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_squad_profile"
[0m09:10:09.831377 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_squad_profile: COMMIT
[0m09:10:09.836367 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:10:09.840562 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_squad_profile"
[0m09:10:09.841098 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_squad_profile: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_squad_profile"} */

      drop table if exists "players"."main"."mart_squad_profile__dbt_backup" cascade
    
[0m09:10:09.841984 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.844106 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_squad_profile: Close
[0m09:10:09.844783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2aba9591f0>]}
[0m09:10:09.845508 [info ] [Thread-1 (]: 18 of 20 OK created sql table model main.mart_squad_profile .................... [[32mOK[0m in 0.04s]
[0m09:10:09.846219 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_squad_profile
[0m09:10:09.846769 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_transfer_valuation
[0m09:10:09.847439 [info ] [Thread-1 (]: 19 of 20 START sql table model main.mart_transfer_valuation .................... [RUN]
[0m09:10:09.848036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.mart_squad_profile, now model.nextgeneu_players.mart_transfer_valuation)
[0m09:10:09.848597 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_transfer_valuation
[0m09:10:09.854146 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_transfer_valuation"
[0m09:10:09.854873 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_transfer_valuation
[0m09:10:09.858072 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_transfer_valuation"
[0m09:10:09.858824 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_transfer_valuation"
[0m09:10:09.859340 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_transfer_valuation: BEGIN
[0m09:10:09.859822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.860706 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.861208 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_transfer_valuation"
[0m09:10:09.861789 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_transfer_valuation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_transfer_valuation"} */

  
    
    

    create  table
      "players"."main"."mart_transfer_valuation__dbt_tmp"
  
    as (
      WITH stats AS (
    SELECT * FROM "players"."main"."mart_scouting_analysis"
),

league_weights AS (
    SELECT 
        player_id,
        CASE 
            WHEN competition = 'Premier League' THEN 2.0
            WHEN competition IN ('La Liga', 'Bundesliga') THEN 1.5
            WHEN competition IN ('Serie A', 'Ligue 1') THEN 1.2
            ELSE 1.0 
        END as league_multiplier
    FROM stats
)

SELECT
    s.player_id,
    s.player_name,
    s.season_id,
    s.squad,
    s.age,
    
    -- 1. Performance Tier (S, A, B, C)
    -- Note: Assuming percentile_attacking and percentile_defense exist in mart_scouting_analysis
    -- If not, we might need to calculate them or use existing rank columns.
    -- For safety, I will use a placeholder logic if they don't exist, but the user provided this SQL.
    -- I'll stick to the user's SQL but I should check if these columns exist.
    -- Let's assume they do or the user intends to add them. 
    -- Actually, looking at dashboard.py, we calculate ranks on the fly. 
    -- The dbt model `mart_scouting_analysis` might not have them.
    -- Let's check `mart_scouting_analysis` columns first to be safe.
    
    CASE 
        WHEN percentile_attacking > 0.90 OR percentile_defense > 0.90 THEN 'S-Tier (Elite)'
        WHEN percentile_attacking > 0.75 OR percentile_defense > 0.75 THEN 'A-Tier (Starter)'
        WHEN percentile_attacking > 0.50 THEN 'B-Tier (Rotation)'
        ELSE 'C-Tier (Development)'
    END as performance_tier,

    -- 2. Estimated Market Value Calculation (The Algorithm)
    -- Formula: (Base * Age_Factor * League_Tax)
    ROUND(
        (
            -- Base Value derived from performance
            (s.expected_contribution_per_90 * 50) + (s.defensive_actions_per_90 * 5)
        ) 
        * 
        -- Age Multiplier (Younger = More Expensive)
        (CASE WHEN s.age < 23 THEN 1.5 WHEN s.age > 30 THEN 0.5 ELSE 1.0 END)
        * 
        -- League Tax
        lw.league_multiplier
    , 1) as market_value_est_m_eur,
    
    -- 3. Contract Status Proxy (Minutes played as proxy for squad importance)
    CASE WHEN s.minutes_90s < 10 THEN 'Fringe' ELSE 'Key Player' END as squad_status

FROM stats s
JOIN league_weights lw USING (player_id)
    );
  
  
[0m09:10:09.871359 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m09:10:09.874993 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_transfer_valuation"
[0m09:10:09.875567 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_transfer_valuation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_transfer_valuation"} */
alter table "players"."main"."mart_transfer_valuation__dbt_tmp" rename to "mart_transfer_valuation"
[0m09:10:09.876556 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.877973 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_transfer_valuation: COMMIT
[0m09:10:09.878506 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_transfer_valuation"
[0m09:10:09.878995 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_transfer_valuation: COMMIT
[0m09:10:09.897433 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:10:09.900393 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_transfer_valuation"
[0m09:10:09.900936 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_transfer_valuation: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_transfer_valuation"} */

      drop table if exists "players"."main"."mart_transfer_valuation__dbt_backup" cascade
    
[0m09:10:09.901882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.903432 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_transfer_valuation: Close
[0m09:10:09.904136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ab8ad3aa0>]}
[0m09:10:09.904919 [info ] [Thread-1 (]: 19 of 20 OK created sql table model main.mart_transfer_valuation ............... [[32mOK[0m in 0.06s]
[0m09:10:09.905685 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_transfer_valuation
[0m09:10:09.906268 [debug] [Thread-1 (]: Began running node model.nextgeneu_players.mart_player_consistency
[0m09:10:09.906953 [info ] [Thread-1 (]: 20 of 20 START sql table model main.mart_player_consistency .................... [RUN]
[0m09:10:09.907573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nextgeneu_players.mart_transfer_valuation, now model.nextgeneu_players.mart_player_consistency)
[0m09:10:09.908078 [debug] [Thread-1 (]: Began compiling node model.nextgeneu_players.mart_player_consistency
[0m09:10:09.911271 [debug] [Thread-1 (]: Writing injected SQL for node "model.nextgeneu_players.mart_player_consistency"
[0m09:10:09.912046 [debug] [Thread-1 (]: Began executing node model.nextgeneu_players.mart_player_consistency
[0m09:10:09.915696 [debug] [Thread-1 (]: Writing runtime sql for node "model.nextgeneu_players.mart_player_consistency"
[0m09:10:09.916505 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_consistency"
[0m09:10:09.917023 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_consistency: BEGIN
[0m09:10:09.917547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.918525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:09.919036 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_consistency"
[0m09:10:09.919608 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_consistency: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_consistency"} */

  
    
    

    create  table
      "players"."main"."mart_player_consistency__dbt_tmp"
  
    as (
      WITH trends AS (
    SELECT * FROM "players"."main"."mart_player_trends"
),

volatility_calc AS (
    SELECT 
        player_id,
        player_name,
        primary_position,
        
        -- How many seasons do we have data for?
        count(distinct season_id) as seasons_tracked,
        
        -- Volatility (Standard Deviation of their Specialist Index)
        stddev(specialist_index) as performance_volatility,
        
        -- Peak Performance
        max(specialist_index) as career_peak_performance,
        
        -- Current Form (Last season vs Career Average)
        (arg_max(specialist_index, season_id) - avg(specialist_index)) as form_vs_avg
        
    FROM trends
    GROUP BY 1, 2, 3
)

SELECT 
    *,
    -- Risk Classification
    CASE 
        WHEN seasons_tracked < 2 THEN 'Unknown Risk (New Entry)'
        WHEN performance_volatility > 0.20 THEN 'High Risk (Inconsistent)'
        WHEN form_vs_avg < -0.1 THEN 'Declining Risk (Past Peak)'
        ELSE 'Safe Bet (Consistent)'
    END as transfer_risk_rating
FROM volatility_calc
    );
  
  
[0m09:10:09.927835 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:10:09.931946 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_consistency"
[0m09:10:09.932836 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_consistency: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_consistency"} */
alter table "players"."main"."mart_player_consistency__dbt_tmp" rename to "mart_player_consistency"
[0m09:10:09.933807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.935207 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_consistency: COMMIT
[0m09:10:09.935720 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_consistency"
[0m09:10:09.936169 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_consistency: COMMIT
[0m09:10:09.943599 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:10:09.946161 [debug] [Thread-1 (]: Using duckdb connection "model.nextgeneu_players.mart_player_consistency"
[0m09:10:09.946689 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_consistency: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nextgeneu_players", "target_name": "dev", "node_id": "model.nextgeneu_players.mart_player_consistency"} */

      drop table if exists "players"."main"."mart_player_consistency__dbt_backup" cascade
    
[0m09:10:09.947455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:09.948866 [debug] [Thread-1 (]: On model.nextgeneu_players.mart_player_consistency: Close
[0m09:10:09.949538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b2659-dcb7-4708-9076-ca56d3330d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abaa89520>]}
[0m09:10:09.950284 [info ] [Thread-1 (]: 20 of 20 OK created sql table model main.mart_player_consistency ............... [[32mOK[0m in 0.04s]
[0m09:10:09.951009 [debug] [Thread-1 (]: Finished running node model.nextgeneu_players.mart_player_consistency
[0m09:10:09.952467 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:09.952906 [debug] [MainThread]: On master: BEGIN
[0m09:10:09.953327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:10:09.954048 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:10:09.954511 [debug] [MainThread]: On master: COMMIT
[0m09:10:09.954923 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:09.955357 [debug] [MainThread]: On master: COMMIT
[0m09:10:09.955970 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:10:09.956426 [debug] [MainThread]: On master: Close
[0m09:10:09.956917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:09.957353 [debug] [MainThread]: Connection 'model.nextgeneu_players.mart_player_consistency' was properly closed.
[0m09:10:09.957916 [info ] [MainThread]: 
[0m09:10:09.958494 [info ] [MainThread]: Finished running 7 table models, 13 view models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m09:10:09.961767 [debug] [MainThread]: Command end result
[0m09:10:09.997419 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/NextGenEUPlayers/transformation/target/manifest.json
[0m09:10:09.999864 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/NextGenEUPlayers/transformation/target/semantic_manifest.json
[0m09:10:10.008454 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/NextGenEUPlayers/transformation/target/run_results.json
[0m09:10:10.009011 [info ] [MainThread]: 
[0m09:10:10.009543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:10:10.009991 [info ] [MainThread]: 
[0m09:10:10.010480 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=20
[0m09:10:10.011550 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.4987144, "process_in_blocks": "11680", "process_kernel_time": 0.408611, "process_mem_max_rss": "418648", "process_out_blocks": "11296", "process_user_time": 5.042202}
[0m09:10:10.012120 [debug] [MainThread]: Command `dbt build` succeeded at 09:10:10.012015 after 2.50 seconds
[0m09:10:10.012615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2ac1f95b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abe35c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2abe35d400>]}
[0m09:10:10.013086 [debug] [MainThread]: Flushing usage events
[0m09:10:10.518978 [debug] [MainThread]: An error was encountered while trying to flush usage events
